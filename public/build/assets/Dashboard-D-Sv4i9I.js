import{T as Ee}from"./TransitionGroup-BlPzboAx.js";import{r as W,g as Q,u as et,a as Pe,b as ee,V as P,c as r,d as l,n as pe,e as F,F as j,m as K,s as tt,f as u,p as te,o as Me,h as at,k as Ae,i as nt,j as ot,l as lt,q as st,w as De,I as $e,t as We,v as it,x as Oe,P as rt,y as J,z as ye,A as ut,B as Le,C as Ue,D as L,E as Ye,G as He,H as ct,J as dt,K as vt,M as ft,L as mt,N as ht,O as gt,Q as yt,R as kt,S as bt,T as wt,U as ie,W as pt,X as _t,Y as w,Z as S,_ as m,$ as R,a0 as Ne,a1 as G,a2 as v,a3 as I,a4 as b,a5 as se,a6 as Se,a7 as ne,a8 as re,a9 as Xe,aa as Tt,ab as ve,ac as Z,ad as z,ae as ke,af as xt,ag as Vt,ah as ge,ai as Ct,aj as $t,ak as St,al as It,am as fe}from"./app-CbAAu-5u.js";import{u as q,i as Bt,M as Rt,a as Et,b as je,c as Fe,d as Pt,e as Mt,f as At,g as Dt,h as Wt,C as Ot,O as Y,T as H,V as Lt,j as Ut,k as Yt,l as Ht,m as Nt,n as Xt}from"./VSwitch-BQqOd_n4.js";import{g as jt,u as Ft,m as Gt,V as Ie,a as zt,b as Zt}from"./filter-CiovnaRb.js";import{V as qt,a as Kt}from"./VCard-JNPZp4p-.js";import{f as Jt}from"./VInput-CGvaCURJ.js";import{a as Qt,V as ea}from"./VTextField-B1pNa9Da.js";import{V as ta}from"./VContainer-Cgw5azsu.js";import{V as Be,a as oe}from"./VRow-DxIVaoO_.js";import{V as Re}from"./VAutocomplete-DRgf8CjI.js";import{V as aa}from"./VTable-DjE-f9-H.js";import"./VSelectionControl-BBuxVbYo.js";import"./VCheckboxBtn-D3SFvjR_.js";/* empty css              */function na(e,t){const a=W();return q(e,"dragstart",n=>{if(a.value=n.target,typeof t=="string"){const o=t;t=(i,s)=>{s?.setData("text/plain",i.dataset[o]??"")}}t?.(a.value,n.dataTransfer)}),q(e,"dragend",()=>{a.value=null}),{element:a}}function Ge(e,t,a=!0){const n=W(!1);let o=0;return Bt&&(q(e,"dragenter",i=>{i.preventDefault(),o++,n.value=!0}),q(e,"dragover",i=>{i.preventDefault()}),q(e,"dragleave",i=>{i.preventDefault(),o--,o===0&&(n.value=!1)}),q(e,"drop",i=>{if(i.preventDefault(),o=0,n.value=!1,t)if(a){const s=Array.from(i.dataTransfer?.files??[]);t(s.length===0?null:s)}else t(i.dataTransfer)})),{isOverDropZone:n}}const _e=Symbol.for("vuetify:v-tabs"),ze=te({fixed:Boolean,sliderColor:String,sliderTransition:String,sliderTransitionDuration:[String,Number],hideSlider:Boolean,inset:Boolean,direction:{type:String,default:"horizontal"},...Me(at({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),me=Q()({name:"VTab",props:ze(),setup(e,t){let{slots:a,attrs:n}=t;const{textColorClasses:o,textColorStyles:i}=et(()=>e.sliderColor),{backgroundColorClasses:s,backgroundColorStyles:p}=Pe(()=>e.sliderColor),h=W(),g=W(),f=u(()=>e.direction==="horizontal"),x=u(()=>h.value?.group?.isSelected.value??!1);function y(B,E){return{opacity:[0,1]}}function M(B,E){return e.direction==="vertical"?{transform:["scaleY(0)","scaleY(1)"]}:{transform:["scaleX(0)","scaleX(1)"]}}function V(B,E){const C=E.getBoundingClientRect(),$=B.getBoundingClientRect(),T=f.value?"x":"y",d=f.value?"X":"Y",c=f.value?"right":"bottom",k=f.value?"width":"height",O=C[T],N=$[T],U=O>N?C[c]-$[c]:C[T]-$[T],ue=Math.sign(U)>0?f.value?"right":"bottom":Math.sign(U)<0?f.value?"left":"top":"center",he=(Math.abs(U)+(Math.sign(U)<0?C[k]:$[k]))/Math.max(C[k],$[k])||0,ae=C[k]/$[k]||0,ce=1.5;return{transform:[`translate${d}(${U}px) scale${d}(${ae})`,`translate${d}(${U/ce}px) scale${d}(${(he-1)/ce+1})`,"none"],transformOrigin:Array(3).fill(ue)}}function A(B){let{value:E}=B;if(E){const C=h.value?.$el.parentElement?.querySelector(".v-tab--selected .v-tab__slider"),$=g.value;if(!C||!$)return;const T=getComputedStyle(C).color,d={fade:y,grow:M,shift:V}[e.sliderTransition??"shift"]??V,c=Number(e.sliderTransitionDuration)||({fade:400,grow:350,shift:225}[e.sliderTransition??"shift"]??225);Qt($,{backgroundColor:[T,"currentcolor"],...d($,C)},{duration:c,easing:tt})}}return ee(()=>{const B=P.filterProps(e);return r(P,K({symbol:_e,ref:h,class:["v-tab",e.class,x.value&&e.inset?s.value:[]],style:[e.style,x.value&&e.inset?p.value:[]],tabindex:x.value?0:-1,role:"tab","aria-selected":String(x.value),active:!1},B,n,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":A}),{...a,default:()=>l(j,null,[a.default?.()??e.text,!e.hideSlider&&l("div",{ref:g,class:F(["v-tab__slider",o.value]),style:pe(i.value)},null)])})}),Jt({},h)}}),oa=e=>{const{touchstartX:t,touchendX:a,touchstartY:n,touchendY:o}=e,i=.5,s=16;e.offsetX=a-t,e.offsetY=o-n,Math.abs(e.offsetY)<i*Math.abs(e.offsetX)&&(e.left&&a<t-s&&e.left(e),e.right&&a>t+s&&e.right(e)),Math.abs(e.offsetX)<i*Math.abs(e.offsetY)&&(e.up&&o<n-s&&e.up(e),e.down&&o>n+s&&e.down(e))};function la(e,t){const a=e.changedTouches[0];t.touchstartX=a.clientX,t.touchstartY=a.clientY,t.start?.({originalEvent:e,...t})}function sa(e,t){const a=e.changedTouches[0];t.touchendX=a.clientX,t.touchendY=a.clientY,t.end?.({originalEvent:e,...t}),oa(t)}function ia(e,t){const a=e.changedTouches[0];t.touchmoveX=a.clientX,t.touchmoveY=a.clientY,t.move?.({originalEvent:e,...t})}function ra(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:a=>la(a,t),touchend:a=>sa(a,t),touchmove:a=>ia(a,t)}}function ua(e,t){const a=t.value,n=a?.parent?e.parentElement:e,o=a?.options??{passive:!0},i=t.instance?.$.uid;if(!n||i===void 0)return;const s=ra(t.value);n._touchHandlers=n._touchHandlers??Object.create(null),n._touchHandlers[i]=s,Ae(s).forEach(p=>{n.addEventListener(p,s[p],o)})}function ca(e,t){const a=t.value?.parent?e.parentElement:e,n=t.instance?.$.uid;if(!a?._touchHandlers||n===void 0)return;const o=a._touchHandlers[n];Ae(o).forEach(i=>{a.removeEventListener(i,o[i])}),delete a._touchHandlers[n]}const be={mounted:ua,unmounted:ca},Ze=Symbol.for("vuetify:v-window"),qe=Symbol.for("vuetify:v-window-group"),Ke=te({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},verticalArrows:[Boolean,String],touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},crossfade:Boolean,transitionDuration:Number,...Ue(),...Le(),...ut()},"VWindow"),we=Q()({name:"VWindow",directives:{vTouch:be},props:Ke(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const{themeClasses:n}=nt(e),{isRtl:o}=ot(),{t:i}=lt(),s=st(e,qe),p=W(),h=u(()=>o.value?!e.reverse:e.reverse),g=ye(!1),f=u(()=>{if(e.crossfade)return"v-window-crossfade-transition";const T=e.direction==="vertical"?"y":"x",c=(h.value?!g.value:g.value)?"-reverse":"";return`v-window-${T}${c}-transition`}),x=ye(0),y=W(void 0),M=u(()=>s.items.value.findIndex(T=>s.selected.value.includes(T.id)));De(M,(T,d)=>{let c;const k={left:0,top:0};$e&&d>=0&&(c=jt(p.value),k.left=c?.scrollLeft,k.top=c?.scrollTop);const O=s.items.value.length,N=O-1;O<=2?g.value=T<d:T===N&&d===0?g.value=!1:T===0&&d===N?g.value=!0:g.value=T<d,We(()=>{if(!$e||!c)return;c.scrollTop!==k.top&&c.scrollTo({...k,behavior:"instant"}),requestAnimationFrame(()=>{if(!c)return;c.scrollTop!==k.top&&c.scrollTo({...k,behavior:"instant"})})})},{flush:"sync"}),it(Ze,{transition:f,isReversed:g,transitionCount:x,transitionHeight:y,rootRef:p});const V=L(()=>e.continuous||M.value!==0),A=L(()=>e.continuous||M.value!==s.items.value.length-1);function B(){V.value&&s.prev()}function E(){A.value&&s.next()}const C=u(()=>{const T=[],d={icon:o.value?e.nextIcon:e.prevIcon,class:`v-window__${h.value?"right":"left"}`,onClick:s.prev,"aria-label":i("$vuetify.carousel.prev")};T.push(V.value?a.prev?a.prev({props:d}):r(P,d,null):l("div",null,null));const c={icon:o.value?e.prevIcon:e.nextIcon,class:`v-window__${h.value?"left":"right"}`,onClick:s.next,"aria-label":i("$vuetify.carousel.next")};return T.push(A.value?a.next?a.next({props:c}):r(P,c,null):l("div",null,null)),T}),$=u(()=>e.touch===!1?e.touch:{...{left:()=>{h.value?B():E()},right:()=>{h.value?E():B()},start:d=>{let{originalEvent:c}=d;c.stopPropagation()}},...e.touch===!0?{}:e.touch});return ee(()=>Oe(r(e.tag,{ref:p,class:F(["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover","v-window--vertical-arrows":!!e.verticalArrows,"v-window--crossfade":!!e.crossfade},n.value,e.class]),style:pe([e.style,{"--v-window-transition-duration":rt()?null:J(e.transitionDuration,"ms")}])},{default:()=>[l("div",{class:"v-window__container",style:{height:y.value}},[a.default?.({group:s}),e.showArrows!==!1&&l("div",{class:F(["v-window__controls",{"v-window__controls--left":e.verticalArrows==="left"||e.verticalArrows===!0},{"v-window__controls--right":e.verticalArrows==="right"}])},[C.value])]),a.additional?.({group:s})]}),[[be,$.value]])),{group:s}}}),da=te({...Me(Ke(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),va=Q()({name:"VTabsWindow",props:da(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const n=Ye(_e,null),o=He(e,"modelValue"),i=u({get(){return o.value!=null||!n?o.value:n.items.value.find(s=>n.selected.value.includes(s.id))?.value},set(s){o.value=s}});return ee(()=>{const s=we.filterProps(e);return r(we,K({_as:"VTabsWindow"},s,{modelValue:i.value,"onUpdate:modelValue":p=>i.value=p,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),a)}),{}}}),Je=te({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ue(),...mt(),...Gt()},"VWindowItem"),le=Q()({name:"VWindowItem",directives:{vTouch:be},props:Je(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:a}=t;const n=Ye(Ze),o=ct(e,qe),{isBooted:i}=dt();if(!n||!o)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const s=ye(!1),p=u(()=>i.value&&(n.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function h(){!s.value||!n||(s.value=!1,n.transitionCount.value>0&&(n.transitionCount.value-=1,n.transitionCount.value===0&&(n.transitionHeight.value=void 0)))}function g(){s.value||!n||(s.value=!0,n.transitionCount.value===0&&(n.transitionHeight.value=J(n.rootRef.value?.clientHeight)),n.transitionCount.value+=1)}function f(){h()}function x(V){s.value&&We(()=>{!p.value||!s.value||!n||(n.transitionHeight.value=J(V.clientHeight))})}const y=u(()=>{const V=n.isReversed.value?e.reverseTransition:e.transition;return p.value?{name:typeof V!="string"?n.transition.value:V,onBeforeEnter:g,onAfterEnter:h,onEnterCancelled:f,onBeforeLeave:g,onAfterLeave:h,onLeaveCancelled:f,onEnter:x}:!1}),{hasContent:M}=Ft(e,o.isSelected);return ee(()=>r(ft,{transition:y.value,disabled:!i.value},{default:()=>[Oe(l("div",{class:F(["v-window-item",o.selectedClass.value,e.class]),style:pe(e.style)},[M.value&&a.default?.()]),[[vt,o.isSelected.value]])]})),{groupItem:o}}}),fa=te({...Je()},"VTabsWindowItem"),ma=Q()({name:"VTabsWindowItem",props:fa(),setup(e,t){let{slots:a}=t;return ee(()=>{const n=le.filterProps(e);return r(le,K({_as:"VTabsWindowItem"},n,{class:["v-tabs-window-item",e.class],style:e.style}),a)}),{}}});function ha(e){return e?e.map(t=>wt(t)?t:{text:t,value:t}):[]}const ga=te({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,inset:Boolean,insetPadding:[String,Number],insetRadius:[String,Number],sliderColor:String,...bt(ze(),["spaced","sliderTransition","sliderTransitionDuration"]),...zt({mandatory:"force",selectedClass:"v-tab-item--selected"}),...kt(),...Le()},"VTabs"),ya=Q()({name:"VTabs",props:ga(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:a,slots:n}=t;const o=He(e,"modelValue"),i=u(()=>ha(e.items)),{densityClasses:s}=ht(e),{backgroundColorClasses:p,backgroundColorStyles:h}=Pe(()=>e.bgColor),{scopeId:g}=gt();return yt({VTab:{color:L(e,"color"),direction:L(e,"direction"),stacked:L(e,"stacked"),fixed:L(e,"fixedTabs"),inset:L(e,"inset"),sliderColor:L(e,"sliderColor"),sliderTransition:L(e,"sliderTransition"),sliderTransitionDuration:L(e,"sliderTransitionDuration"),hideSlider:L(e,"hideSlider")}}),ee(()=>{const f=Ie.filterProps(e),x=!!(n.window||e.items.length>0);return l(j,null,[r(Ie,K(f,{modelValue:o.value,"onUpdate:modelValue":y=>o.value=y,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--inset":e.inset,"v-tabs--stacked":e.stacked},s.value,p.value,e.class],style:[{"--v-tabs-height":J(e.height),"--v-tabs-inset-padding":e.inset?J(e.insetPadding):void 0,"--v-tabs-inset-radius":e.inset?J(e.insetRadius):void 0},h.value,e.style],role:"tablist",symbol:_e},g,a),{default:n.default??(()=>i.value.map(y=>n.tab?.({item:y})??r(me,K(y,{key:y.text,value:y.value,spaced:e.spaced}),{default:n[`tab.${y.value}`]?()=>n[`tab.${y.value}`]?.({item:y}):void 0}))),prev:n.prev,next:n.next}),x&&r(va,K({modelValue:o.value,"onUpdate:modelValue":y=>o.value=y,key:"tabs-window"},g),{default:()=>[i.value.map(y=>n.item?.({item:y})??r(ma,{value:y.value},{default:()=>n[`item.${y.value}`]?.({item:y})})),n.window?.()]})])}),{}}}),ka={class:"d-inline-block"},ba={class:"overflow-hidden text-white"},wa={class:"title relative inline-block"},pa=["innerHTML"],_a={key:1},Ta=["innerHTML"],xa={key:0},Va={key:1},Ca={key:2},$a={key:3},Sa={class:"table-fixed"},Ia={class:"w-1/3"},Ba={class:"text-center"},Ra=["title"],Ea={class:"text-center"},Pa=["title"],Ma={class:"text-center"},Aa=["title"],Da={class:"text-center"},Wa=["title"],Oa={class:"text-center"},La=["title"],Ua={class:"text-right"},Ya={class:"text-right"},Ha={class:"text-right"},Na={class:"text-right"},Xa={class:"text-right"},ja={class:"text-right"},Fa={class:"text-right"},Ga={class:"text-right"},za={class:"text-right"},Za={class:"text-right"},qa=ie({__name:"Ticket",props:{ticket:{}},setup(e){pt(_=>({v0c560d15:Ce.value.delay,v2b070e7c:Ce.value.duration}));const t=e,{t:a}=_t(),n=u(()=>Se().props.factors),o=W(null),i=new Rt({linkify:!0}).use(Et),s=je(),p=Fe(),h=u(()=>Se().props.options),g=u(()=>ne(t.ticket.created_at)),f=u(()=>ne.duration(t.ticket.delay,"s")),x=u(()=>g.value.add(f.value)),y=u(()=>t.ticket.bound_at?ne(t.ticket.bound_at):null),M=u(()=>t.ticket.reservation?ne.duration(t.ticket.reservation,"s"):null),V=u(()=>y.value&&M.value?y.value.add(M.value):null),A=u(()=>t.ticket.accepted_at?ne(t.ticket.accepted_at):null),B=u(()=>`${g.value.format("lll")} (${g.value.fromNow()})`),E=u(()=>`${x.value.format("lll")} (${a("time_left",{time:x.value.fromNow(!0)})})`),C=u(()=>y.value?`${y.value.format("lll")} (${y.value.fromNow()})`:null),$=u(()=>V.value?`${V.value.format("lll")} (${a("time_left",{time:V.value.fromNow(!0)})})`:null),T=u(()=>A.value?`${A.value.format("lll")} (${A.value.fromNow()})`:null),d=u(()=>`${O(t.ticket.weight)} (${a("increment_per_second",{units:t.ticket.weight_increment.toString()})})`),c=u(()=>h.value[`${p.value}_threshold`]),k=u(()=>t.ticket[p.value]),O=_=>_<1e5?_:_.toExponential(1),N=()=>t.ticket.meta?.category_name??t.ticket.category?.name??"",U=()=>t.ticket.meta?.category_short??t.ticket.category?.short??"",ue=()=>s.altInfo?t.ticket.meta?.title??U():U(),Ve=u(()=>t.ticket.meta?.card_title??"Title"),he=u(()=>t.ticket.meta?.card_subtitle??N()),ae=u(()=>t.ticket.meta?.card_content??[]),ce=u(()=>k.value>c.value),Ce=u(()=>({delay:-k.value+"s",duration:c.value+"s"}));return(_,X)=>(w(),S("div",ka,[r(P,{size:"small",class:F(["ticket justify-start px-2",{overflow:ce.value}]),ripple:!1,flat:"",width:"100"},{default:m(()=>[e.ticket.meta?.icon?(w(),R(Ne,{key:0,icon:e.ticket.meta?.icon??"",color:"white"},null,8,["icon"])):G("",!0),l("span",ba,[l("span",wa,v(ue()),1)]),r(Zt,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:m(()=>[r(qt,{width:"500","prepend-icon":e.ticket.meta?.icon??"",title:Ve.value,subtitle:he.value},{default:m(()=>[r(ya,{modelValue:o.value,"onUpdate:modelValue":X[0]||(X[0]=D=>o.value=D)},{default:m(()=>[r(me,{value:"properties"},{default:m(()=>[I(v(_.$t("properties")),1)]),_:1}),r(me,{value:"metrics"},{default:m(()=>[I(v(_.$t("metrics")),1)]),_:1}),r(me,{value:"details"},{default:m(()=>[I(v(_.$t("details")),1)]),_:1})]),_:1},8,["modelValue"]),r(Kt,null,{default:m(()=>[r(we,{modelValue:o.value,"onUpdate:modelValue":X[1]||(X[1]=D=>o.value=D)},{default:m(()=>[r(le,{value:"properties",class:"prose"},{default:m(()=>[typeof ae.value=="string"?(w(),S("div",{key:0,innerHTML:b(i).render(ae.value)},null,8,pa)):(w(),S("table",_a,[l("tbody",null,[(w(!0),S(j,null,se(ae.value,([D,de])=>(w(),S("tr",{key:D},[l("th",null,v(D),1),l("td",{innerHTML:b(i).renderInline(de)},null,8,Ta)]))),128))])]))]),_:1}),r(le,{value:"metrics",class:"prose"},{default:m(()=>[l("table",null,[l("tbody",null,[l("tr",null,[l("th",null,v(_.$t("issued_on")),1),l("td",null,v(B.value),1)]),x.value.isAfter(_.$dayjs())?(w(),S("tr",xa,[l("th",null,v(_.$t("delayed_until")),1),l("td",null,v(E.value),1)])):G("",!0),y.value?(w(),S("tr",Va,[l("th",null,v(_.$t("bound_at")),1),l("td",null,v(C.value),1)])):G("",!0),V.value&&V.value.isAfter(_.$dayjs())?(w(),S("tr",Ca,[l("th",null,v(_.$t("reserved_until")),1),l("td",null,v($.value),1)])):G("",!0),A.value?(w(),S("tr",$a,[l("th",null,v(_.$t("accepted_at")),1),l("td",null,v(T.value),1)])):G("",!0),l("tr",null,[l("th",null,v(_.$t("current_weight")),1),l("td",null,v(d.value),1)]),l("tr",null,[l("th",null,v(_.$t("complexity")),1),l("td",null,v(e.ticket.complexity+" "+b(a)("units")),1)])])])]),_:1}),r(le,{value:"details",class:"prose"},{default:m(()=>[l("table",Sa,[l("thead",null,[l("tr",null,[l("th",Ia,v(_.$t("factor")),1),l("th",Ba,[l("em",{class:"metric",title:_.$t("initial_weight")},[...X[2]||(X[2]=[I("W",-1),l("sub",null,"0",-1)])],8,Ra)]),l("th",Ea,[l("em",{class:"metric",title:_.$t("weight_increment")},[...X[3]||(X[3]=[I("W",-1),l("sub",null,"i",-1)])],8,Pa)]),l("th",Ma,[l("em",{class:"metric",title:_.$t("complexity")},"C",8,Aa)]),l("th",Da,[l("em",{class:"metric",title:_.$t("delay_sec")},"D",8,Wa)]),l("th",Oa,[l("em",{class:"metric",title:_.$t("reservation_sec")},"R",8,La)])])]),l("tbody",null,[(w(!0),S(j,null,se(e.ticket.metrics??{},(D,de)=>(w(),S("tr",{key:de},[l("th",null,v(n.value[de]?.name??_.$t("unknown")),1),l("td",Ua,v(D.initial_weight??0),1),l("td",Ya,v(D.weight_increment??0),1),l("td",Ha,v(D.complexity??0),1),l("td",Na,v(D.delay??0),1),l("td",Xa,v(D.reservation??0),1)]))),128))]),l("tfoot",null,[l("tr",null,[l("th",null,v(_.$t("total")),1),l("td",ja,v(e.ticket.initial_weight),1),l("td",Fa,v(e.ticket.weight_increment),1),l("td",Ga,v(e.ticket.complexity),1),l("td",za,v(e.ticket.delay),1),l("td",Za,v(e.ticket.reservation),1)])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["prepend-icon","title","subtitle"])]),_:1})]),_:1},8,["class"])]))}}),Ka=re(qa,[["__scopeId","data-v-8c1a37e4"]]),Ja=ie({__name:"TicketPool",props:{tickets:{}},setup(e){const t=W(null);na(t,"uuid");const{lock:a,unlock:n,element:o,triggerElement:i}=Mt(t),{x:s}=Pt({type:"movement"});De([o,s],([h,g])=>{!h||!i.value||i.value.dataset.uuid});const p=W(!1);return Xe(()=>{setTimeout(()=>p.value=!0,500)}),(h,g)=>(w(),R(b(Ee),{ref_key:"ticketPool",ref:t,name:"ticket-pool",class:"tickets @container !pt-[1px] !pb-[3px] leading-8",css:p.value,onMouseup:b(n)},{default:m(()=>[(w(!0),S(j,null,se(e.tickets,f=>(w(),R(Ka,{key:f.uuid,"data-uuid":f.uuid,ticket:f,draggable:"true",class:"mr-1",onMousedown:Tt(b(a),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css","onMouseup"]))}}),Qa=re(Ja,[["__scopeId","data-v-1fd3da22"]]);function Te(){async function e(o,i){return await window.axios.patch(ve("ticket-allocator.operators.ready",o),{ready:i})}async function t(o,i){return await window.axios.patch(ve("ticket-allocator.tickets.weight",o),{weight_points:i})}async function a(o,i){return await window.axios.patch(ve("ticket-allocator.tickets.handler",o),{operator_uuid:i??null})}async function n(o){return await window.axios.delete(ve("ticket-allocator.tickets.close",o))}return{ready:e,weight:t,handler:a,close:n}}const en=ie({__name:"TicketRow",props:{tickets:{},pool:{type:Boolean}},setup(e){const t=e;let a=W(!1);const n=u(()=>t.pool?"th":"td"),o=u(()=>t.tickets.reduce((g,{complexity:f})=>g+f,0)),i=u(()=>a.value?"mdi-chevron-down":"mdi-chevron-up"),s=Te(),p=W(null),{isOverDropZone:h}=Ge(p,async g=>{const f=g?.getData("text/plain");if(!f)throw new Error("Ticket UUID undefined.");const x=p.value?.dataset.uuid;return await s.handler(f,x)},!1);return(g,f)=>(w(),S("tr",{ref_key:"ticketRow",ref:p,class:F(["ticket-row",{dragover:b(h)}])},[(w(),R(Z(n.value),{class:"status py-1"},{default:m(()=>[z(g.$slots,"status",{},void 0,!0)]),_:3})),(w(),R(Z(n.value),{class:"name font-weight-bold !pt-[6px]"},{default:m(()=>[z(g.$slots,"name",{},void 0,!0)]),_:3})),(w(),R(Z(n.value),{class:"load !pt-[6px] text-center"},{default:m(()=>[z(g.$slots,"load",{},()=>[I(v(e.tickets.length),1)],!0),f[2]||(f[2]=I("/",-1)),z(g.$slots,"load-max",{},()=>[f[1]||(f[1]=I("∞",-1))],!0)]),_:3})),(w(),R(Z(n.value),{class:"complexity !pt-[6px] text-center"},{default:m(()=>[z(g.$slots,"complexity",{},()=>[I(v(o.value),1)],!0),f[4]||(f[4]=I("/",-1)),z(g.$slots,"complexity-max",{},()=>[f[3]||(f[3]=I("∞",-1))],!0)]),_:3})),r(Qa,{tag:n.value,tickets:e.tickets,class:F({collapsed:b(a)})},null,8,["tag","tickets","class"]),(w(),R(Z(n.value),{class:"more !pt-[2px] text-center"},{default:m(()=>[r(P,{size:"x-small",variant:"tonal",icon:i.value,onClick:f[0]||(f[0]=x=>ke(a)?a.value=!b(a):a=!b(a))},null,8,["icon"])]),_:1}))],2))}}),Qe=re(en,[["__scopeId","data-v-113cb187"]]),tn=ie({__name:"OperatorRow",props:{operator:{}},setup(e){const t=e,a=u(()=>({online:t.operator.online,ready:t.operator.ready,busy:!!t.operator.tickets?.length,full:t.operator.ticket_limit!==null&&t.operator.tickets?.length>=t.operator.ticket_limit})),n=Te(),o=async()=>await n.ready(t.operator.uuid,!t.operator.ready);return(i,s)=>(w(),R(Qe,{tickets:e.operator.tickets,"data-uuid":e.operator.uuid,class:F(["operator",a.value])},{status:m(()=>[r(Ne,{icon:"mdi-account",onClick:o})]),"load-max":m(()=>[I(v(e.operator.ticket_limit??"∞"),1)]),"complexity-max":m(()=>[I(v(e.operator.complexity_limit??"∞"),1)]),name:m(()=>[I(v(e.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}}),an=re(tn,[["__scopeId","data-v-a776c74a"]]);function nn(e,t){return e.reduce((a,n)=>(typeof n[t]=="number"&&(a+=n[t]),a),0)}function xe(e,t){return e.map(a=>Vt(a,t)).filter(a=>a)}function on(e,t){const a=xe(e,t).filter(n=>typeof n=="number");return a.length===0?0:Math.max(...a)}function ln(e,t){const a=xe(e,t).filter(n=>typeof n=="number");return a.length===0?0:Math.min(...a)}function sn(e){return e.map(t=>t[t.$getLocalKey()])}function rn(e,t){const a={},n=Array.isArray(t)?t:[t];return e.forEach(o=>{const i=n.length===1?o[n[0]]:`[${n.map(s=>o[s]).toString()}]`;a[i]=(a[i]||[]).concat(o)}),a}function un(e,t,a){const n=[],o=[];return typeof t=="function"&&o.push(t)&&n.push("asc"),Array.isArray(t)&&t.forEach(i=>o.push(i[0])&&n.push(i[1])),o.length===0&&o.push(t),xt(e,o,n,a)}function cn(e){return{sum:t=>nn(e,t),min:t=>ln(e,t),max:t=>on(e,t),pluck:t=>xe(e,t),groupBy:t=>rn(e,t),sortBy:(t,a="SORT_REGULAR")=>un(e,t,a),keys:()=>sn(e)}}const dn={class:"text-xl leading-tight font-semibold text-gray-800"},vn={class:"align-top"},fn=ie({__name:"Dashboard",props:{layout:{default:"default"},operators:{},operatorTeams:{},tickets:{},ticketCategories:{},factors:{},matchers:{}},setup(e){const t=e,a=je(),n=Fe(),o=At(),i=Dt(),s=u(()=>fe(Ut)),p=u(()=>fe(Yt)),h=u(()=>fe(Ht)),g=u(()=>fe(Nt)),f=Wt(Xt),x=d=>!Array.isArray(o.value.category)||!o.value.category.length?!0:o.value.category.includes(d),y=u(()=>cn(s.value.with("teams").with("tickets",d=>{d.with("category").orderBy(n.value,"desc")}).whereHas("tickets").orWhere(d=>!a.hideEmpty&&d.online).get().filter(d=>!i.value.length||d.teams.some(c=>i.value.includes(c.uuid)))).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),M=u(()=>h.value.unbound().with("category").where("category_uuid",x).orderBy(n.value,"desc").get()),V=Te(),A=W(null),{isOverDropZone:B}=Ge(A,async d=>{const c=d?.getData("text/plain");if(!c)throw new Error("Ticket UUID undefined.");return await V.close(c)},!1);Xe(()=>{f.listen(Ot.PropsInvalidated,()=>ge.reload()).listen(Y.Enrolled,s.value.enroll).listen(Y.Resigned,s.value.resign).listen(Y.NameChanged,s.value.changeName).listen(Y.Online,s.value.setOnline).listen(Y.Offline,s.value.setOffline).listen(Y.Ready,s.value.setReady).listen(Y.NotReady,s.value.setNotReady).listen(Y.TicketLimitAdjusted,s.value.adjustTicketLimit).listen(Y.ComplexityLimitAdjusted,s.value.adjustComplexityLimit).listen(H.Created,h.value.create).listen(H.Closed,h.value.close).listen(H.Bound,h.value.bind).listen(H.Accepted,h.value.accept).listen(H.Unbound,h.value.unbind).listen(H.CategoryChanged,h.value.changeCategory).listen(H.MetaValueSet,h.value.setMetaValue).listen(H.MetaValuesMerged,h.value.mergeMetaValues).listen(H.MetricsAdjusted,h.value.adjustMetrics)});function E(){s.value.save(t.operators),p.value.fresh(t.operatorTeams),h.value.fresh(t.tickets),g.value.fresh(t.ticketCategories)}const C=ge.on("navigate",E),$=ge.on("success",E);Ct(()=>{C(),$()});const T=d=>Object.entries(d).map(([c,k])=>({title:c,value:k}));return(d,c)=>(w(),S(j,null,[r(b($t),{title:d.$t("dashboard")},null,8,["title"]),(w(),R(Z(`${e.layout}-layout`),null,{header:m(()=>[l("h2",dn,v(d.$t("dashboard")),1)]),default:m(()=>[l("div",null,[r(ta,{fluid:""},{default:m(()=>[r(Be,null,{default:m(()=>[r(oe,null,{default:m(()=>[r(St,{modelValue:b(a).all,"onUpdate:modelValue":c[0]||(c[0]=k=>b(a).all=k),variant:"plain",multiple:""},{default:m(()=>[r(P,{value:"show-filters",icon:b(a).showFilters?"mdi-filter-outline":"mdi-filter-off-outline"},null,8,["icon"]),r(P,{value:"hide-empty",icon:b(a).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),r(P,{value:"alt-info",icon:b(a).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),r(P,{value:"pin-header",icon:b(a).pinHeader?"mdi-pin-outline":"mdi-pin-off-outline"},null,8,["icon"]),r(P,{value:"unlocked",icon:b(a).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:b(a).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),b(a).unlocked?(w(),R(It,{key:0,variant:"plain"},{default:m(()=>[r(P,{ref_key:"closeTicket",ref:A,icon:b(B)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),r(P,{icon:"mdi-refresh"})]),_:1})):G("",!0)]),_:1}),r(oe,{cols:"2"},{default:m(()=>[r(Lt,{modelValue:b(n),"onUpdate:modelValue":c[1]||(c[1]=k=>ke(n)?n.value=k:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1}),b(a).showFilters?(w(),R(Be,{key:0},{default:m(()=>[r(oe,{cols:"2"},{default:m(()=>[r(Re,{modelValue:b(i),"onUpdate:modelValue":c[2]||(c[2]=k=>ke(i)?i.value=k:null),multiple:"",clearable:"",chips:"","closable-chips":"",label:d.$t("teams"),items:e.operatorTeams,"item-title":"name","item-value":"uuid"},null,8,["modelValue","label","items"])]),_:1}),r(oe,{cols:"2"},{default:m(()=>[r(ea,{modelValue:b(o).title,"onUpdate:modelValue":c[3]||(c[3]=k=>b(o).title=k),label:d.$t("filter_title")},null,8,["modelValue","label"])]),_:1}),(w(!0),S(j,null,se(e.matchers,(k,O)=>(w(),R(oe,{key:O,cols:"2"},{default:m(()=>[r(Re,{modelValue:b(o)[O],"onUpdate:modelValue":N=>b(o)[O]=N,multiple:"",clearable:"",chips:"","closable-chips":"",label:d.$t(O),items:T(k)},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024))),128))]),_:1})):G("",!0)]),_:1}),r(aa,{"fixed-header":b(a).pinHeader,height:"600px",density:"compact",class:"ticket-monitor"},{default:m(()=>[l("thead",vn,[r(Qe,{pool:"",tickets:M.value},{name:m(()=>[I(v(d.$t("ticket_pool")),1)]),_:1},8,["tickets"])]),r(b(Ee),{tag:"tbody",class:"align-top",name:"operator-pool"},{default:m(()=>[(w(!0),S(j,null,se(y.value,k=>(w(),R(an,{key:k.uuid,operator:k},null,8,["operator"]))),128))]),_:1})]),_:1},8,["fixed-header"])])]),_:1}))],64))}}),Sn=re(fn,[["__scopeId","data-v-a29c0ccf"]]);export{Sn as default};
//# sourceMappingURL=Dashboard-D-Sv4i9I.js.map
