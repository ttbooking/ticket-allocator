import{T as Ee}from"./TransitionGroup-CgASZ7rP.js";import{k as Pe,g as q,p as J,a as et,u as tt,b as ot,c as nt,r as W,d as c,s as pe,w as Ae,e as at,f as r,V as A,h as Q,i as We,j as lt,m as st,l as Oe,n as De,o as Le,q as it,t as ut,v as rt,M as ct,x as dt,y as vt,z as ye,A as mt,F as j,B as K,C as Ue,D as ft,E as He,G as ht,H as pt,I as N,J as yt,K as gt,L as kt,N as bt,O as le,P as _t,Q as wt,R as Ie,S as te,T as S,U as _,W as ve,X as p,Y as R,Z as F,_ as i,$ as Xe,a0 as f,a1 as I,a2 as $,a3 as ae,a4 as se,a5 as oe,a6 as Ye,a7 as Vt,a8 as re,a9 as z,aa as G,ab as ge,ac as $t,ad as Ct,ae as he,af as Tt,ag as xt,ah as St,ai as It}from"./app-BR-NfuQI.js";import{u as Z,i as Bt,M as Rt,a as Mt,b as je,c as Ne,d as Et,e as Pt,T as Fe,f as At,g as Wt,h as Ot,C as Dt,O as H,j as X,V as Lt,k as Ut,l as Ht,m as Xt,n as Yt}from"./OperatorRepository-3rcOLwIN.js";import{u as jt,m as Nt,V as Be,a as Ft,b as Gt}from"./filter-CkLmFBnw.js";import{V as zt,a as Zt}from"./VCard-Bz-jW-yy.js";import{f as Kt,a as qt,s as Jt}from"./VTextField-DGGnpdQN.js";import{V as Qt}from"./VContainer-Cv6ynC-y.js";import{V as Re,a as ce}from"./VRow-DorpDTt3.js";import{V as Me}from"./VAutocomplete-_1Gdz9Zp.js";import{V as eo}from"./VTable-DYhGgCm4.js";import"./VInput-BWlp_2QS.js";import"./VSelectionControl-DbiFz69M.js";import"./VCheckboxBtn-Eq6QXqQM.js";/* empty css              */const to=e=>{const{touchstartX:t,touchendX:o,touchstartY:n,touchendY:l}=e,s=.5,a=16;e.offsetX=o-t,e.offsetY=l-n,Math.abs(e.offsetY)<s*Math.abs(e.offsetX)&&(e.left&&o<t-a&&e.left(e),e.right&&o>t+a&&e.right(e)),Math.abs(e.offsetX)<s*Math.abs(e.offsetY)&&(e.up&&l<n-a&&e.up(e),e.down&&l>n+a&&e.down(e))};function oo(e,t){var n;const o=e.changedTouches[0];t.touchstartX=o.clientX,t.touchstartY=o.clientY,(n=t.start)==null||n.call(t,{originalEvent:e,...t})}function no(e,t){var n;const o=e.changedTouches[0];t.touchendX=o.clientX,t.touchendY=o.clientY,(n=t.end)==null||n.call(t,{originalEvent:e,...t}),to(t)}function ao(e,t){var n;const o=e.changedTouches[0];t.touchmoveX=o.clientX,t.touchmoveY=o.clientY,(n=t.move)==null||n.call(t,{originalEvent:e,...t})}function lo(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:o=>oo(o,t),touchend:o=>no(o,t),touchmove:o=>ao(o,t)}}function so(e,t){var h;const o=t.value,n=o!=null&&o.parent?e.parentElement:e,l=(o==null?void 0:o.options)??{passive:!0},s=(h=t.instance)==null?void 0:h.$.uid;if(!n||!s)return;const a=lo(t.value);n._touchHandlers=n._touchHandlers??Object.create(null),n._touchHandlers[s]=a,Pe(a).forEach(v=>{n.addEventListener(v,a[v],l)})}function io(e,t){var s,a;const o=(s=t.value)!=null&&s.parent?e.parentElement:e,n=(a=t.instance)==null?void 0:a.$.uid;if(!(o!=null&&o._touchHandlers)||!n)return;const l=o._touchHandlers[n];Pe(l).forEach(h=>{o.removeEventListener(h,l[h])}),delete o._touchHandlers[n]}const Ge={mounted:so,unmounted:io},ze=Symbol.for("vuetify:v-window"),Ze=Symbol.for("vuetify:v-window-group"),Ke=J({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...De(),...Oe(),...st()},"VWindow"),ke=q()({name:"VWindow",directives:{Touch:Ge},props:Ke(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const{themeClasses:n}=et(e),{isRtl:l}=tt(),{t:s}=ot(),a=nt(e,Ze),h=W(),v=c(()=>l.value?!e.reverse:e.reverse),m=pe(!1),g=c(()=>{const C=e.direction==="vertical"?"y":"x",k=(v.value?!m.value:m.value)?"-reverse":"";return`v-window-${C}${k}-transition`}),T=pe(0),y=W(void 0),V=c(()=>a.items.value.findIndex(C=>a.selected.value.includes(C.id)));Ae(V,(C,d)=>{const k=a.items.value.length,w=k-1;k<=2?m.value=C<d:C===w&&d===0?m.value=!0:C===0&&d===w?m.value=!1:m.value=C<d}),at(ze,{transition:g,isReversed:m,transitionCount:T,transitionHeight:y,rootRef:h});const b=c(()=>e.continuous||V.value!==0),x=c(()=>e.continuous||V.value!==a.items.value.length-1);function L(){b.value&&a.prev()}function U(){x.value&&a.next()}const M=c(()=>{const C=[],d={icon:l.value?e.nextIcon:e.prevIcon,class:`v-window__${v.value?"right":"left"}`,onClick:a.prev,"aria-label":s("$vuetify.carousel.prev")};C.push(b.value?o.prev?o.prev({props:d}):r(A,d,null):r("div",null,null));const k={icon:l.value?e.prevIcon:e.nextIcon,class:`v-window__${v.value?"left":"right"}`,onClick:a.next,"aria-label":s("$vuetify.carousel.next")};return C.push(x.value?o.next?o.next({props:k}):r(A,k,null):r("div",null,null)),C}),E=c(()=>e.touch===!1?e.touch:{...{left:()=>{v.value?L():U()},right:()=>{v.value?U():L()},start:d=>{let{originalEvent:k}=d;k.stopPropagation()}},...e.touch===!0?{}:e.touch});return Q(()=>We(r(e.tag,{ref:h,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},n.value,e.class],style:e.style},{default:()=>{var C,d;return[r("div",{class:"v-window__container",style:{height:y.value}},[(C=o.default)==null?void 0:C.call(o,{group:a}),e.showArrows!==!1&&r("div",{class:"v-window__controls"},[M.value])]),(d=o.additional)==null?void 0:d.call(o,{group:a})]}}),[[lt("touch"),E.value]])),{group:a}}}),qe=J({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...De(),...dt(),...Nt()},"VWindowItem"),ne=q()({name:"VWindowItem",directives:{Touch:Ge},props:qe(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:o}=t;const n=Le(ze),l=it(e,Ze),{isBooted:s}=ut();if(!n||!l)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const a=pe(!1),h=c(()=>s.value&&(n.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function v(){!a.value||!n||(a.value=!1,n.transitionCount.value>0&&(n.transitionCount.value-=1,n.transitionCount.value===0&&(n.transitionHeight.value=void 0)))}function m(){var b;a.value||!n||(a.value=!0,n.transitionCount.value===0&&(n.transitionHeight.value=ye((b=n.rootRef.value)==null?void 0:b.clientHeight)),n.transitionCount.value+=1)}function g(){v()}function T(b){a.value&&vt(()=>{!h.value||!a.value||!n||(n.transitionHeight.value=ye(b.clientHeight))})}const y=c(()=>{const b=n.isReversed.value?e.reverseTransition:e.transition;return h.value?{name:typeof b!="string"?n.transition.value:b,onBeforeEnter:m,onAfterEnter:v,onEnterCancelled:g,onBeforeLeave:m,onAfterLeave:v,onLeaveCancelled:g,onEnter:T}:!1}),{hasContent:V}=jt(e,l.isSelected);return Q(()=>r(ct,{transition:y.value,disabled:!s.value},{default:()=>{var b;return[We(r("div",{class:["v-window-item",l.selectedClass.value,e.class],style:e.style},[V.value&&((b=o.default)==null?void 0:b.call(o))]),[[rt,l.isSelected.value]])]}})),{groupItem:l}}}),be=Symbol.for("vuetify:v-tabs"),uo=J({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Ue(ft({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),de=q()({name:"VTab",props:uo(),setup(e,t){let{slots:o,attrs:n}=t;const{textColorClasses:l,textColorStyles:s}=mt(e,"sliderColor"),a=W(),h=W(),v=c(()=>e.direction==="horizontal"),m=c(()=>{var T,y;return((y=(T=a.value)==null?void 0:T.group)==null?void 0:y.isSelected.value)??!1});function g(T){var V,b;let{value:y}=T;if(y){const x=(b=(V=a.value)==null?void 0:V.$el.parentElement)==null?void 0:b.querySelector(".v-tab--selected .v-tab__slider"),L=h.value;if(!x||!L)return;const U=getComputedStyle(x).color,M=x.getBoundingClientRect(),E=L.getBoundingClientRect(),C=v.value?"x":"y",d=v.value?"X":"Y",k=v.value?"right":"bottom",w=v.value?"width":"height",O=M[C],Y=E[C],D=O>Y?M[k]-E[k]:M[C]-E[C],me=Math.sign(D)>0?v.value?"right":"bottom":Math.sign(D)<0?v.value?"left":"top":"center",fe=(Math.abs(D)+(Math.sign(D)<0?M[w]:E[w]))/Math.max(M[w],E[w])||0,ee=M[w]/E[w]||0,ie=1.5;qt(L,{backgroundColor:[U,"currentcolor"],transform:[`translate${d}(${D}px) scale${d}(${ee})`,`translate${d}(${D/ie}px) scale${d}(${(fe-1)/ie+1})`,"none"],transformOrigin:Array(3).fill(me)},{duration:225,easing:Jt})}}return Q(()=>{const T=A.filterProps(e);return r(A,K({symbol:be,ref:a,class:["v-tab",e.class],style:e.style,tabindex:m.value?0:-1,role:"tab","aria-selected":String(m.value),active:!1},T,n,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":g}),{...o,default:()=>{var y;return r(j,null,[((y=o.default)==null?void 0:y.call(o))??e.text,!e.hideSlider&&r("div",{ref:h,class:["v-tab__slider",l.value],style:s.value},null)])}})}),Kt({},a)}}),ro=J({...Ue(Ke(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),co=q()({name:"VTabsWindow",props:ro(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const n=Le(be,null),l=He(e,"modelValue"),s=c({get(){var a;return l.value!=null||!n?l.value:(a=n.items.value.find(h=>n.selected.value.includes(h.id)))==null?void 0:a.value},set(a){l.value=a}});return Q(()=>{const a=ke.filterProps(e);return r(ke,K({_as:"VTabsWindow"},a,{modelValue:s.value,"onUpdate:modelValue":h=>s.value=h,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),o)}),{}}}),vo=J({...qe()},"VTabsWindowItem"),mo=q()({name:"VTabsWindowItem",props:vo(),setup(e,t){let{slots:o}=t;return Q(()=>{const n=ne.filterProps(e);return r(ne,K({_as:"VTabsWindowItem"},n,{class:["v-tabs-window-item",e.class],style:e.style}),o)}),{}}});function fo(e){return e?e.map(t=>bt(t)?t:{text:t,value:t}):[]}const ho=J({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Ft({mandatory:"force",selectedClass:"v-tab-item--selected"}),...kt(),...Oe()},"VTabs"),po=q()({name:"VTabs",props:ho(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:o,slots:n}=t;const l=He(e,"modelValue"),s=c(()=>fo(e.items)),{densityClasses:a}=ht(e),{backgroundColorClasses:h,backgroundColorStyles:v}=pt(N(e,"bgColor")),{scopeId:m}=yt();return gt({VTab:{color:N(e,"color"),direction:N(e,"direction"),stacked:N(e,"stacked"),fixed:N(e,"fixedTabs"),sliderColor:N(e,"sliderColor"),hideSlider:N(e,"hideSlider")}}),Q(()=>{const g=Be.filterProps(e),T=!!(n.window||e.items.length>0);return r(j,null,[r(Be,K(g,{modelValue:l.value,"onUpdate:modelValue":y=>l.value=y,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},a.value,h.value,e.class],style:[{"--v-tabs-height":ye(e.height)},v.value,e.style],role:"tablist",symbol:be},m,o),{default:()=>{var y;return[((y=n.default)==null?void 0:y.call(n))??s.value.map(V=>{var b;return((b=n.tab)==null?void 0:b.call(n,{item:V}))??r(de,K(V,{key:V.text,value:V.value}),{default:n[`tab.${V.value}`]?()=>{var x;return(x=n[`tab.${V.value}`])==null?void 0:x.call(n,{item:V})}:void 0})})]}}),T&&r(co,K({modelValue:l.value,"onUpdate:modelValue":y=>l.value=y,key:"tabs-window"},m),{default:()=>{var y;return[s.value.map(V=>{var b;return((b=n.item)==null?void 0:b.call(n,{item:V}))??r(mo,{value:V.value},{default:()=>{var x;return(x=n[`item.${V.value}`])==null?void 0:x.call(n,{item:V})}})}),(y=n.window)==null?void 0:y.call(n)]}})])}),{}}});function yo(e,t){const o=W();return Z(e,"dragstart",n=>{if(o.value=n.target,typeof t=="string"){const l=t;t=(s,a)=>{a==null||a.setData("text/plain",s.dataset[l]??"")}}t==null||t(o.value,n.dataTransfer)}),Z(e,"dragend",()=>{o.value=null}),{element:o}}function Je(e,t,o=!0){const n=W(!1);let l=0;return Bt&&(Z(e,"dragenter",s=>{s.preventDefault(),l++,n.value=!0}),Z(e,"dragover",s=>{s.preventDefault()}),Z(e,"dragleave",s=>{s.preventDefault(),l--,l===0&&(n.value=!1)}),Z(e,"drop",s=>{var a;if(s.preventDefault(),l=0,n.value=!1,t)if(o){const h=Array.from(((a=s.dataTransfer)==null?void 0:a.files)??[]);t(h.length===0?null:h)}else t(s.dataTransfer)})),{isOverDropZone:n}}const go={class:"d-inline-block"},ko={class:"overflow-hidden text-white"},bo={class:"title relative inline-block"},_o=["innerHTML"],wo={key:1},Vo=["innerHTML"],$o={key:0},Co={key:1},To={key:2},xo={key:3},So={class:"table-fixed"},Io={class:"w-1/3"},Bo={class:"text-center"},Ro=["title"],Mo={class:"text-center"},Eo=["title"],Po={class:"text-center"},Ao=["title"],Wo={class:"text-center"},Oo=["title"],Do={class:"text-center"},Lo=["title"],Uo={class:"text-right"},Ho={class:"text-right"},Xo={class:"text-right"},Yo={class:"text-right"},jo={class:"text-right"},No={class:"text-right"},Fo={class:"text-right"},Go={class:"text-right"},zo={class:"text-right"},Zo={class:"text-right"},Ko=le({__name:"Ticket",props:{ticket:{}},setup(e){_t(u=>({"0c560d15":$e.value.delay,"2b070e7c":$e.value.duration}));const t=e,{t:o}=wt(),n=c(()=>Ie().props.factors),l=W(null),s=new Rt({linkify:!0}).use(Mt),a=je(),h=Ne(),v=c(()=>Ie().props.options),m=c(()=>te(t.ticket.created_at)),g=c(()=>te.duration(t.ticket.delay,"s")),T=c(()=>m.value.add(g.value)),y=c(()=>t.ticket.bound_at?te(t.ticket.bound_at):null),V=c(()=>t.ticket.reservation?te.duration(t.ticket.reservation,"s"):null),b=c(()=>y.value&&V.value?y.value.add(V.value):null),x=c(()=>t.ticket.accepted_at?te(t.ticket.accepted_at):null),L=c(()=>`${m.value.format("lll")} (${m.value.fromNow()})`),U=c(()=>`${T.value.format("lll")} (${o("time_left",{time:T.value.fromNow(!0)})})`),M=c(()=>y.value?`${y.value.format("lll")} (${y.value.fromNow()})`:null),E=c(()=>b.value?`${b.value.format("lll")} (${o("time_left",{time:b.value.fromNow(!0)})})`:null),C=c(()=>x.value?`${x.value.format("lll")} (${x.value.fromNow()})`:null),d=c(()=>`${O(t.ticket.weight)} (${o("increment_per_second",{units:t.ticket.weight_increment.toString()})})`),k=c(()=>v.value[`${h.value}_threshold`]),w=c(()=>t.ticket[h.value]),O=u=>u<1e5?u:u.toExponential(1),Y=()=>{var u,B;return((u=t.ticket.meta)==null?void 0:u.category_name)??((B=t.ticket.category)==null?void 0:B.name)??""},D=()=>{var u,B;return((u=t.ticket.meta)==null?void 0:u.category_short)??((B=t.ticket.category)==null?void 0:B.short)??""},me=()=>{var u;return a.altInfo?((u=t.ticket.meta)==null?void 0:u.title)??D():D()},Ve=c(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_title)??"Title"}),fe=c(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_subtitle)??Y()}),ee=c(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_content)??[]}),ie=c(()=>w.value>k.value),$e=c(()=>({delay:-w.value+"s",duration:k.value+"s"}));return(u,B)=>(_(),S("div",go,[r(A,{size:"small",class:ve(["ticket justify-start px-2",{overflow:ie.value}]),ripple:!1,flat:"",width:"100"},{default:p(()=>{var Ce,Te;return[(Ce=u.ticket.meta)!=null&&Ce.icon?(_(),R(Xe,{key:0,icon:((Te=u.ticket.meta)==null?void 0:Te.icon)??"",color:"white"},null,8,["icon"])):F("",!0),i("span",ko,[i("span",bo,f(me()),1)]),r(Gt,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:p(()=>{var xe;return[r(zt,{width:"500","prepend-icon":((xe=u.ticket.meta)==null?void 0:xe.icon)??"",title:Ve.value,subtitle:fe.value},{default:p(()=>[r(po,{modelValue:l.value,"onUpdate:modelValue":B[0]||(B[0]=P=>l.value=P)},{default:p(()=>[r(de,{value:"properties"},{default:p(()=>[I(f(u.$t("properties")),1)]),_:1}),r(de,{value:"metrics"},{default:p(()=>[I(f(u.$t("metrics")),1)]),_:1}),r(de,{value:"details"},{default:p(()=>[I(f(u.$t("details")),1)]),_:1})]),_:1},8,["modelValue"]),r(Zt,null,{default:p(()=>[r(ke,{modelValue:l.value,"onUpdate:modelValue":B[1]||(B[1]=P=>l.value=P)},{default:p(()=>[r(ne,{value:"properties",class:"prose"},{default:p(()=>[typeof ee.value=="string"?(_(),S("div",{key:0,innerHTML:$(s).render(ee.value)},null,8,_o)):(_(),S("table",wo,[i("tbody",null,[(_(!0),S(j,null,ae(ee.value,([P,ue])=>(_(),S("tr",{key:P},[i("th",null,f(P),1),i("td",{innerHTML:$(s).renderInline(ue)},null,8,Vo)]))),128))])]))]),_:1}),r(ne,{value:"metrics",class:"prose"},{default:p(()=>[i("table",null,[i("tbody",null,[i("tr",null,[i("th",null,f(u.$t("issued_on")),1),i("td",null,f(L.value),1)]),T.value.isAfter(u.$dayjs())?(_(),S("tr",$o,[i("th",null,f(u.$t("delayed_until")),1),i("td",null,f(U.value),1)])):F("",!0),y.value?(_(),S("tr",Co,[i("th",null,f(u.$t("bound_at")),1),i("td",null,f(M.value),1)])):F("",!0),b.value&&b.value.isAfter(u.$dayjs())?(_(),S("tr",To,[i("th",null,f(u.$t("reserved_until")),1),i("td",null,f(E.value),1)])):F("",!0),x.value?(_(),S("tr",xo,[i("th",null,f(u.$t("accepted_at")),1),i("td",null,f(C.value),1)])):F("",!0),i("tr",null,[i("th",null,f(u.$t("current_weight")),1),i("td",null,f(d.value),1)]),i("tr",null,[i("th",null,f(u.$t("complexity")),1),i("td",null,f(u.ticket.complexity+" "+$(o)("units")),1)])])])]),_:1}),r(ne,{value:"details",class:"prose"},{default:p(()=>[i("table",So,[i("thead",null,[i("tr",null,[i("th",Io,f(u.$t("factor")),1),i("th",Bo,[i("em",{class:"metric",title:u.$t("initial_weight")},B[2]||(B[2]=[I("W"),i("sub",null,"0",-1)]),8,Ro)]),i("th",Mo,[i("em",{class:"metric",title:u.$t("weight_increment")},B[3]||(B[3]=[I("W"),i("sub",null,"i",-1)]),8,Eo)]),i("th",Po,[i("em",{class:"metric",title:u.$t("complexity")},"C",8,Ao)]),i("th",Wo,[i("em",{class:"metric",title:u.$t("delay_sec")},"D",8,Oo)]),i("th",Do,[i("em",{class:"metric",title:u.$t("reservation_sec")},"R",8,Lo)])])]),i("tbody",null,[(_(!0),S(j,null,ae(u.ticket.metrics??{},(P,ue)=>{var Se;return _(),S("tr",{key:ue},[i("th",null,f(((Se=n.value[ue])==null?void 0:Se.name)??u.$t("unknown")),1),i("td",Uo,f(P.initial_weight??0),1),i("td",Ho,f(P.weight_increment??0),1),i("td",Xo,f(P.complexity??0),1),i("td",Yo,f(P.delay??0),1),i("td",jo,f(P.reservation??0),1)])}),128))]),i("tfoot",null,[i("tr",null,[i("th",null,f(u.$t("total")),1),i("td",No,f(u.ticket.initial_weight),1),i("td",Fo,f(u.ticket.weight_increment),1),i("td",Go,f(u.ticket.complexity),1),i("td",zo,f(u.ticket.delay),1),i("td",Zo,f(u.ticket.reservation),1)])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["prepend-icon","title","subtitle"])]}),_:1})]}),_:1},8,["class"])]))}}),qo=se(Ko,[["__scopeId","data-v-8c1a37e4"]]),Jo=le({__name:"TicketPool",props:{tickets:{}},setup(e){const t=W(null);yo(t,"uuid");const{lock:o,unlock:n,element:l,triggerElement:s}=Et(t),{x:a}=Pt({type:"movement"});c(()=>oe(Fe)),Ae([l,a],([v,m])=>{!v||!s.value||s.value.dataset.uuid});const h=W(!1);return Ye(()=>{setTimeout(()=>h.value=!0,500)}),(v,m)=>(_(),R($(Ee),{ref_key:"ticketPool",ref:t,name:"ticket-pool",class:"tickets @container !pt-[1px] !pb-[3px] leading-8",css:h.value,onMouseup:$(n)},{default:p(()=>[(_(!0),S(j,null,ae(v.tickets,g=>(_(),R(qo,{key:g.uuid,"data-uuid":g.uuid,ticket:g,draggable:"true",class:"mr-1",onMousedown:Vt($(o),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css","onMouseup"]))}}),Qo=se(Jo,[["__scopeId","data-v-1fd3da22"]]);function _e(){async function e(l,s){return await window.axios.patch(re("ticket-allocator.operators.ready",l),{ready:s})}async function t(l,s){return await window.axios.patch(re("ticket-allocator.tickets.weight",l),{weight_points:s})}async function o(l,s){return await window.axios.patch(re("ticket-allocator.tickets.handler",l),{operator_uuid:s??null})}async function n(l){return await window.axios.delete(re("ticket-allocator.tickets.close",l))}return{ready:e,weight:t,handler:o,close:n}}const en=le({__name:"TicketRow",props:{tickets:{},pool:{type:Boolean}},setup(e){const t=e;let o=W(!1);const n=c(()=>t.pool?"th":"td"),l=c(()=>t.tickets.reduce((m,{complexity:g})=>m+g,0)),s=c(()=>o.value?"mdi-chevron-down":"mdi-chevron-up"),a=_e(),h=W(null),{isOverDropZone:v}=Je(h,async m=>{var y;const g=m==null?void 0:m.getData("text/plain");if(!g)throw new Error("Ticket UUID undefined.");const T=(y=h.value)==null?void 0:y.dataset.uuid;return await a.handler(g,T)},!1);return(m,g)=>(_(),S("tr",{ref_key:"ticketRow",ref:h,class:ve(["ticket-row",{dragover:$(v)}])},[(_(),R(z(n.value),{class:"status py-1"},{default:p(()=>[G(m.$slots,"status",{},void 0,!0)]),_:3})),(_(),R(z(n.value),{class:"name font-weight-bold !pt-[6px]"},{default:p(()=>[G(m.$slots,"name",{},void 0,!0)]),_:3})),(_(),R(z(n.value),{class:"load !pt-[6px] text-center"},{default:p(()=>[G(m.$slots,"load",{},()=>[I(f(m.tickets.length),1)],!0),g[2]||(g[2]=I("/")),G(m.$slots,"load-max",{},()=>[g[1]||(g[1]=I("∞"))],!0)]),_:3})),(_(),R(z(n.value),{class:"complexity !pt-[6px] text-center"},{default:p(()=>[G(m.$slots,"complexity",{},()=>[I(f(l.value),1)],!0),g[4]||(g[4]=I("/")),G(m.$slots,"complexity-max",{},()=>[g[3]||(g[3]=I("∞"))],!0)]),_:3})),r(Qo,{tag:n.value,tickets:m.tickets,class:ve({collapsed:$(o)})},null,8,["tag","tickets","class"]),(_(),R(z(n.value),{class:"more !pt-[2px] text-center"},{default:p(()=>[r(A,{size:"x-small",variant:"tonal",icon:s.value,onClick:g[0]||(g[0]=T=>ge(o)?o.value=!$(o):o=!$(o))},null,8,["icon"])]),_:1}))],2))}}),Qe=se(en,[["__scopeId","data-v-113cb187"]]),tn=le({__name:"OperatorRow",props:{operator:{}},setup(e){const t=e,o=c(()=>{var s,a;return{online:t.operator.online,ready:t.operator.ready,busy:!!((s=t.operator.tickets)!=null&&s.length),full:t.operator.ticket_limit!==null&&((a=t.operator.tickets)==null?void 0:a.length)>=t.operator.ticket_limit}}),n=_e(),l=async()=>await n.ready(t.operator.uuid,!t.operator.ready);return(s,a)=>(_(),R(Qe,{tickets:s.operator.tickets,"data-uuid":s.operator.uuid,class:ve(["operator",o.value])},{status:p(()=>[r(Xe,{icon:"mdi-account",onClick:l})]),"load-max":p(()=>[I(f(s.operator.ticket_limit??"∞"),1)]),"complexity-max":p(()=>[I(f(s.operator.complexity_limit??"∞"),1)]),name:p(()=>[I(f(s.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}}),on=se(tn,[["__scopeId","data-v-a776c74a"]]);function nn(e,t){return e.reduce((o,n)=>(typeof n[t]=="number"&&(o+=n[t]),o),0)}function we(e,t){return e.map(o=>Ct(o,t)).filter(o=>o)}function an(e,t){const o=we(e,t).filter(n=>typeof n=="number");return o.length===0?0:Math.max(...o)}function ln(e,t){const o=we(e,t).filter(n=>typeof n=="number");return o.length===0?0:Math.min(...o)}function sn(e){return e.map(t=>t[t.$getLocalKey()])}function un(e,t){const o={},n=Array.isArray(t)?t:[t];return e.forEach(l=>{const s=n.length===1?l[n[0]]:`[${n.map(a=>l[a]).toString()}]`;o[s]=(o[s]||[]).concat(l)}),o}function rn(e,t,o){const n=[],l=[];return typeof t=="function"&&l.push(t)&&n.push("asc"),Array.isArray(t)&&t.forEach(s=>l.push(s[0])&&n.push(s[1])),l.length===0&&l.push(t),$t(e,l,n,o)}function cn(e){return{sum:t=>nn(e,t),min:t=>ln(e,t),max:t=>an(e,t),pluck:t=>we(e,t),groupBy:t=>un(e,t),sortBy:(t,o="SORT_REGULAR")=>rn(e,t,o),keys:()=>sn(e)}}const dn={class:"text-xl leading-tight font-semibold text-gray-800"},vn={class:"align-top"},mn=le({__name:"Dashboard",props:{layout:{default:"default"},operators:{},operatorTeams:{},tickets:{},ticketCategories:{},factors:{},matchers:{}},setup(e){const t=e,o=je(),n=Ne(),l=At(),s=Wt(),a=c(()=>oe(Ut)),h=c(()=>oe(Ht)),v=c(()=>oe(Fe)),m=c(()=>oe(Xt)),g=Ot(Yt),T=d=>Object.entries(l.value).reduce((k,[w,O])=>{const Y=d==null?void 0:d[w],D=Y===void 0||!O.length||O.map(String).includes(Y.toString());return k&&D},!0),y=c(()=>cn(a.value.with("teams").with("tickets",d=>{d.with("category").where("meta",T).orderBy(n.value,"desc")}).whereHas("tickets").orWhere(d=>!o.hideEmpty&&d.online).get().filter(d=>!s.value.length||d.teams.some(k=>s.value.includes(k.uuid)))).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),V=c(()=>v.value.unbound().with("category").where("meta",T).orderBy(n.value,"desc").get()),b=_e(),x=W(null),{isOverDropZone:L}=Je(x,async d=>{const k=d==null?void 0:d.getData("text/plain");if(!k)throw new Error("Ticket UUID undefined.");return await b.close(k)},!1);Ye(()=>{g.listen(Dt.PropsInvalidated,()=>he.reload()).listen(H.Enrolled,a.value.enroll).listen(H.Resigned,a.value.resign).listen(H.NameChanged,a.value.changeName).listen(H.Online,a.value.setOnline).listen(H.Offline,a.value.setOffline).listen(H.Ready,a.value.setReady).listen(H.NotReady,a.value.setNotReady).listen(H.TicketLimitAdjusted,a.value.adjustTicketLimit).listen(H.ComplexityLimitAdjusted,a.value.adjustComplexityLimit).listen(X.Created,v.value.create).listen(X.Closed,v.value.close).listen(X.Bound,v.value.bind).listen(X.Accepted,v.value.accept).listen(X.Unbound,v.value.unbind).listen(X.CategoryChanged,v.value.changeCategory).listen(X.MetaValueSet,v.value.setMetaValue).listen(X.MetaValuesMerged,v.value.mergeMetaValues).listen(X.MetricsAdjusted,v.value.adjustMetrics)});function U(){a.value.save(t.operators),h.value.fresh(t.operatorTeams),v.value.fresh(t.tickets),m.value.fresh(t.ticketCategories)}const M=he.on("navigate",U),E=he.on("success",U);Tt(()=>{M(),E()});const C=d=>Object.entries(d).map(([k,w])=>({title:k,value:w}));return(d,k)=>(_(),S(j,null,[r($(xt),{title:d.$t("dashboard")},null,8,["title"]),(_(),R(z(`${d.layout}-layout`),null,{header:p(()=>[i("h2",dn,f(d.$t("dashboard")),1)]),default:p(()=>[i("div",null,[r(Qt,{fluid:""},{default:p(()=>[r(Re,null,{default:p(()=>[r(ce,null,{default:p(()=>[r(St,{modelValue:$(o).all,"onUpdate:modelValue":k[0]||(k[0]=w=>$(o).all=w),variant:"plain",multiple:""},{default:p(()=>[r(A,{value:"show-filters",icon:$(o).showFilters?"mdi-filter-outline":"mdi-filter-off-outline"},null,8,["icon"]),r(A,{value:"hide-empty",icon:$(o).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),r(A,{value:"alt-info",icon:$(o).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),r(A,{value:"unlocked",icon:$(o).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:$(o).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),$(o).unlocked?(_(),R(It,{key:0,variant:"plain"},{default:p(()=>[r(A,{ref_key:"closeTicket",ref:x,icon:$(L)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),r(A,{icon:"mdi-refresh"})]),_:1})):F("",!0)]),_:1}),r(ce,{cols:"2"},{default:p(()=>[r(Lt,{modelValue:$(n),"onUpdate:modelValue":k[1]||(k[1]=w=>ge(n)?n.value=w:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1}),$(o).showFilters?(_(),R(Re,{key:0},{default:p(()=>[r(ce,{cols:"2"},{default:p(()=>[r(Me,{modelValue:$(s),"onUpdate:modelValue":k[2]||(k[2]=w=>ge(s)?s.value=w:null),multiple:"",clearable:"",chips:"","closable-chips":"",label:d.$t("teams"),items:d.operatorTeams,"item-title":"name","item-value":"uuid"},null,8,["modelValue","label","items"])]),_:1}),(_(!0),S(j,null,ae(d.matchers,(w,O)=>(_(),R(ce,{key:O,cols:"2"},{default:p(()=>[r(Me,{modelValue:$(l)[O],"onUpdate:modelValue":Y=>$(l)[O]=Y,multiple:"",clearable:"",chips:"","closable-chips":"",label:d.$t(O),items:C(w)},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024))),128))]),_:1})):F("",!0)]),_:1}),r(eo,{"fixed-header":"",height:"600px",density:"compact",class:"ticket-monitor"},{default:p(()=>[i("thead",vn,[r(Qe,{pool:"",tickets:V.value},{name:p(()=>[I(f(d.$t("ticket_pool")),1)]),_:1},8,["tickets"])]),r($(Ee),{tag:"tbody",class:"align-top",name:"operator-pool"},{default:p(()=>[(_(!0),S(j,null,ae(y.value,w=>(_(),R(on,{key:w.uuid,operator:w},null,8,["operator"]))),128))]),_:1})]),_:1})])]),_:1}))],64))}}),Sn=se(mn,[["__scopeId","data-v-811338dd"]]);export{Sn as default};
//# sourceMappingURL=Dashboard-DlStBZkI.js.map
