import{f as ge,g as Ve,h as ye,i as ke,j as xe,k as Ce,l as be,n as Se}from"./filter-_pGNJYyg.js";import{V as H,f as we,d as Fe}from"./VTextField-4Ee2jiyl.js";import{g as Ie,p as Ae,b as De,r as P,s as w,aZ as Pe,D as Re,I as O,a_ as Te,d as g,w as R,B as j,ao as Me,i as Ee,f,h as x,$ as G,a$ as _e,F as U,E as C,b0 as Le,b1 as W,av as Be,b2 as Ne,n as Ke,l as Oe,ap as Ue,a1 as ze,b3 as $e,G as qe,b4 as Z,b5 as He,b6 as J}from"./app-CLBWdXnH.js";import{a as je}from"./VInput-CWpI0iWS.js";import{V as Ge}from"./VCheckboxBtn-D8K4EJkz.js";const We=Ae({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Se({filterKeys:["title"]}),...be(),...qe(Fe({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...$e({transition:!1})},"VAutocomplete"),el=Ie()({name:"VAutocomplete",props:We(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,Q){let{slots:r}=Q;const{t:T}=De(),d=P(),h=w(!1),V=w(!0),M=w(!1),z=P(),E=P(),o=w(-1),{items:$,transformIn:X,transformOut:Y}=Pe(l),{textColorClasses:ee,textColorStyles:le}=Re(()=>d.value?.color),c=O(l,"search",""),u=O(l,"modelValue",[],e=>X(e===null?[null]:Te(e)),e=>{const n=Y(e);return l.multiple?n:n[0]??null}),te=g(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:u.value.length),F=je(l),{filteredItems:_,getMatches:ae}=ge(l,$,()=>V.value?"":c.value),p=g(()=>l.hideSelected?_.value.filter(e=>!u.value.some(n=>n.value===e.value)):_.value),I=g(()=>!!(l.chips||r.chip)),k=g(()=>I.value||!!r.selection),ue=g(()=>u.value.map(e=>e.props.value)),L=g(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&c.value===p.value[0]?.title)&&p.value.length>0&&!V.value&&!M.value),A=g(()=>l.hideNoData&&!p.value.length||F.isReadonly.value||F.isDisabled.value),B=O(l,"menu"),s=g({get:()=>B.value,set:e=>{B.value&&!e&&z.value?.Î¨openChildren.size||e&&A.value||(B.value=e)}}),q=g(()=>s.value?l.closeText:l.openText),N=P(),ne=Ve(N,d);function oe(e){l.openOnClear&&(s.value=!0),c.value=""}function se(){A.value||(s.value=!0)}function ie(e){A.value||(h.value&&(e.preventDefault(),e.stopPropagation()),s.value=!s.value)}function re(e){e.key!==" "&&Z(e)&&d.value?.focus()}function ce(e){if(F.isReadonly.value)return;const n=d.value?.selectionStart,i=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(s.value=!0),["Escape"].includes(e.key)&&(s.value=!1),L.value&&["Enter","Tab"].includes(e.key)&&!u.value.some(t=>{let{value:a}=t;return a===p.value[0].value})&&y(p.value[0]),e.key==="ArrowDown"&&L.value&&N.value?.focus("next"),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&k.value&&u.value.length>0&&!c.value)return y(u.value[0],!1);if(~o.value){e.preventDefault();const t=o.value;y(u.value[o.value],!1),o.value=t>=i-1?i-2:t}else e.key==="Backspace"&&!c.value&&(o.value=i-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(o.value<0&&n&&n>0)return;const t=o.value>-1?o.value-1:i-1;if(u.value[t])o.value=t;else{const a=c.value?.length??null;o.value=-1,d.value?.setSelectionRange(a,a)}}else if(e.key==="ArrowRight"){if(o.value<0)return;const t=o.value+1;u.value[t]?o.value=t:(o.value=-1,d.value?.setSelectionRange(0,0))}else~o.value&&Z(e)&&(o.value=-1)}function ve(e){if(J(d.value,":autofill")||J(d.value,":-webkit-autofill")){const n=$.value.find(i=>i.title===e.target.value);n&&y(n)}}function de(){l.eager&&E.value?.calculateVisibleItems()}function fe(){h.value&&(V.value=!0,d.value?.focus())}function me(e){h.value=!0,setTimeout(()=>{M.value=!0})}function he(e){M.value=!1}function pe(e){(e==null||e===""&&!l.multiple&&!k.value)&&(u.value=[])}const K=w(!1);function y(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const i=u.value.findIndex(a=>(l.valueComparator||He)(a.value,e.value)),t=n??!~i;if(~i){const a=t?[...u.value,e]:[...u.value];a.splice(i,1),u.value=a}else t&&(u.value=[...u.value,e]);l.clearOnSelect&&(c.value="")}else{const i=n!==!1;u.value=i?[e]:[],c.value=i&&!k.value?e.title:"",j(()=>{s.value=!1,V.value=!0})}}return R(h,(e,n)=>{e!==n&&(e?(K.value=!0,c.value=l.multiple||k.value?"":String(u.value.at(-1)?.props.title??""),V.value=!0,j(()=>K.value=!1)):(!l.multiple&&c.value==null&&(u.value=[]),s.value=!1,(l.multiple||k.value)&&(c.value=""),o.value=-1))}),R(c,e=>{!h.value||K.value||(e&&(s.value=!0),V.value=!e)}),R(s,()=>{if(!l.hideSelected&&s.value&&u.value.length){const e=p.value.findIndex(n=>u.value.some(i=>n.value===i.value));Me&&window.requestAnimationFrame(()=>{e>=0&&E.value?.scrollToIndex(e)})}}),R(()=>l.items,(e,n)=>{s.value||h.value&&!n.length&&e.length&&(s.value=!0)}),Ee(()=>{const e=!!(!l.hideNoData||p.value.length||r["prepend-item"]||r["append-item"]||r["no-data"]),n=u.value.length>0,i=H.filterProps(l);return f(H,C({ref:d},i,{modelValue:c.value,"onUpdate:modelValue":[t=>c.value=t,pe],focused:h.value,"onUpdate:focused":t=>h.value=t,validationValue:u.externalValue,counterValue:te.value,dirty:n,onChange:ve,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":s.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!k.value,"v-autocomplete--selecting-index":o.value>-1},l.class],style:l.style,readonly:F.isReadonly.value,placeholder:n?void 0:l.placeholder,"onClick:clear":oe,"onMousedown:control":se,onKeydown:ce}),{...r,default:()=>x(U,null,[f(ye,C({ref:z,modelValue:s.value,"onUpdate:modelValue":t=>s.value=t,activator:"parent",contentClass:"v-autocomplete__content",disabled:A.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterEnter:de,onAfterLeave:fe},l.menuProps),{default:()=>[e&&f(Le,C({ref:N,selected:ue.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:t=>t.preventDefault(),onKeydown:re,onFocusin:me,onFocusout:he,tabindex:"-1","aria-live":"polite",color:l.itemColor??l.color},ne,l.listProps),{default:()=>[r["prepend-item"]?.(),!p.value.length&&!l.hideNoData&&(r["no-data"]?.()??f(W,{key:"no-data",title:T(l.noDataText)},null)),f(ke,{ref:E,renderless:!0,items:p.value,itemKey:"value"},{default:t=>{let{item:a,index:m,itemRef:D}=t;const b=C(a.props,{ref:D,key:a.value,active:L.value&&m===0?!0:void 0,onClick:()=>y(a,null)});return r.item?.({item:a,index:m,props:b})??f(W,C(b,{role:"option"}),{prepend:S=>{let{isSelected:v}=S;return x(U,null,[l.multiple&&!l.hideSelected?f(Ge,{key:a.value,modelValue:v,ripple:!1,tabindex:"-1"},null):void 0,a.props.prependAvatar&&f(Be,{image:a.props.prependAvatar},null),a.props.prependIcon&&f(G,{icon:a.props.prependIcon},null)])},title:()=>V.value?a.title:xe("v-autocomplete",a.title,ae(a)?.title)})}}),r["append-item"]?.()]})]}),u.value.map((t,a)=>{function m(v){v.stopPropagation(),v.preventDefault(),y(t,!1)}const D={"onClick:close":m,onKeydown(v){v.key!=="Enter"&&v.key!==" "||(v.preventDefault(),v.stopPropagation(),m(v))},onMousedown(v){v.preventDefault(),v.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},b=I.value?!!r.chip:!!r.selection,S=b?Ne(I.value?r.chip({item:t,index:a,props:D}):r.selection({item:t,index:a})):void 0;if(!(b&&!S))return x("div",{key:t.value,class:Oe(["v-autocomplete__selection",a===o.value&&["v-autocomplete__selection--selected",ee.value]]),style:Ke(a===o.value?le.value:{})},[I.value?r.chip?f(Ue,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:t.title}}},{default:()=>[S]}):f(Ce,C({key:"chip",closable:l.closableChips,size:"small",text:t.title,disabled:t.props.disabled},D),null):S??x("span",{class:"v-autocomplete__selection-text"},[t.title,l.multiple&&a<u.value.length-1&&x("span",{class:"v-autocomplete__selection-comma"},[ze(",")])])])})]),"append-inner":function(){for(var t=arguments.length,a=new Array(t),m=0;m<t;m++)a[m]=arguments[m];return x(U,null,[r["append-inner"]?.(...a),l.menuIcon?f(G,{class:"v-autocomplete__menu-icon",color:d.value?.fieldIconColor,icon:l.menuIcon,onMousedown:ie,onClick:_e,"aria-label":T(q.value),title:T(q.value),tabindex:"-1"},null):void 0])}})}),we({isFocused:h,isPristine:V,menu:s,search:c,filteredItems:_,select:y},d)}});export{el as V};
//# sourceMappingURL=VAutocomplete-CAmWEw96.js.map
