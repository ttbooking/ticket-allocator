import{f as ge,g as Ve,h as ye,i as be,j as ke,k as Ce,l as we,n as xe}from"./filter-BuSi9GL_.js";import{V as j,d as Se}from"./VTextField-JGNfAWvE.js";import{g as Fe,p as Ie,j as Ae,r as P,q as S,a_ as De,u as Pe,C as O,a$ as Re,c as g,w as R,I as H,ap as Te,a as Me,b as d,d as C,a0 as W,b0 as _e,F as U,m as y,b1 as Ee,b2 as G,au as Le,b3 as Be,aw as Ne,b4 as Ke,n as Oe,e as Ue,aq as ze,a2 as qe,b5 as $e,o as je,b6 as J,b7 as He,b8 as Q}from"./app-CgM7B95C.js";import{a as We,f as Ge}from"./VInput-DHyvqDWO.js";import{V as Je}from"./VCheckboxBtn-Cjuctwn2.js";const Qe=Ie({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...xe({filterKeys:["title"]}),...we(),...je(Se({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...$e({transition:!1})},"VAutocomplete"),tl=Fe()({name:"VAutocomplete",props:Qe(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,X){let{slots:s}=X;const{t:T}=Ae(),m=P(),p=S(!1),V=S(!0),M=S(!1),z=P(),_=P(),o=S(-1),{items:q,transformIn:Y,transformOut:Z}=De(l),{textColorClasses:ee,textColorStyles:le}=Pe(()=>m.value?.color),c=O(l,"search",""),u=O(l,"modelValue",[],e=>Y(e===null?[null]:Re(e)),e=>{const n=Z(e);return l.multiple?n:n[0]??null}),te=g(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:u.value.length),F=We(l),{filteredItems:E,getMatches:ae}=ge(l,q,()=>V.value?"":c.value),h=g(()=>l.hideSelected?E.value.filter(e=>!u.value.some(n=>n.value===e.value)):E.value),I=g(()=>!!(l.chips||s.chip)),k=g(()=>I.value||!!s.selection),ue=g(()=>u.value.map(e=>e.props.value)),L=g(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&c.value===h.value[0]?.title)&&h.value.length>0&&!V.value&&!M.value),A=g(()=>l.hideNoData&&!h.value.length||F.isReadonly.value||F.isDisabled.value),B=O(l,"menu"),i=g({get:()=>B.value,set:e=>{B.value&&!e&&z.value?.Î¨openChildren.size||e&&A.value||(B.value=e)}}),$=g(()=>i.value?l.closeText:l.openText),N=P(),ne=Ve(N,m);function oe(e){l.openOnClear&&(i.value=!0),c.value=""}function se(){A.value||(i.value=!0)}function ie(e){A.value||(p.value&&(e.preventDefault(),e.stopPropagation()),i.value=!i.value)}function re(e){(J(e)||e.key==="Backspace")&&m.value?.focus()}function ce(e){if(F.isReadonly.value)return;const n=m.value?.selectionStart,r=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(i.value=!0),["Escape"].includes(e.key)&&(i.value=!1),L.value&&["Enter","Tab"].includes(e.key)&&!u.value.some(a=>{let{value:t}=a;return t===h.value[0].value})&&b(h.value[0]),e.key==="ArrowDown"&&L.value&&N.value?.focus("next"),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&k.value&&u.value.length>0&&!c.value)return b(u.value[0],!1);if(~o.value){e.preventDefault();const a=o.value;b(u.value[o.value],!1),o.value=a>=r-1?r-2:a}else e.key==="Backspace"&&!c.value&&(o.value=r-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(o.value<0&&n&&n>0)return;const a=o.value>-1?o.value-1:r-1;if(u.value[a])o.value=a;else{const t=c.value?.length??null;o.value=-1,m.value?.setSelectionRange(t,t)}}else if(e.key==="ArrowRight"){if(o.value<0)return;const a=o.value+1;u.value[a]?o.value=a:(o.value=-1,m.value?.setSelectionRange(0,0))}else~o.value&&J(e)&&(o.value=-1)}function ve(e){if(Q(m.value,":autofill")||Q(m.value,":-webkit-autofill")){const n=q.value.find(r=>r.title===e.target.value);n&&b(n)}}function de(){l.eager&&_.value?.calculateVisibleItems()}function fe(){p.value&&(V.value=!0,m.value?.focus())}function me(e){p.value=!0,setTimeout(()=>{M.value=!0})}function pe(e){M.value=!1}function he(e){(e==null||e===""&&!l.multiple&&!k.value)&&(u.value=[])}const K=S(!1);function b(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const r=u.value.findIndex(t=>(l.valueComparator||He)(t.value,e.value)),a=n??!~r;if(~r){const t=a?[...u.value,e]:[...u.value];t.splice(r,1),u.value=t}else a&&(u.value=[...u.value,e]);l.clearOnSelect&&(c.value="")}else{const r=n!==!1;u.value=r?[e]:[],c.value=r&&!k.value?e.title:"",H(()=>{i.value=!1,V.value=!0})}}return R(p,(e,n)=>{e!==n&&(e?(K.value=!0,c.value=l.multiple||k.value?"":String(u.value.at(-1)?.props.title??""),V.value=!0,H(()=>K.value=!1)):(!l.multiple&&c.value==null&&(u.value=[]),i.value=!1,(l.multiple||k.value)&&(c.value=""),o.value=-1))}),R(c,e=>{!p.value||K.value||(e&&(i.value=!0),V.value=!e)}),R(i,()=>{if(!l.hideSelected&&i.value&&u.value.length){const e=h.value.findIndex(n=>u.value.some(r=>n.value===r.value));Te&&window.requestAnimationFrame(()=>{e>=0&&_.value?.scrollToIndex(e)})}}),R(()=>l.items,(e,n)=>{i.value||p.value&&!n.length&&e.length&&(i.value=!0)}),Me(()=>{const e=!!(!l.hideNoData||h.value.length||s["prepend-item"]||s["append-item"]||s["no-data"]),n=u.value.length>0,r=j.filterProps(l);return d(j,y({ref:m},r,{modelValue:c.value,"onUpdate:modelValue":[a=>c.value=a,he],focused:p.value,"onUpdate:focused":a=>p.value=a,validationValue:u.externalValue,counterValue:te.value,dirty:n,onChange:ve,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":i.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!k.value,"v-autocomplete--selecting-index":o.value>-1},l.class],style:l.style,readonly:F.isReadonly.value,placeholder:n?void 0:l.placeholder,"onClick:clear":oe,"onMousedown:control":se,onKeydown:ce}),{...s,default:()=>C(U,null,[d(ye,y({ref:z,modelValue:i.value,"onUpdate:modelValue":a=>i.value=a,activator:"parent",contentClass:"v-autocomplete__content",disabled:A.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterEnter:de,onAfterLeave:fe},l.menuProps),{default:()=>[e&&d(Ee,y({ref:N,filterable:!0,selected:ue.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:a=>a.preventDefault(),onKeydown:re,onFocusin:me,onFocusout:pe,tabindex:"-1","aria-live":"polite",color:l.itemColor??l.color},ne,l.listProps),{default:()=>[s["prepend-item"]?.(),!h.value.length&&!l.hideNoData&&(s["no-data"]?.()??d(G,{key:"no-data",title:T(l.noDataText)},null)),d(be,{ref:_,renderless:!0,items:h.value,itemKey:"value"},{default:a=>{let{item:t,index:v,itemRef:D}=a;const w=y(t.props,{ref:D,key:t.value,active:L.value&&v===0?!0:void 0,onClick:()=>b(t,null)});return t.type==="divider"?s.divider?.({props:t.raw,index:v})??d(Le,y(t.props,{key:`divider-${v}`}),null):t.type==="subheader"?s.subheader?.({props:t.raw,index:v})??d(Be,y(t.props,{key:`subheader-${v}`}),null):s.item?.({item:t,index:v,props:w})??d(G,y(w,{role:"option"}),{prepend:x=>{let{isSelected:f}=x;return C(U,null,[l.multiple&&!l.hideSelected?d(Je,{key:t.value,modelValue:f,ripple:!1,tabindex:"-1"},null):void 0,t.props.prependAvatar&&d(Ne,{image:t.props.prependAvatar},null),t.props.prependIcon&&d(W,{icon:t.props.prependIcon},null)])},title:()=>V.value?t.title:ke("v-autocomplete",t.title,ae(t)?.title)})}}),s["append-item"]?.()]})]}),u.value.map((a,t)=>{function v(f){f.stopPropagation(),f.preventDefault(),b(a,!1)}const D={"onClick:close":v,onKeydown(f){f.key!=="Enter"&&f.key!==" "||(f.preventDefault(),f.stopPropagation(),v(f))},onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},w=I.value?!!s.chip:!!s.selection,x=w?Ke(I.value?s.chip({item:a,index:t,props:D}):s.selection({item:a,index:t})):void 0;if(!(w&&!x))return C("div",{key:a.value,class:Ue(["v-autocomplete__selection",t===o.value&&["v-autocomplete__selection--selected",ee.value]]),style:Oe(t===o.value?le.value:{})},[I.value?s.chip?d(ze,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:a.title}}},{default:()=>[x]}):d(Ce,y({key:"chip",closable:l.closableChips,size:"small",text:a.title,disabled:a.props.disabled},D),null):x??C("span",{class:"v-autocomplete__selection-text"},[a.title,l.multiple&&t<u.value.length-1&&C("span",{class:"v-autocomplete__selection-comma"},[qe(",")])])])})]),"append-inner":function(){for(var a=arguments.length,t=new Array(a),v=0;v<a;v++)t[v]=arguments[v];return C(U,null,[s["append-inner"]?.(...t),l.menuIcon?d(W,{class:"v-autocomplete__menu-icon",color:m.value?.fieldIconColor,icon:l.menuIcon,onMousedown:ie,onClick:_e,"aria-label":T($.value),title:T($.value),tabindex:"-1"},null):void 0])}})}),Ge({isFocused:p,isPristine:V,menu:i,search:c,filteredItems:E,select:b},m)}});export{tl as V};
//# sourceMappingURL=VAutocomplete-D52yuaBh.js.map
