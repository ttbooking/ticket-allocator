import{T as Ee}from"./TransitionGroup-B4GY9h0a.js";import{r as L,g as Q,p as ee,u as tt,a as Pe,c as u,b as te,V as W,d as r,e as s,n as pe,f as F,F as j,m as K,o as Me,h as nt,s as at,k as Ae,i as ot,j as st,l as lt,q as it,t as ye,w as De,I as $e,v as Oe,x as rt,y as Y,z as We,A as J,P as ut,B as ct,C as Le,D as Ue,E as Ye,G as Ne,H as dt,J as vt,K as ft,M as mt,L as ht,N as gt,O as yt,Q as kt,R as bt,S as wt,T as pt,U as ie,W as _t,X as Tt,Y as Se,Z as ae,_ as S,$ as b,a0 as m,a1 as E,a2 as G,a3 as He,a4 as d,a5 as I,a6 as p,a7 as le,a8 as re,a9 as oe,aa as Xe,ab as xt,ac as ve,ad as Z,ae as z,af as ke,ag as Vt,ah as Ct,ai as ge,aj as $t,ak as St,al as It,am as Bt}from"./app-B9kLCyNm.js";import{u as q,i as Rt,M as Et,a as Pt,b as je,c as Fe,d as Mt,e as At,T as Ge,f as Dt,g as Ot,h as Wt,C as Lt,O as N,j as H,V as Ut,k as Yt,l as Nt,m as Ht,n as Xt}from"./VSwitch-DseiF0F_.js";import{g as jt,u as Ft,m as Gt,V as Ie,a as zt,b as Zt}from"./filter-BJg-IZCL.js";import{V as qt,a as Kt}from"./VCard-hiwKNkbM.js";import{f as Jt}from"./VInput-B13Nw2G-.js";import{a as Qt}from"./VTextField-CRELOfax.js";import{V as en}from"./VContainer-XFF2d5ZF.js";import{V as Be,a as fe}from"./VRow-B02uog4x.js";import{V as Re}from"./VAutocomplete-BvcJAPNP.js";import{V as tn}from"./VTable-BqMRyGth.js";import"./VSelectionControl-CBviLsjk.js";import"./VCheckboxBtn-DtlJvuHn.js";/* empty css              */function nn(e,t){const n=L();return q(e,"dragstart",a=>{if(n.value=a.target,typeof t=="string"){const o=t;t=(i,l)=>{l?.setData("text/plain",i.dataset[o]??"")}}t?.(n.value,a.dataTransfer)}),q(e,"dragend",()=>{n.value=null}),{element:n}}function ze(e,t,n=!0){const a=L(!1);let o=0;return Rt&&(q(e,"dragenter",i=>{i.preventDefault(),o++,a.value=!0}),q(e,"dragover",i=>{i.preventDefault()}),q(e,"dragleave",i=>{i.preventDefault(),o--,o===0&&(a.value=!1)}),q(e,"drop",i=>{if(i.preventDefault(),o=0,a.value=!1,t)if(n){const l=Array.from(i.dataTransfer?.files??[]);t(l.length===0?null:l)}else t(i.dataTransfer)})),{isOverDropZone:a}}const _e=Symbol.for("vuetify:v-tabs"),Ze=ee({fixed:Boolean,sliderColor:String,sliderTransition:String,sliderTransitionDuration:[String,Number],hideSlider:Boolean,inset:Boolean,direction:{type:String,default:"horizontal"},...Me(nt({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),me=Q()({name:"VTab",props:Ze(),setup(e,t){let{slots:n,attrs:a}=t;const{textColorClasses:o,textColorStyles:i}=tt(()=>e.sliderColor),{backgroundColorClasses:l,backgroundColorStyles:w}=Pe(()=>e.sliderColor),h=L(),g=L(),f=u(()=>e.direction==="horizontal"),x=u(()=>h.value?.group?.isSelected.value??!1);function y(B,P){return{opacity:[0,1]}}function M(B,P){return e.direction==="vertical"?{transform:["scaleY(0)","scaleY(1)"]}:{transform:["scaleX(0)","scaleX(1)"]}}function V(B,P){const C=P.getBoundingClientRect(),$=B.getBoundingClientRect(),T=f.value?"x":"y",v=f.value?"X":"Y",c=f.value?"right":"bottom",k=f.value?"width":"height",R=C[T],U=$[T],D=R>U?C[c]-$[c]:C[T]-$[T],ue=Math.sign(D)>0?f.value?"right":"bottom":Math.sign(D)<0?f.value?"left":"top":"center",he=(Math.abs(D)+(Math.sign(D)<0?C[k]:$[k]))/Math.max(C[k],$[k])||0,ne=C[k]/$[k]||0,ce=1.5;return{transform:[`translate${v}(${D}px) scale${v}(${ne})`,`translate${v}(${D/ce}px) scale${v}(${(he-1)/ce+1})`,"none"],transformOrigin:Array(3).fill(ue)}}function A(B){let{value:P}=B;if(P){const C=h.value?.$el.parentElement?.querySelector(".v-tab--selected .v-tab__slider"),$=g.value;if(!C||!$)return;const T=getComputedStyle(C).color,v={fade:y,grow:M,shift:V}[e.sliderTransition??"shift"]??V,c=Number(e.sliderTransitionDuration)||({fade:400,grow:350,shift:225}[e.sliderTransition??"shift"]??225);Qt($,{backgroundColor:[T,"currentcolor"],...v($,C)},{duration:c,easing:at})}}return te(()=>{const B=W.filterProps(e);return r(W,K({symbol:_e,ref:h,class:["v-tab",e.class,x.value&&e.inset?l.value:[]],style:[e.style,x.value&&e.inset?w.value:[]],tabindex:x.value?0:-1,role:"tab","aria-selected":String(x.value),active:!1},B,a,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":A}),{...n,default:()=>s(j,null,[n.default?.()??e.text,!e.hideSlider&&s("div",{ref:g,class:F(["v-tab__slider",o.value]),style:pe(i.value)},null)])})}),Jt({},h)}}),an=e=>{const{touchstartX:t,touchendX:n,touchstartY:a,touchendY:o}=e,i=.5,l=16;e.offsetX=n-t,e.offsetY=o-a,Math.abs(e.offsetY)<i*Math.abs(e.offsetX)&&(e.left&&n<t-l&&e.left(e),e.right&&n>t+l&&e.right(e)),Math.abs(e.offsetX)<i*Math.abs(e.offsetY)&&(e.up&&o<a-l&&e.up(e),e.down&&o>a+l&&e.down(e))};function on(e,t){const n=e.changedTouches[0];t.touchstartX=n.clientX,t.touchstartY=n.clientY,t.start?.({originalEvent:e,...t})}function sn(e,t){const n=e.changedTouches[0];t.touchendX=n.clientX,t.touchendY=n.clientY,t.end?.({originalEvent:e,...t}),an(t)}function ln(e,t){const n=e.changedTouches[0];t.touchmoveX=n.clientX,t.touchmoveY=n.clientY,t.move?.({originalEvent:e,...t})}function rn(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:n=>on(n,t),touchend:n=>sn(n,t),touchmove:n=>ln(n,t)}}function un(e,t){const n=t.value,a=n?.parent?e.parentElement:e,o=n?.options??{passive:!0},i=t.instance?.$.uid;if(!a||i===void 0)return;const l=rn(t.value);a._touchHandlers=a._touchHandlers??Object.create(null),a._touchHandlers[i]=l,Ae(l).forEach(w=>{a.addEventListener(w,l[w],o)})}function cn(e,t){const n=t.value?.parent?e.parentElement:e,a=t.instance?.$.uid;if(!n?._touchHandlers||a===void 0)return;const o=n._touchHandlers[a];Ae(o).forEach(i=>{n.removeEventListener(i,o[i])}),delete n._touchHandlers[a]}const be={mounted:un,unmounted:cn},qe=Symbol.for("vuetify:v-window"),Ke=Symbol.for("vuetify:v-window-group"),Je=ee({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},verticalArrows:[Boolean,String],touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},crossfade:Boolean,transitionDuration:Number,...Ue(),...Le(),...ct()},"VWindow"),we=Q()({name:"VWindow",directives:{vTouch:be},props:Je(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{themeClasses:a}=ot(e),{isRtl:o}=st(),{t:i}=lt(),l=it(e,Ke),w=L(),h=u(()=>o.value?!e.reverse:e.reverse),g=ye(!1),f=u(()=>{if(e.crossfade)return"v-window-crossfade-transition";const T=e.direction==="vertical"?"y":"x",c=(h.value?!g.value:g.value)?"-reverse":"";return`v-window-${T}${c}-transition`}),x=ye(0),y=L(void 0),M=u(()=>l.items.value.findIndex(T=>l.selected.value.includes(T.id)));De(M,(T,v)=>{let c;const k={left:0,top:0};$e&&v>=0&&(c=jt(w.value),k.left=c?.scrollLeft,k.top=c?.scrollTop);const R=l.items.value.length,U=R-1;R<=2?g.value=T<v:T===U&&v===0?g.value=!1:T===0&&v===U?g.value=!0:g.value=T<v,Oe(()=>{if(!$e||!c)return;c.scrollTop!==k.top&&c.scrollTo({...k,behavior:"instant"}),requestAnimationFrame(()=>{if(!c)return;c.scrollTop!==k.top&&c.scrollTo({...k,behavior:"instant"})})})},{flush:"sync"}),rt(qe,{transition:f,isReversed:g,transitionCount:x,transitionHeight:y,rootRef:w});const V=Y(()=>e.continuous||M.value!==0),A=Y(()=>e.continuous||M.value!==l.items.value.length-1);function B(){V.value&&l.prev()}function P(){A.value&&l.next()}const C=u(()=>{const T=[],v={icon:o.value?e.nextIcon:e.prevIcon,class:`v-window__${h.value?"right":"left"}`,onClick:l.prev,"aria-label":i("$vuetify.carousel.prev")};T.push(V.value?n.prev?n.prev({props:v}):r(W,v,null):s("div",null,null));const c={icon:o.value?e.prevIcon:e.nextIcon,class:`v-window__${h.value?"left":"right"}`,onClick:l.next,"aria-label":i("$vuetify.carousel.next")};return T.push(A.value?n.next?n.next({props:c}):r(W,c,null):s("div",null,null)),T}),$=u(()=>e.touch===!1?e.touch:{...{left:()=>{h.value?B():P()},right:()=>{h.value?P():B()},start:v=>{let{originalEvent:c}=v;c.stopPropagation()}},...e.touch===!0?{}:e.touch});return te(()=>We(r(e.tag,{ref:w,class:F(["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover","v-window--vertical-arrows":!!e.verticalArrows,"v-window--crossfade":!!e.crossfade},a.value,e.class]),style:pe([e.style,{"--v-window-transition-duration":ut()?null:J(e.transitionDuration,"ms")}])},{default:()=>[s("div",{class:"v-window__container",style:{height:y.value}},[n.default?.({group:l}),e.showArrows!==!1&&s("div",{class:F(["v-window__controls",{"v-window__controls--left":e.verticalArrows==="left"||e.verticalArrows===!0},{"v-window__controls--right":e.verticalArrows==="right"}])},[C.value])]),n.additional?.({group:l})]}),[[be,$.value]])),{group:l}}}),dn=ee({...Me(Je(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),vn=Q()({name:"VTabsWindow",props:dn(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const a=Ye(_e,null),o=Ne(e,"modelValue"),i=u({get(){return o.value!=null||!a?o.value:a.items.value.find(l=>a.selected.value.includes(l.id))?.value},set(l){o.value=l}});return te(()=>{const l=we.filterProps(e);return r(we,K({_as:"VTabsWindow"},l,{modelValue:i.value,"onUpdate:modelValue":w=>i.value=w,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),n)}),{}}}),Qe=ee({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ue(),...ht(),...Gt()},"VWindowItem"),se=Q()({name:"VWindowItem",directives:{vTouch:be},props:Qe(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const a=Ye(qe),o=dt(e,Ke),{isBooted:i}=vt();if(!a||!o)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const l=ye(!1),w=u(()=>i.value&&(a.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function h(){!l.value||!a||(l.value=!1,a.transitionCount.value>0&&(a.transitionCount.value-=1,a.transitionCount.value===0&&(a.transitionHeight.value=void 0)))}function g(){l.value||!a||(l.value=!0,a.transitionCount.value===0&&(a.transitionHeight.value=J(a.rootRef.value?.clientHeight)),a.transitionCount.value+=1)}function f(){h()}function x(V){l.value&&Oe(()=>{!w.value||!l.value||!a||(a.transitionHeight.value=J(V.clientHeight))})}const y=u(()=>{const V=a.isReversed.value?e.reverseTransition:e.transition;return w.value?{name:typeof V!="string"?a.transition.value:V,onBeforeEnter:g,onAfterEnter:h,onEnterCancelled:f,onBeforeLeave:g,onAfterLeave:h,onLeaveCancelled:f,onEnter:x}:!1}),{hasContent:M}=Ft(e,o.isSelected);return te(()=>r(mt,{transition:y.value,disabled:!i.value},{default:()=>[We(s("div",{class:F(["v-window-item",o.selectedClass.value,e.class]),style:pe(e.style)},[M.value&&n.default?.()]),[[ft,o.isSelected.value]])]})),{groupItem:o}}}),fn=ee({...Qe()},"VTabsWindowItem"),mn=Q()({name:"VTabsWindowItem",props:fn(),setup(e,t){let{slots:n}=t;return te(()=>{const a=se.filterProps(e);return r(se,K({_as:"VTabsWindowItem"},a,{class:["v-tabs-window-item",e.class],style:e.style}),n)}),{}}});function hn(e){return e?e.map(t=>pt(t)?t:{text:t,value:t}):[]}const gn=ee({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,inset:Boolean,insetPadding:[String,Number],insetRadius:[String,Number],sliderColor:String,...wt(Ze(),["spaced","sliderTransition","sliderTransitionDuration"]),...zt({mandatory:"force",selectedClass:"v-tab-item--selected"}),...bt(),...Le()},"VTabs"),yn=Q()({name:"VTabs",props:gn(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:n,slots:a}=t;const o=Ne(e,"modelValue"),i=u(()=>hn(e.items)),{densityClasses:l}=gt(e),{backgroundColorClasses:w,backgroundColorStyles:h}=Pe(()=>e.bgColor),{scopeId:g}=yt();return kt({VTab:{color:Y(e,"color"),direction:Y(e,"direction"),stacked:Y(e,"stacked"),fixed:Y(e,"fixedTabs"),inset:Y(e,"inset"),sliderColor:Y(e,"sliderColor"),sliderTransition:Y(e,"sliderTransition"),sliderTransitionDuration:Y(e,"sliderTransitionDuration"),hideSlider:Y(e,"hideSlider")}}),te(()=>{const f=Ie.filterProps(e),x=!!(a.window||e.items.length>0);return s(j,null,[r(Ie,K(f,{modelValue:o.value,"onUpdate:modelValue":y=>o.value=y,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--inset":e.inset,"v-tabs--stacked":e.stacked},l.value,w.value,e.class],style:[{"--v-tabs-height":J(e.height),"--v-tabs-inset-padding":e.inset?J(e.insetPadding):void 0,"--v-tabs-inset-radius":e.inset?J(e.insetRadius):void 0},h.value,e.style],role:"tablist",symbol:_e},g,n),{default:a.default??(()=>i.value.map(y=>a.tab?.({item:y})??r(me,K(y,{key:y.text,value:y.value,spaced:e.spaced}),{default:a[`tab.${y.value}`]?()=>a[`tab.${y.value}`]?.({item:y}):void 0}))),prev:a.prev,next:a.next}),x&&r(vn,K({modelValue:o.value,"onUpdate:modelValue":y=>o.value=y,key:"tabs-window"},g),{default:()=>[i.value.map(y=>a.item?.({item:y})??r(mn,{value:y.value},{default:()=>a[`item.${y.value}`]?.({item:y})})),a.window?.()]})])}),{}}}),kn={class:"d-inline-block"},bn={class:"overflow-hidden text-white"},wn={class:"title relative inline-block"},pn=["innerHTML"],_n={key:1},Tn=["innerHTML"],xn={key:0},Vn={key:1},Cn={key:2},$n={key:3},Sn={class:"table-fixed"},In={class:"w-1/3"},Bn={class:"text-center"},Rn=["title"],En={class:"text-center"},Pn=["title"],Mn={class:"text-center"},An=["title"],Dn={class:"text-center"},On=["title"],Wn={class:"text-center"},Ln=["title"],Un={class:"text-right"},Yn={class:"text-right"},Nn={class:"text-right"},Hn={class:"text-right"},Xn={class:"text-right"},jn={class:"text-right"},Fn={class:"text-right"},Gn={class:"text-right"},zn={class:"text-right"},Zn={class:"text-right"},qn=ie({__name:"Ticket",props:{ticket:{}},setup(e){_t(_=>({v0c560d15:Ce.value.delay,v2b070e7c:Ce.value.duration}));const t=e,{t:n}=Tt(),a=u(()=>Se().props.factors),o=L(null),i=new Et({linkify:!0}).use(Pt),l=je(),w=Fe(),h=u(()=>Se().props.options),g=u(()=>ae(t.ticket.created_at)),f=u(()=>ae.duration(t.ticket.delay,"s")),x=u(()=>g.value.add(f.value)),y=u(()=>t.ticket.bound_at?ae(t.ticket.bound_at):null),M=u(()=>t.ticket.reservation?ae.duration(t.ticket.reservation,"s"):null),V=u(()=>y.value&&M.value?y.value.add(M.value):null),A=u(()=>t.ticket.accepted_at?ae(t.ticket.accepted_at):null),B=u(()=>`${g.value.format("lll")} (${g.value.fromNow()})`),P=u(()=>`${x.value.format("lll")} (${n("time_left",{time:x.value.fromNow(!0)})})`),C=u(()=>y.value?`${y.value.format("lll")} (${y.value.fromNow()})`:null),$=u(()=>V.value?`${V.value.format("lll")} (${n("time_left",{time:V.value.fromNow(!0)})})`:null),T=u(()=>A.value?`${A.value.format("lll")} (${A.value.fromNow()})`:null),v=u(()=>`${R(t.ticket.weight)} (${n("increment_per_second",{units:t.ticket.weight_increment.toString()})})`),c=u(()=>h.value[`${w.value}_threshold`]),k=u(()=>t.ticket[w.value]),R=_=>_<1e5?_:_.toExponential(1),U=()=>t.ticket.meta?.category_name??t.ticket.category?.name??"",D=()=>t.ticket.meta?.category_short??t.ticket.category?.short??"",ue=()=>l.altInfo?t.ticket.meta?.title??D():D(),Ve=u(()=>t.ticket.meta?.card_title??"Title"),he=u(()=>t.ticket.meta?.card_subtitle??U()),ne=u(()=>t.ticket.meta?.card_content??[]),ce=u(()=>k.value>c.value),Ce=u(()=>({delay:-k.value+"s",duration:c.value+"s"}));return(_,X)=>(b(),S("div",kn,[r(W,{size:"small",class:F(["ticket justify-start px-2",{overflow:ce.value}]),ripple:!1,flat:"",width:"100"},{default:m(()=>[e.ticket.meta?.icon?(b(),E(He,{key:0,icon:e.ticket.meta?.icon??"",color:"white"},null,8,["icon"])):G("",!0),s("span",bn,[s("span",wn,d(ue()),1)]),r(Zt,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:m(()=>[r(qt,{width:"500","prepend-icon":e.ticket.meta?.icon??"",title:Ve.value,subtitle:he.value},{default:m(()=>[r(yn,{modelValue:o.value,"onUpdate:modelValue":X[0]||(X[0]=O=>o.value=O)},{default:m(()=>[r(me,{value:"properties"},{default:m(()=>[I(d(_.$t("properties")),1)]),_:1}),r(me,{value:"metrics"},{default:m(()=>[I(d(_.$t("metrics")),1)]),_:1}),r(me,{value:"details"},{default:m(()=>[I(d(_.$t("details")),1)]),_:1})]),_:1},8,["modelValue"]),r(Kt,null,{default:m(()=>[r(we,{modelValue:o.value,"onUpdate:modelValue":X[1]||(X[1]=O=>o.value=O)},{default:m(()=>[r(se,{value:"properties",class:"prose"},{default:m(()=>[typeof ne.value=="string"?(b(),S("div",{key:0,innerHTML:p(i).render(ne.value)},null,8,pn)):(b(),S("table",_n,[s("tbody",null,[(b(!0),S(j,null,le(ne.value,([O,de])=>(b(),S("tr",{key:O},[s("th",null,d(O),1),s("td",{innerHTML:p(i).renderInline(de)},null,8,Tn)]))),128))])]))]),_:1}),r(se,{value:"metrics",class:"prose"},{default:m(()=>[s("table",null,[s("tbody",null,[s("tr",null,[s("th",null,d(_.$t("issued_on")),1),s("td",null,d(B.value),1)]),x.value.isAfter(_.$dayjs())?(b(),S("tr",xn,[s("th",null,d(_.$t("delayed_until")),1),s("td",null,d(P.value),1)])):G("",!0),y.value?(b(),S("tr",Vn,[s("th",null,d(_.$t("bound_at")),1),s("td",null,d(C.value),1)])):G("",!0),V.value&&V.value.isAfter(_.$dayjs())?(b(),S("tr",Cn,[s("th",null,d(_.$t("reserved_until")),1),s("td",null,d($.value),1)])):G("",!0),A.value?(b(),S("tr",$n,[s("th",null,d(_.$t("accepted_at")),1),s("td",null,d(T.value),1)])):G("",!0),s("tr",null,[s("th",null,d(_.$t("current_weight")),1),s("td",null,d(v.value),1)]),s("tr",null,[s("th",null,d(_.$t("complexity")),1),s("td",null,d(e.ticket.complexity+" "+p(n)("units")),1)])])])]),_:1}),r(se,{value:"details",class:"prose"},{default:m(()=>[s("table",Sn,[s("thead",null,[s("tr",null,[s("th",In,d(_.$t("factor")),1),s("th",Bn,[s("em",{class:"metric",title:_.$t("initial_weight")},[...X[2]||(X[2]=[I("W",-1),s("sub",null,"0",-1)])],8,Rn)]),s("th",En,[s("em",{class:"metric",title:_.$t("weight_increment")},[...X[3]||(X[3]=[I("W",-1),s("sub",null,"i",-1)])],8,Pn)]),s("th",Mn,[s("em",{class:"metric",title:_.$t("complexity")},"C",8,An)]),s("th",Dn,[s("em",{class:"metric",title:_.$t("delay_sec")},"D",8,On)]),s("th",Wn,[s("em",{class:"metric",title:_.$t("reservation_sec")},"R",8,Ln)])])]),s("tbody",null,[(b(!0),S(j,null,le(e.ticket.metrics??{},(O,de)=>(b(),S("tr",{key:de},[s("th",null,d(a.value[de]?.name??_.$t("unknown")),1),s("td",Un,d(O.initial_weight??0),1),s("td",Yn,d(O.weight_increment??0),1),s("td",Nn,d(O.complexity??0),1),s("td",Hn,d(O.delay??0),1),s("td",Xn,d(O.reservation??0),1)]))),128))]),s("tfoot",null,[s("tr",null,[s("th",null,d(_.$t("total")),1),s("td",jn,d(e.ticket.initial_weight),1),s("td",Fn,d(e.ticket.weight_increment),1),s("td",Gn,d(e.ticket.complexity),1),s("td",zn,d(e.ticket.delay),1),s("td",Zn,d(e.ticket.reservation),1)])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["prepend-icon","title","subtitle"])]),_:1})]),_:1},8,["class"])]))}}),Kn=re(qn,[["__scopeId","data-v-8c1a37e4"]]),Jn=ie({__name:"TicketPool",props:{tickets:{}},setup(e){const t=L(null);nn(t,"uuid");const{lock:n,unlock:a,element:o,triggerElement:i}=At(t),{x:l}=Mt({type:"movement"});u(()=>oe(Ge)),De([o,l],([h,g])=>{!h||!i.value||i.value.dataset.uuid});const w=L(!1);return Xe(()=>{setTimeout(()=>w.value=!0,500)}),(h,g)=>(b(),E(p(Ee),{ref_key:"ticketPool",ref:t,name:"ticket-pool",class:"tickets @container !pt-[1px] !pb-[3px] leading-8",css:w.value,onMouseup:p(a)},{default:m(()=>[(b(!0),S(j,null,le(e.tickets,f=>(b(),E(Kn,{key:f.uuid,"data-uuid":f.uuid,ticket:f,draggable:"true",class:"mr-1",onMousedown:xt(p(n),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css","onMouseup"]))}}),Qn=re(Jn,[["__scopeId","data-v-1fd3da22"]]);function Te(){async function e(o,i){return await window.axios.patch(ve("ticket-allocator.operators.ready",o),{ready:i})}async function t(o,i){return await window.axios.patch(ve("ticket-allocator.tickets.weight",o),{weight_points:i})}async function n(o,i){return await window.axios.patch(ve("ticket-allocator.tickets.handler",o),{operator_uuid:i??null})}async function a(o){return await window.axios.delete(ve("ticket-allocator.tickets.close",o))}return{ready:e,weight:t,handler:n,close:a}}const ea=ie({__name:"TicketRow",props:{tickets:{},pool:{type:Boolean}},setup(e){const t=e;let n=L(!1);const a=u(()=>t.pool?"th":"td"),o=u(()=>t.tickets.reduce((g,{complexity:f})=>g+f,0)),i=u(()=>n.value?"mdi-chevron-down":"mdi-chevron-up"),l=Te(),w=L(null),{isOverDropZone:h}=ze(w,async g=>{const f=g?.getData("text/plain");if(!f)throw new Error("Ticket UUID undefined.");const x=w.value?.dataset.uuid;return await l.handler(f,x)},!1);return(g,f)=>(b(),S("tr",{ref_key:"ticketRow",ref:w,class:F(["ticket-row",{dragover:p(h)}])},[(b(),E(Z(a.value),{class:"status py-1"},{default:m(()=>[z(g.$slots,"status",{},void 0,!0)]),_:3})),(b(),E(Z(a.value),{class:"name font-weight-bold !pt-[6px]"},{default:m(()=>[z(g.$slots,"name",{},void 0,!0)]),_:3})),(b(),E(Z(a.value),{class:"load !pt-[6px] text-center"},{default:m(()=>[z(g.$slots,"load",{},()=>[I(d(e.tickets.length),1)],!0),f[2]||(f[2]=I("/",-1)),z(g.$slots,"load-max",{},()=>[f[1]||(f[1]=I("∞",-1))],!0)]),_:3})),(b(),E(Z(a.value),{class:"complexity !pt-[6px] text-center"},{default:m(()=>[z(g.$slots,"complexity",{},()=>[I(d(o.value),1)],!0),f[4]||(f[4]=I("/",-1)),z(g.$slots,"complexity-max",{},()=>[f[3]||(f[3]=I("∞",-1))],!0)]),_:3})),r(Qn,{tag:a.value,tickets:e.tickets,class:F({collapsed:p(n)})},null,8,["tag","tickets","class"]),(b(),E(Z(a.value),{class:"more !pt-[2px] text-center"},{default:m(()=>[r(W,{size:"x-small",variant:"tonal",icon:i.value,onClick:f[0]||(f[0]=x=>ke(n)?n.value=!p(n):n=!p(n))},null,8,["icon"])]),_:1}))],2))}}),et=re(ea,[["__scopeId","data-v-113cb187"]]),ta=ie({__name:"OperatorRow",props:{operator:{}},setup(e){const t=e,n=u(()=>({online:t.operator.online,ready:t.operator.ready,busy:!!t.operator.tickets?.length,full:t.operator.ticket_limit!==null&&t.operator.tickets?.length>=t.operator.ticket_limit})),a=Te(),o=async()=>await a.ready(t.operator.uuid,!t.operator.ready);return(i,l)=>(b(),E(et,{tickets:e.operator.tickets,"data-uuid":e.operator.uuid,class:F(["operator",n.value])},{status:m(()=>[r(He,{icon:"mdi-account",onClick:o})]),"load-max":m(()=>[I(d(e.operator.ticket_limit??"∞"),1)]),"complexity-max":m(()=>[I(d(e.operator.complexity_limit??"∞"),1)]),name:m(()=>[I(d(e.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}}),na=re(ta,[["__scopeId","data-v-a776c74a"]]);function aa(e,t){return e.reduce((n,a)=>(typeof a[t]=="number"&&(n+=a[t]),n),0)}function xe(e,t){return e.map(n=>Ct(n,t)).filter(n=>n)}function oa(e,t){const n=xe(e,t).filter(a=>typeof a=="number");return n.length===0?0:Math.max(...n)}function sa(e,t){const n=xe(e,t).filter(a=>typeof a=="number");return n.length===0?0:Math.min(...n)}function la(e){return e.map(t=>t[t.$getLocalKey()])}function ia(e,t){const n={},a=Array.isArray(t)?t:[t];return e.forEach(o=>{const i=a.length===1?o[a[0]]:`[${a.map(l=>o[l]).toString()}]`;n[i]=(n[i]||[]).concat(o)}),n}function ra(e,t,n){const a=[],o=[];return typeof t=="function"&&o.push(t)&&a.push("asc"),Array.isArray(t)&&t.forEach(i=>o.push(i[0])&&a.push(i[1])),o.length===0&&o.push(t),Vt(e,o,a,n)}function ua(e){return{sum:t=>aa(e,t),min:t=>sa(e,t),max:t=>oa(e,t),pluck:t=>xe(e,t),groupBy:t=>ia(e,t),sortBy:(t,n="SORT_REGULAR")=>ra(e,t,n),keys:()=>la(e)}}const ca={class:"text-xl leading-tight font-semibold text-gray-800"},da={class:"align-top"},va=ie({__name:"Dashboard",props:{layout:{default:"default"},operators:{},operatorTeams:{},tickets:{},ticketCategories:{},factors:{},matchers:{}},setup(e){const t=e,n=je(),a=Fe(),o=Dt(),i=Ot(),l=u(()=>oe(Yt)),w=u(()=>oe(Nt)),h=u(()=>oe(Ge)),g=u(()=>oe(Ht)),f=Wt(Xt),x=v=>Object.entries(o.value).reduce((c,[k,R])=>{const U=v?.[k],D=U===void 0||!R.length||R.map(String).includes(U.toString());return c&&D},!0),y=u(()=>ua(l.value.with("teams").with("tickets",v=>{v.with("category").where("meta",x).orderBy(a.value,"desc")}).whereHas("tickets").orWhere(v=>!n.hideEmpty&&v.online).get().filter(v=>!i.value.length||v.teams.some(c=>i.value.includes(c.uuid)))).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),M=u(()=>h.value.unbound().with("category").where("meta",x).orderBy(a.value,"desc").get()),V=Te(),A=L(null),{isOverDropZone:B}=ze(A,async v=>{const c=v?.getData("text/plain");if(!c)throw new Error("Ticket UUID undefined.");return await V.close(c)},!1);Xe(()=>{f.listen(Lt.PropsInvalidated,()=>ge.reload()).listen(N.Enrolled,l.value.enroll).listen(N.Resigned,l.value.resign).listen(N.NameChanged,l.value.changeName).listen(N.Online,l.value.setOnline).listen(N.Offline,l.value.setOffline).listen(N.Ready,l.value.setReady).listen(N.NotReady,l.value.setNotReady).listen(N.TicketLimitAdjusted,l.value.adjustTicketLimit).listen(N.ComplexityLimitAdjusted,l.value.adjustComplexityLimit).listen(H.Created,h.value.create).listen(H.Closed,h.value.close).listen(H.Bound,h.value.bind).listen(H.Accepted,h.value.accept).listen(H.Unbound,h.value.unbind).listen(H.CategoryChanged,h.value.changeCategory).listen(H.MetaValueSet,h.value.setMetaValue).listen(H.MetaValuesMerged,h.value.mergeMetaValues).listen(H.MetricsAdjusted,h.value.adjustMetrics)});function P(){l.value.save(t.operators),w.value.fresh(t.operatorTeams),h.value.fresh(t.tickets),g.value.fresh(t.ticketCategories)}const C=ge.on("navigate",P),$=ge.on("success",P);$t(()=>{C(),$()});const T=v=>Object.entries(v).map(([c,k])=>({title:c,value:k}));return(v,c)=>(b(),S(j,null,[r(p(St),{title:v.$t("dashboard")},null,8,["title"]),(b(),E(Z(`${e.layout}-layout`),null,{header:m(()=>[s("h2",ca,d(v.$t("dashboard")),1)]),default:m(()=>[s("div",null,[r(en,{fluid:""},{default:m(()=>[r(Be,null,{default:m(()=>[r(fe,null,{default:m(()=>[r(It,{modelValue:p(n).all,"onUpdate:modelValue":c[0]||(c[0]=k=>p(n).all=k),variant:"plain",multiple:""},{default:m(()=>[r(W,{value:"show-filters",icon:p(n).showFilters?"mdi-filter-outline":"mdi-filter-off-outline"},null,8,["icon"]),r(W,{value:"hide-empty",icon:p(n).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),r(W,{value:"alt-info",icon:p(n).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),r(W,{value:"unlocked",icon:p(n).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:p(n).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),p(n).unlocked?(b(),E(Bt,{key:0,variant:"plain"},{default:m(()=>[r(W,{ref_key:"closeTicket",ref:A,icon:p(B)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),r(W,{icon:"mdi-refresh"})]),_:1})):G("",!0)]),_:1}),r(fe,{cols:"2"},{default:m(()=>[r(Ut,{modelValue:p(a),"onUpdate:modelValue":c[1]||(c[1]=k=>ke(a)?a.value=k:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1}),p(n).showFilters?(b(),E(Be,{key:0},{default:m(()=>[r(fe,{cols:"2"},{default:m(()=>[r(Re,{modelValue:p(i),"onUpdate:modelValue":c[2]||(c[2]=k=>ke(i)?i.value=k:null),multiple:"",clearable:"",chips:"","closable-chips":"",label:v.$t("teams"),items:e.operatorTeams,"item-title":"name","item-value":"uuid"},null,8,["modelValue","label","items"])]),_:1}),(b(!0),S(j,null,le(e.matchers,(k,R)=>(b(),E(fe,{key:R,cols:"2"},{default:m(()=>[r(Re,{modelValue:p(o)[R],"onUpdate:modelValue":U=>p(o)[R]=U,multiple:"",clearable:"",chips:"","closable-chips":"",label:v.$t(R),items:T(k)},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024))),128))]),_:1})):G("",!0)]),_:1}),r(tn,{"fixed-header":"",height:"600px",density:"compact",class:"ticket-monitor"},{default:m(()=>[s("thead",da,[r(et,{pool:"",tickets:M.value},{name:m(()=>[I(d(v.$t("ticket_pool")),1)]),_:1},8,["tickets"])]),r(p(Ee),{tag:"tbody",class:"align-top",name:"operator-pool"},{default:m(()=>[(b(!0),S(j,null,le(y.value,k=>(b(),E(na,{key:k.uuid,operator:k},null,8,["operator"]))),128))]),_:1})]),_:1})])]),_:1}))],64))}}),$a=re(va,[["__scopeId","data-v-811338dd"]]);export{$a as default};
//# sourceMappingURL=Dashboard-C8gcoeSg.js.map
