import{T as Ee}from"./TransitionGroup-BH3Zc0TO.js";import{r as L,g as ee,u as et,a as Pe,b as te,V as A,c as r,d as l,n as we,e as F,F as j,m as J,s as tt,f as c,p as ae,o as Me,h as at,k as Ae,i as nt,j as ot,l as lt,q as st,w as De,I as $e,t as Oe,v as it,x as We,P as rt,y as Q,z as ye,A as ut,B as Le,C as Ue,D as Y,E as Ye,G as He,H as ct,J as dt,K as vt,M as ft,L as mt,N as ht,O as gt,Q as yt,R as kt,S as bt,T as pt,U as re,W as wt,X as _t,Y as b,Z as R,_ as f,$ as M,a0 as Ne,a1 as G,a2 as d,a3 as P,a4 as k,a5 as ie,a6 as Se,a7 as oe,a8 as ue,a9 as Xe,aa as Tt,ab as ve,ac as q,ad as Z,ae as ke,af as xt,ag as Vt,ah as ge,ai as Ct,aj as $t,ak as St,al as It,am as fe}from"./app-POup2_xr.js";import{u as K,i as Bt,M as Rt,a as Et,b as je,c as Fe,d as Pt,e as Mt,f as At,g as Dt,h as Ot,C as Wt,O as H,T as N,V as Lt,j as Ut,k as Yt,l as Ht,m as Nt,n as Xt}from"./VSwitch-DPWrlqUu.js";import{g as jt,u as Ft,m as Gt,V as Ie,a as zt,b as Zt}from"./filter-CF8bM9V-.js";import{V as qt,a as Kt}from"./VCard-D0D0fOH3.js";import{f as Jt}from"./VInput-B7tJStf1.js";import{a as Qt,V as ea}from"./VTextField-BXpTKsPS.js";import{V as ta}from"./VContainer-BwDd_Ctb.js";import{V as Be,a as le}from"./VRow-k4PKPedO.js";import{V as Re}from"./VAutocomplete-Be14IxOk.js";import{V as aa}from"./VTable-6h_e2YsX.js";import"./VSelectionControl-TCGzUcV4.js";import"./VCheckboxBtn-BjWmJ3it.js";/* empty css              */function na(e,t){const a=L();return K(e,"dragstart",n=>{if(a.value=n.target,typeof t=="string"){const o=t;t=(i,s)=>{s?.setData("text/plain",i.dataset[o]??"")}}t?.(a.value,n.dataTransfer)}),K(e,"dragend",()=>{a.value=null}),{element:a}}function Ge(e,t,a=!0){const n=L(!1);let o=0;return Bt&&(K(e,"dragenter",i=>{i.preventDefault(),o++,n.value=!0}),K(e,"dragover",i=>{i.preventDefault()}),K(e,"dragleave",i=>{i.preventDefault(),o--,o===0&&(n.value=!1)}),K(e,"drop",i=>{if(i.preventDefault(),o=0,n.value=!1,t)if(a){const s=Array.from(i.dataTransfer?.files??[]);t(s.length===0?null:s)}else t(i.dataTransfer)})),{isOverDropZone:n}}const _e=Symbol.for("vuetify:v-tabs"),ze=ae({fixed:Boolean,sliderColor:String,sliderTransition:String,sliderTransitionDuration:[String,Number],hideSlider:Boolean,inset:Boolean,direction:{type:String,default:"horizontal"},...Me(at({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),me=ee()({name:"VTab",props:ze(),setup(e,t){let{slots:a,attrs:n}=t;const{textColorClasses:o,textColorStyles:i}=et(()=>e.sliderColor),{backgroundColorClasses:s,backgroundColorStyles:p}=Pe(()=>e.sliderColor),m=L(),h=L(),v=c(()=>e.direction==="horizontal"),V=c(()=>m.value?.group?.isSelected.value??!1);function y(E,O){return{opacity:[0,1]}}function D(E,O){return e.direction==="vertical"?{transform:["scaleY(0)","scaleY(1)"]}:{transform:["scaleX(0)","scaleX(1)"]}}function C(E,O){const $=O.getBoundingClientRect(),S=E.getBoundingClientRect(),_=v.value?"x":"y",x=v.value?"X":"Y",u=v.value?"right":"bottom",g=v.value?"width":"height",T=$[_],I=S[_],B=T>I?$[u]-S[u]:$[_]-S[_],z=Math.sign(B)>0?v.value?"right":"bottom":Math.sign(B)<0?v.value?"left":"top":"center",he=(Math.abs(B)+(Math.sign(B)<0?$[g]:S[g]))/Math.max($[g],S[g])||0,ne=$[g]/S[g]||0,ce=1.5;return{transform:[`translate${x}(${B}px) scale${x}(${ne})`,`translate${x}(${B/ce}px) scale${x}(${(he-1)/ce+1})`,"none"],transformOrigin:Array(3).fill(z)}}function U(E){let{value:O}=E;if(O){const $=m.value?.$el.parentElement?.querySelector(".v-tab--selected .v-tab__slider"),S=h.value;if(!$||!S)return;const _=getComputedStyle($).color,x={fade:y,grow:D,shift:C}[e.sliderTransition??"shift"]??C,u=Number(e.sliderTransitionDuration)||({fade:400,grow:350,shift:225}[e.sliderTransition??"shift"]??225);Qt(S,{backgroundColor:[_,"currentcolor"],...x(S,$)},{duration:u,easing:tt})}}return te(()=>{const E=A.filterProps(e);return r(A,J({symbol:_e,ref:m,class:["v-tab",e.class,V.value&&e.inset?s.value:[]],style:[e.style,V.value&&e.inset?p.value:[]],tabindex:V.value?0:-1,role:"tab","aria-selected":String(V.value),active:!1},E,n,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":U}),{...a,default:()=>l(j,null,[a.default?.()??e.text,!e.hideSlider&&l("div",{ref:h,class:F(["v-tab__slider",o.value]),style:we(i.value)},null)])})}),Jt({},m)}}),oa=e=>{const{touchstartX:t,touchendX:a,touchstartY:n,touchendY:o}=e,i=.5,s=16;e.offsetX=a-t,e.offsetY=o-n,Math.abs(e.offsetY)<i*Math.abs(e.offsetX)&&(e.left&&a<t-s&&e.left(e),e.right&&a>t+s&&e.right(e)),Math.abs(e.offsetX)<i*Math.abs(e.offsetY)&&(e.up&&o<n-s&&e.up(e),e.down&&o>n+s&&e.down(e))};function la(e,t){const a=e.changedTouches[0];t.touchstartX=a.clientX,t.touchstartY=a.clientY,t.start?.({originalEvent:e,...t})}function sa(e,t){const a=e.changedTouches[0];t.touchendX=a.clientX,t.touchendY=a.clientY,t.end?.({originalEvent:e,...t}),oa(t)}function ia(e,t){const a=e.changedTouches[0];t.touchmoveX=a.clientX,t.touchmoveY=a.clientY,t.move?.({originalEvent:e,...t})}function ra(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:a=>la(a,t),touchend:a=>sa(a,t),touchmove:a=>ia(a,t)}}function ua(e,t){const a=t.value,n=a?.parent?e.parentElement:e,o=a?.options??{passive:!0},i=t.instance?.$.uid;if(!n||i===void 0)return;const s=ra(t.value);n._touchHandlers=n._touchHandlers??Object.create(null),n._touchHandlers[i]=s,Ae(s).forEach(p=>{n.addEventListener(p,s[p],o)})}function ca(e,t){const a=t.value?.parent?e.parentElement:e,n=t.instance?.$.uid;if(!a?._touchHandlers||n===void 0)return;const o=a._touchHandlers[n];Ae(o).forEach(i=>{a.removeEventListener(i,o[i])}),delete a._touchHandlers[n]}const be={mounted:ua,unmounted:ca},Ze=Symbol.for("vuetify:v-window"),qe=Symbol.for("vuetify:v-window-group"),Ke=ae({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},verticalArrows:[Boolean,String],touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},crossfade:Boolean,transitionDuration:Number,...Ue(),...Le(),...ut()},"VWindow"),pe=ee()({name:"VWindow",directives:{vTouch:be},props:Ke(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const{themeClasses:n}=nt(e),{isRtl:o}=ot(),{t:i}=lt(),s=st(e,qe),p=L(),m=c(()=>o.value?!e.reverse:e.reverse),h=ye(!1),v=c(()=>{if(e.crossfade)return"v-window-crossfade-transition";const _=e.direction==="vertical"?"y":"x",u=(m.value?!h.value:h.value)?"-reverse":"";return`v-window-${_}${u}-transition`}),V=ye(0),y=L(void 0),D=c(()=>s.items.value.findIndex(_=>s.selected.value.includes(_.id)));De(D,(_,x)=>{let u;const g={left:0,top:0};$e&&x>=0&&(u=jt(p.value),g.left=u?.scrollLeft,g.top=u?.scrollTop);const T=s.items.value.length,I=T-1;T<=2?h.value=_<x:_===I&&x===0?h.value=!1:_===0&&x===I?h.value=!0:h.value=_<x,Oe(()=>{if(!$e||!u)return;u.scrollTop!==g.top&&u.scrollTo({...g,behavior:"instant"}),requestAnimationFrame(()=>{if(!u)return;u.scrollTop!==g.top&&u.scrollTo({...g,behavior:"instant"})})})},{flush:"sync"}),it(Ze,{transition:v,isReversed:h,transitionCount:V,transitionHeight:y,rootRef:p});const C=Y(()=>e.continuous||D.value!==0),U=Y(()=>e.continuous||D.value!==s.items.value.length-1);function E(){C.value&&s.prev()}function O(){U.value&&s.next()}const $=c(()=>{const _=[],x={icon:o.value?e.nextIcon:e.prevIcon,class:`v-window__${m.value?"right":"left"}`,onClick:s.prev,"aria-label":i("$vuetify.carousel.prev")};_.push(C.value?a.prev?a.prev({props:x}):r(A,x,null):l("div",null,null));const u={icon:o.value?e.prevIcon:e.nextIcon,class:`v-window__${m.value?"left":"right"}`,onClick:s.next,"aria-label":i("$vuetify.carousel.next")};return _.push(U.value?a.next?a.next({props:u}):r(A,u,null):l("div",null,null)),_}),S=c(()=>e.touch===!1?e.touch:{...{left:()=>{m.value?E():O()},right:()=>{m.value?O():E()},start:x=>{let{originalEvent:u}=x;u.stopPropagation()}},...e.touch===!0?{}:e.touch});return te(()=>We(r(e.tag,{ref:p,class:F(["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover","v-window--vertical-arrows":!!e.verticalArrows,"v-window--crossfade":!!e.crossfade},n.value,e.class]),style:we([e.style,{"--v-window-transition-duration":rt()?null:Q(e.transitionDuration,"ms")}])},{default:()=>[l("div",{class:"v-window__container",style:{height:y.value}},[a.default?.({group:s}),e.showArrows!==!1&&l("div",{class:F(["v-window__controls",{"v-window__controls--left":e.verticalArrows==="left"||e.verticalArrows===!0},{"v-window__controls--right":e.verticalArrows==="right"}])},[$.value])]),a.additional?.({group:s})]}),[[be,S.value]])),{group:s}}}),da=ae({...Me(Ke(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),va=ee()({name:"VTabsWindow",props:da(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a}=t;const n=Ye(_e,null),o=He(e,"modelValue"),i=c({get(){return o.value!=null||!n?o.value:n.items.value.find(s=>n.selected.value.includes(s.id))?.value},set(s){o.value=s}});return te(()=>{const s=pe.filterProps(e);return r(pe,J({_as:"VTabsWindow"},s,{modelValue:i.value,"onUpdate:modelValue":p=>i.value=p,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),a)}),{}}}),Je=ae({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ue(),...mt(),...Gt()},"VWindowItem"),se=ee()({name:"VWindowItem",directives:{vTouch:be},props:Je(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:a}=t;const n=Ye(Ze),o=ct(e,qe),{isBooted:i}=dt();if(!n||!o)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const s=ye(!1),p=c(()=>i.value&&(n.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function m(){!s.value||!n||(s.value=!1,n.transitionCount.value>0&&(n.transitionCount.value-=1,n.transitionCount.value===0&&(n.transitionHeight.value=void 0)))}function h(){s.value||!n||(s.value=!0,n.transitionCount.value===0&&(n.transitionHeight.value=Q(n.rootRef.value?.clientHeight)),n.transitionCount.value+=1)}function v(){m()}function V(C){s.value&&Oe(()=>{!p.value||!s.value||!n||(n.transitionHeight.value=Q(C.clientHeight))})}const y=c(()=>{const C=n.isReversed.value?e.reverseTransition:e.transition;return p.value?{name:typeof C!="string"?n.transition.value:C,onBeforeEnter:h,onAfterEnter:m,onEnterCancelled:v,onBeforeLeave:h,onAfterLeave:m,onLeaveCancelled:v,onEnter:V}:!1}),{hasContent:D}=Ft(e,o.isSelected);return te(()=>r(ft,{transition:y.value,disabled:!i.value},{default:()=>[We(l("div",{class:F(["v-window-item",o.selectedClass.value,e.class]),style:we(e.style)},[D.value&&a.default?.()]),[[vt,o.isSelected.value]])]})),{groupItem:o}}}),fa=ae({...Je()},"VTabsWindowItem"),ma=ee()({name:"VTabsWindowItem",props:fa(),setup(e,t){let{slots:a}=t;return te(()=>{const n=se.filterProps(e);return r(se,J({_as:"VTabsWindowItem"},n,{class:["v-tabs-window-item",e.class],style:e.style}),a)}),{}}});function ha(e){return e?e.map(t=>pt(t)?t:{text:t,value:t}):[]}const ga=ae({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,inset:Boolean,insetPadding:[String,Number],insetRadius:[String,Number],sliderColor:String,...bt(ze(),["spaced","sliderTransition","sliderTransitionDuration"]),...zt({mandatory:"force",selectedClass:"v-tab-item--selected"}),...kt(),...Le()},"VTabs"),ya=ee()({name:"VTabs",props:ga(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:a,slots:n}=t;const o=He(e,"modelValue"),i=c(()=>ha(e.items)),{densityClasses:s}=ht(e),{backgroundColorClasses:p,backgroundColorStyles:m}=Pe(()=>e.bgColor),{scopeId:h}=gt();return yt({VTab:{color:Y(e,"color"),direction:Y(e,"direction"),stacked:Y(e,"stacked"),fixed:Y(e,"fixedTabs"),inset:Y(e,"inset"),sliderColor:Y(e,"sliderColor"),sliderTransition:Y(e,"sliderTransition"),sliderTransitionDuration:Y(e,"sliderTransitionDuration"),hideSlider:Y(e,"hideSlider")}}),te(()=>{const v=Ie.filterProps(e),V=!!(n.window||e.items.length>0);return l(j,null,[r(Ie,J(v,{modelValue:o.value,"onUpdate:modelValue":y=>o.value=y,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--inset":e.inset,"v-tabs--stacked":e.stacked},s.value,p.value,e.class],style:[{"--v-tabs-height":Q(e.height),"--v-tabs-inset-padding":e.inset?Q(e.insetPadding):void 0,"--v-tabs-inset-radius":e.inset?Q(e.insetRadius):void 0},m.value,e.style],role:"tablist",symbol:_e},h,a),{default:n.default??(()=>i.value.map(y=>n.tab?.({item:y})??r(me,J(y,{key:y.text,value:y.value,spaced:e.spaced}),{default:n[`tab.${y.value}`]?()=>n[`tab.${y.value}`]?.({item:y}):void 0}))),prev:n.prev,next:n.next}),V&&r(va,J({modelValue:o.value,"onUpdate:modelValue":y=>o.value=y,key:"tabs-window"},h),{default:()=>[i.value.map(y=>n.item?.({item:y})??r(ma,{value:y.value},{default:()=>n[`item.${y.value}`]?.({item:y})})),n.window?.()]})])}),{}}}),ka={class:"d-inline-block"},ba={class:"overflow-hidden text-white"},pa={class:"title relative inline-block"},wa=["innerHTML"],_a={key:1},Ta=["innerHTML"],xa={key:0},Va={key:1},Ca={key:2},$a={key:3},Sa={class:"table-fixed"},Ia={class:"w-1/3"},Ba={class:"text-center"},Ra=["title"],Ea={class:"text-center"},Pa=["title"],Ma={class:"text-center"},Aa=["title"],Da={class:"text-center"},Oa=["title"],Wa={class:"text-center"},La=["title"],Ua={class:"text-right"},Ya={class:"text-right"},Ha={class:"text-right"},Na={class:"text-right"},Xa={class:"text-right"},ja={class:"text-right"},Fa={class:"text-right"},Ga={class:"text-right"},za={class:"text-right"},Za={class:"text-right"},qa=re({__name:"Ticket",props:{ticket:{}},setup(e){wt(w=>({v0c560d15:Ce.value.delay,v2b070e7c:Ce.value.duration}));const t=e,{t:a}=_t(),n=c(()=>Se().props.factors),o=L(null),i=new Rt({linkify:!0}).use(Et),s=je(),p=Fe(),m=c(()=>Se().props.options),h=c(()=>oe(t.ticket.created_at)),v=c(()=>oe.duration(t.ticket.delay,"s")),V=c(()=>h.value.add(v.value)),y=c(()=>t.ticket.bound_at?oe(t.ticket.bound_at):null),D=c(()=>t.ticket.reservation?oe.duration(t.ticket.reservation,"s"):null),C=c(()=>y.value&&D.value?y.value.add(D.value):null),U=c(()=>t.ticket.accepted_at?oe(t.ticket.accepted_at):null),E=c(()=>`${h.value.format("lll")} (${h.value.fromNow()})`),O=c(()=>`${V.value.format("lll")} (${a("time_left",{time:V.value.fromNow(!0)})})`),$=c(()=>y.value?`${y.value.format("lll")} (${y.value.fromNow()})`:null),S=c(()=>C.value?`${C.value.format("lll")} (${a("time_left",{time:C.value.fromNow(!0)})})`:null),_=c(()=>U.value?`${U.value.format("lll")} (${U.value.fromNow()})`:null),x=c(()=>`${T(t.ticket.weight)} (${a("increment_per_second",{units:t.ticket.weight_increment.toString()})})`),u=c(()=>m.value[`${p.value}_threshold`]),g=c(()=>t.ticket[p.value]),T=w=>w<1e5?w:w.toExponential(1),I=()=>t.ticket.meta?.category_name??t.ticket.category?.name??"",B=()=>t.ticket.meta?.category_short??t.ticket.category?.short??"",z=()=>s.altInfo?t.ticket.meta?.title??B():B(),Ve=c(()=>t.ticket.meta?.card_title??"Title"),he=c(()=>t.ticket.meta?.card_subtitle??I()),ne=c(()=>t.ticket.meta?.card_content??[]),ce=c(()=>g.value>u.value),Ce=c(()=>({delay:-g.value+"s",duration:u.value+"s"}));return(w,X)=>(b(),R("div",ka,[r(A,{size:"small",class:F(["ticket justify-start px-2",{overflow:ce.value}]),ripple:!1,flat:"",width:"100"},{default:f(()=>[e.ticket.meta?.icon?(b(),M(Ne,{key:0,icon:e.ticket.meta?.icon??"",color:"white"},null,8,["icon"])):G("",!0),l("span",ba,[l("span",pa,d(z()),1)]),r(Zt,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:f(()=>[r(qt,{width:"500","prepend-icon":e.ticket.meta?.icon??"",title:Ve.value,subtitle:he.value},{default:f(()=>[r(ya,{modelValue:o.value,"onUpdate:modelValue":X[0]||(X[0]=W=>o.value=W)},{default:f(()=>[r(me,{value:"properties"},{default:f(()=>[P(d(w.$t("properties")),1)]),_:1}),r(me,{value:"metrics"},{default:f(()=>[P(d(w.$t("metrics")),1)]),_:1}),r(me,{value:"details"},{default:f(()=>[P(d(w.$t("details")),1)]),_:1})]),_:1},8,["modelValue"]),r(Kt,null,{default:f(()=>[r(pe,{modelValue:o.value,"onUpdate:modelValue":X[1]||(X[1]=W=>o.value=W)},{default:f(()=>[r(se,{value:"properties",class:"prose"},{default:f(()=>[typeof ne.value=="string"?(b(),R("div",{key:0,innerHTML:k(i).render(ne.value)},null,8,wa)):(b(),R("table",_a,[l("tbody",null,[(b(!0),R(j,null,ie(ne.value,([W,de])=>(b(),R("tr",{key:W},[l("th",null,d(W),1),l("td",{innerHTML:k(i).renderInline(de)},null,8,Ta)]))),128))])]))]),_:1}),r(se,{value:"metrics",class:"prose"},{default:f(()=>[l("table",null,[l("tbody",null,[l("tr",null,[l("th",null,d(w.$t("issued_on")),1),l("td",null,d(E.value),1)]),V.value.isAfter(w.$dayjs())?(b(),R("tr",xa,[l("th",null,d(w.$t("delayed_until")),1),l("td",null,d(O.value),1)])):G("",!0),y.value?(b(),R("tr",Va,[l("th",null,d(w.$t("bound_at")),1),l("td",null,d($.value),1)])):G("",!0),C.value&&C.value.isAfter(w.$dayjs())?(b(),R("tr",Ca,[l("th",null,d(w.$t("reserved_until")),1),l("td",null,d(S.value),1)])):G("",!0),U.value?(b(),R("tr",$a,[l("th",null,d(w.$t("accepted_at")),1),l("td",null,d(_.value),1)])):G("",!0),l("tr",null,[l("th",null,d(w.$t("current_weight")),1),l("td",null,d(x.value),1)]),l("tr",null,[l("th",null,d(w.$t("complexity")),1),l("td",null,d(e.ticket.complexity+" "+k(a)("units")),1)])])])]),_:1}),r(se,{value:"details",class:"prose"},{default:f(()=>[l("table",Sa,[l("thead",null,[l("tr",null,[l("th",Ia,d(w.$t("factor")),1),l("th",Ba,[l("em",{class:"metric",title:w.$t("initial_weight")},[...X[2]||(X[2]=[P("W",-1),l("sub",null,"0",-1)])],8,Ra)]),l("th",Ea,[l("em",{class:"metric",title:w.$t("weight_increment")},[...X[3]||(X[3]=[P("W",-1),l("sub",null,"i",-1)])],8,Pa)]),l("th",Ma,[l("em",{class:"metric",title:w.$t("complexity")},"C",8,Aa)]),l("th",Da,[l("em",{class:"metric",title:w.$t("delay_sec")},"D",8,Oa)]),l("th",Wa,[l("em",{class:"metric",title:w.$t("reservation_sec")},"R",8,La)])])]),l("tbody",null,[(b(!0),R(j,null,ie(e.ticket.metrics??{},(W,de)=>(b(),R("tr",{key:de},[l("th",null,d(n.value[de]?.name??w.$t("unknown")),1),l("td",Ua,d(W.initial_weight??0),1),l("td",Ya,d(W.weight_increment??0),1),l("td",Ha,d(W.complexity??0),1),l("td",Na,d(W.delay??0),1),l("td",Xa,d(W.reservation??0),1)]))),128))]),l("tfoot",null,[l("tr",null,[l("th",null,d(w.$t("total")),1),l("td",ja,d(e.ticket.initial_weight),1),l("td",Fa,d(e.ticket.weight_increment),1),l("td",Ga,d(e.ticket.complexity),1),l("td",za,d(e.ticket.delay),1),l("td",Za,d(e.ticket.reservation),1)])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["prepend-icon","title","subtitle"])]),_:1})]),_:1},8,["class"])]))}}),Ka=ue(qa,[["__scopeId","data-v-8c1a37e4"]]),Ja=re({__name:"TicketPool",props:{tickets:{}},setup(e){const t=L(null);na(t,"uuid");const{lock:a,unlock:n,element:o,triggerElement:i}=Mt(t),{x:s}=Pt({type:"movement"});De([o,s],([m,h])=>{!m||!i.value||i.value.dataset.uuid});const p=L(!1);return Xe(()=>{setTimeout(()=>p.value=!0,500)}),(m,h)=>(b(),M(k(Ee),{ref_key:"ticketPool",ref:t,name:"ticket-pool",class:"tickets @container !pt-[1px] !pb-[3px] leading-8",css:p.value,onMouseup:k(n)},{default:f(()=>[(b(!0),R(j,null,ie(e.tickets,v=>(b(),M(Ka,{key:v.uuid,"data-uuid":v.uuid,ticket:v,draggable:"true",class:"mr-1",onMousedown:Tt(k(a),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css","onMouseup"]))}}),Qa=ue(Ja,[["__scopeId","data-v-1fd3da22"]]);function Te(){async function e(o,i){return await window.axios.patch(ve("ticket-allocator.operators.ready",o),{ready:i})}async function t(o,i){return await window.axios.patch(ve("ticket-allocator.tickets.weight",o),{weight_points:i})}async function a(o,i){return await window.axios.patch(ve("ticket-allocator.tickets.handler",o),{operator_uuid:i??null})}async function n(o){return await window.axios.delete(ve("ticket-allocator.tickets.close",o))}return{ready:e,weight:t,handler:a,close:n}}const en=re({__name:"TicketRow",props:{tickets:{},pool:{type:Boolean}},setup(e){const t=e;let a=L(!1);const n=c(()=>t.pool?"th":"td"),o=c(()=>t.tickets.reduce((h,{complexity:v})=>h+v,0)),i=c(()=>a.value?"mdi-chevron-down":"mdi-chevron-up"),s=Te(),p=L(null),{isOverDropZone:m}=Ge(p,async h=>{const v=h?.getData("text/plain");if(!v)throw new Error("Ticket UUID undefined.");const V=p.value?.dataset.uuid;return await s.handler(v,V)},!1);return(h,v)=>(b(),R("tr",{ref_key:"ticketRow",ref:p,class:F(["ticket-row",{dragover:k(m)}])},[(b(),M(q(n.value),{class:"status py-1"},{default:f(()=>[Z(h.$slots,"status",{},void 0,!0)]),_:3})),(b(),M(q(n.value),{class:"name font-weight-bold !pt-[6px]"},{default:f(()=>[Z(h.$slots,"name",{},void 0,!0)]),_:3})),(b(),M(q(n.value),{class:"load !pt-[6px] text-center"},{default:f(()=>[Z(h.$slots,"load",{},()=>[P(d(e.tickets.length),1)],!0),v[2]||(v[2]=P("/",-1)),Z(h.$slots,"load-max",{},()=>[v[1]||(v[1]=P("∞",-1))],!0)]),_:3})),(b(),M(q(n.value),{class:"complexity !pt-[6px] text-center"},{default:f(()=>[Z(h.$slots,"complexity",{},()=>[P(d(o.value),1)],!0),v[4]||(v[4]=P("/",-1)),Z(h.$slots,"complexity-max",{},()=>[v[3]||(v[3]=P("∞",-1))],!0)]),_:3})),r(Qa,{tag:n.value,tickets:e.tickets,class:F({collapsed:k(a)})},null,8,["tag","tickets","class"]),(b(),M(q(n.value),{class:"more !pt-[2px] text-center"},{default:f(()=>[r(A,{size:"x-small",variant:"tonal",icon:i.value,onClick:v[0]||(v[0]=V=>ke(a)?a.value=!k(a):a=!k(a))},null,8,["icon"])]),_:1}))],2))}}),Qe=ue(en,[["__scopeId","data-v-113cb187"]]),tn=re({__name:"OperatorRow",props:{operator:{}},setup(e){const t=e,a=c(()=>({online:t.operator.online,ready:t.operator.ready,busy:!!t.operator.tickets?.length,full:t.operator.ticket_limit!==null&&t.operator.tickets?.length>=t.operator.ticket_limit})),n=Te(),o=async()=>await n.ready(t.operator.uuid,!t.operator.ready);return(i,s)=>(b(),M(Qe,{tickets:e.operator.tickets,"data-uuid":e.operator.uuid,class:F(["operator",a.value])},{status:f(()=>[r(Ne,{icon:"mdi-account",onClick:o})]),"load-max":f(()=>[P(d(e.operator.ticket_limit??"∞"),1)]),"complexity-max":f(()=>[P(d(e.operator.complexity_limit??"∞"),1)]),name:f(()=>[P(d(e.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}}),an=ue(tn,[["__scopeId","data-v-a776c74a"]]);function nn(e,t){return e.reduce((a,n)=>(typeof n[t]=="number"&&(a+=n[t]),a),0)}function xe(e,t){return e.map(a=>Vt(a,t)).filter(a=>a)}function on(e,t){const a=xe(e,t).filter(n=>typeof n=="number");return a.length===0?0:Math.max(...a)}function ln(e,t){const a=xe(e,t).filter(n=>typeof n=="number");return a.length===0?0:Math.min(...a)}function sn(e){return e.map(t=>t[t.$getLocalKey()])}function rn(e,t){const a={},n=Array.isArray(t)?t:[t];return e.forEach(o=>{const i=n.length===1?o[n[0]]:`[${n.map(s=>o[s]).toString()}]`;a[i]=(a[i]||[]).concat(o)}),a}function un(e,t,a){const n=[],o=[];return typeof t=="function"&&o.push(t)&&n.push("asc"),Array.isArray(t)&&t.forEach(i=>o.push(i[0])&&n.push(i[1])),o.length===0&&o.push(t),xt(e,o,n,a)}function cn(e){return{sum:t=>nn(e,t),min:t=>ln(e,t),max:t=>on(e,t),pluck:t=>xe(e,t),groupBy:t=>rn(e,t),sortBy:(t,a="SORT_REGULAR")=>un(e,t,a),keys:()=>sn(e)}}const dn={class:"text-xl leading-tight font-semibold text-gray-800"},vn={class:"align-top"},fn=re({__name:"Dashboard",props:{layout:{default:"default"},operators:{},operatorTeams:{},tickets:{},ticketCategories:{},factors:{},matchers:{}},setup(e){const t=e,a=je(),n=Fe(),o=At(),i=Dt(),s=c(()=>fe(Ut)),p=c(()=>fe(Yt)),m=c(()=>fe(Ht)),h=c(()=>fe(Nt)),v=Ot(Xt),V=u=>!Array.isArray(o.value.category)||!o.value.category.length?!0:o.value.category.includes(u),y=u=>Object.entries(o.value).reduce((g,[T,I])=>{if(!I.length)return g;const B=u?.[T];if(B===void 0)return!1;const z=typeof I=="string"?I===B.toString():I.map(String).includes(B.toString());return g&&z},!0),D=c(()=>cn(s.value.with("teams").with("tickets",u=>{u.with("category").orderBy(n.value,"desc")}).whereHas("tickets").orWhere(u=>!a.hideEmpty&&u.online).get().filter(u=>!i.value.length||u.teams.some(g=>i.value.includes(g.uuid)))).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),C=c(()=>m.value.unbound().with("category").where("category_uuid",V).where("meta",y).orderBy(n.value,"desc").get()),U=Te(),E=L(null),{isOverDropZone:O}=Ge(E,async u=>{const g=u?.getData("text/plain");if(!g)throw new Error("Ticket UUID undefined.");return await U.close(g)},!1);Xe(()=>{v.listen(Wt.PropsInvalidated,()=>ge.reload()).listen(H.Enrolled,s.value.enroll).listen(H.Resigned,s.value.resign).listen(H.NameChanged,s.value.changeName).listen(H.Online,s.value.setOnline).listen(H.Offline,s.value.setOffline).listen(H.Ready,s.value.setReady).listen(H.NotReady,s.value.setNotReady).listen(H.TicketLimitAdjusted,s.value.adjustTicketLimit).listen(H.ComplexityLimitAdjusted,s.value.adjustComplexityLimit).listen(N.Created,m.value.create).listen(N.Closed,m.value.close).listen(N.Bound,m.value.bind).listen(N.Accepted,m.value.accept).listen(N.Unbound,m.value.unbind).listen(N.CategoryChanged,m.value.changeCategory).listen(N.MetaValueSet,m.value.setMetaValue).listen(N.MetaValuesMerged,m.value.mergeMetaValues).listen(N.MetricsAdjusted,m.value.adjustMetrics)});function $(){s.value.save(t.operators),p.value.fresh(t.operatorTeams),m.value.fresh(t.tickets),h.value.fresh(t.ticketCategories)}const S=ge.on("navigate",$),_=ge.on("success",$);Ct(()=>{S(),_()});const x=u=>Object.entries(u).map(([g,T])=>({title:g,value:T}));return(u,g)=>(b(),R(j,null,[r(k($t),{title:u.$t("dashboard")},null,8,["title"]),(b(),M(q(`${e.layout}-layout`),null,{header:f(()=>[l("h2",dn,d(u.$t("dashboard")),1)]),default:f(()=>[l("div",null,[r(ta,{fluid:""},{default:f(()=>[r(Be,null,{default:f(()=>[r(le,null,{default:f(()=>[r(St,{modelValue:k(a).all,"onUpdate:modelValue":g[0]||(g[0]=T=>k(a).all=T),variant:"plain",multiple:""},{default:f(()=>[r(A,{value:"show-filters",icon:k(a).showFilters?"mdi-filter-outline":"mdi-filter-off-outline"},null,8,["icon"]),r(A,{value:"hide-empty",icon:k(a).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),r(A,{value:"alt-info",icon:k(a).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),r(A,{value:"pin-header",icon:k(a).pinHeader?"mdi-pin-outline":"mdi-pin-off-outline"},null,8,["icon"]),r(A,{value:"unlocked",icon:k(a).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:k(a).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),k(a).unlocked?(b(),M(It,{key:0,variant:"plain"},{default:f(()=>[r(A,{ref_key:"closeTicket",ref:E,icon:k(O)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),r(A,{icon:"mdi-refresh"})]),_:1})):G("",!0)]),_:1}),r(le,{cols:"2"},{default:f(()=>[r(Lt,{modelValue:k(n),"onUpdate:modelValue":g[1]||(g[1]=T=>ke(n)?n.value=T:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1}),k(a).showFilters?(b(),M(Be,{key:0},{default:f(()=>[r(le,{cols:"2"},{default:f(()=>[r(Re,{modelValue:k(i),"onUpdate:modelValue":g[2]||(g[2]=T=>ke(i)?i.value=T:null),multiple:"",clearable:"",chips:"","closable-chips":"",label:u.$t("teams"),items:e.operatorTeams,"item-title":"name","item-value":"uuid"},null,8,["modelValue","label","items"])]),_:1}),r(le,{cols:"2"},{default:f(()=>[r(ea,{modelValue:k(o).title,"onUpdate:modelValue":g[3]||(g[3]=T=>k(o).title=T),label:u.$t("filter_title")},null,8,["modelValue","label"])]),_:1}),(b(!0),R(j,null,ie(e.matchers,(T,I)=>(b(),M(le,{key:I,cols:"2"},{default:f(()=>[r(Re,{modelValue:k(o)[I],"onUpdate:modelValue":B=>k(o)[I]=B,multiple:"",clearable:"",chips:"","closable-chips":"",label:u.$t(I),items:x(T)},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024))),128))]),_:1})):G("",!0)]),_:1}),r(aa,{"fixed-header":k(a).pinHeader,height:"600px",density:"compact",class:"ticket-monitor"},{default:f(()=>[l("thead",vn,[r(Qe,{pool:"",tickets:C.value},{name:f(()=>[P(d(u.$t("ticket_pool")),1)]),_:1},8,["tickets"])]),r(k(Ee),{tag:"tbody",class:"align-top",name:"operator-pool"},{default:f(()=>[(b(!0),R(j,null,ie(D.value,T=>(b(),M(an,{key:T.uuid,operator:T},null,8,["operator"]))),128))]),_:1})]),_:1},8,["fixed-header"])])]),_:1}))],64))}}),Sn=ue(fn,[["__scopeId","data-v-dfa77804"]]);export{Sn as default};
//# sourceMappingURL=Dashboard-D0lpkpyO.js.map
