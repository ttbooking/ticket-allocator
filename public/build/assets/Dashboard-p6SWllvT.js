import{T as Be}from"./TransitionGroup-DzHt_dPQ.js";import{k as Re,g as q,p as Q,a as qe,u as Qe,b as Je,c as et,r as W,d as u,s as pe,w as Me,e as tt,t as Y,f as r,h as i,V as A,i as J,j as Ee,n as _e,l as F,m as ot,o as Pe,q as Ae,v as We,x as at,y as nt,z as st,M as lt,A as it,B as rt,C as ye,D as ut,F as j,E as K,G as De,H as ct,I as Oe,J as dt,K as vt,L as ft,N as mt,O as ht,P as pt,Q as se,R as yt,S as gt,T as Ce,U as te,W as x,X as k,Y as m,Z as R,_ as N,$ as Le,a0 as d,a1 as S,a2 as _,a3 as ne,a4 as le,a5 as oe,a6 as Ue,a7 as kt,a8 as ue,a9 as z,aa as G,ab as ge,ac as bt,ad as _t,ae as he,af as wt,ag as Vt,ah as Tt,ai as $t}from"./app-CLBWdXnH.js";import{u as Z,i as Ct,M as xt,a as St,b as He,c as Xe,d as It,e as Bt,T as Ye,f as Rt,g as Mt,h as Et,C as Pt,O as L,j as U,V as At,k as Wt,l as Dt,m as Ot,n as Lt}from"./OperatorRepository-BwhOmp_y.js";import{u as Ut,m as Ht,V as xe,a as Xt,b as Yt}from"./filter-_pGNJYyg.js";import{V as jt,a as Nt}from"./VCard-Csk727xe.js";import{f as Ft,a as Gt,s as zt}from"./VTextField-4Ee2jiyl.js";import{V as Zt}from"./VContainer-Vehrl44i.js";import{V as Se,a as ce}from"./VRow-BGk2Ynu3.js";import{V as Ie}from"./VAutocomplete-CAmWEw96.js";import{V as Kt}from"./VTable-COjkfgXw.js";import"./VInput-CWpI0iWS.js";import"./VSelectionControl-Bn_FWRQJ.js";import"./VCheckboxBtn-D8K4EJkz.js";/* empty css              */const qt=e=>{const{touchstartX:t,touchendX:o,touchstartY:a,touchendY:n}=e,l=.5,s=16;e.offsetX=o-t,e.offsetY=n-a,Math.abs(e.offsetY)<l*Math.abs(e.offsetX)&&(e.left&&o<t-s&&e.left(e),e.right&&o>t+s&&e.right(e)),Math.abs(e.offsetX)<l*Math.abs(e.offsetY)&&(e.up&&n<a-s&&e.up(e),e.down&&n>a+s&&e.down(e))};function Qt(e,t){const o=e.changedTouches[0];t.touchstartX=o.clientX,t.touchstartY=o.clientY,t.start?.({originalEvent:e,...t})}function Jt(e,t){const o=e.changedTouches[0];t.touchendX=o.clientX,t.touchendY=o.clientY,t.end?.({originalEvent:e,...t}),qt(t)}function eo(e,t){const o=e.changedTouches[0];t.touchmoveX=o.clientX,t.touchmoveY=o.clientY,t.move?.({originalEvent:e,...t})}function to(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:o=>Qt(o,t),touchend:o=>Jt(o,t),touchmove:o=>eo(o,t)}}function oo(e,t){const o=t.value,a=o?.parent?e.parentElement:e,n=o?.options??{passive:!0},l=t.instance?.$.uid;if(!a||!l)return;const s=to(t.value);a._touchHandlers=a._touchHandlers??Object.create(null),a._touchHandlers[l]=s,Re(s).forEach(b=>{a.addEventListener(b,s[b],n)})}function ao(e,t){const o=t.value?.parent?e.parentElement:e,a=t.instance?.$.uid;if(!o?._touchHandlers||!a)return;const n=o._touchHandlers[a];Re(n).forEach(l=>{o.removeEventListener(l,n[l])}),delete o._touchHandlers[a]}const ke={mounted:oo,unmounted:ao},je=Symbol.for("vuetify:v-window"),Ne=Symbol.for("vuetify:v-window-group"),Fe=Q({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Ae(),...Pe(),...ot()},"VWindow"),be=q()({name:"VWindow",directives:{vTouch:ke},props:Fe(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const{themeClasses:a}=qe(e),{isRtl:n}=Qe(),{t:l}=Je(),s=et(e,Ne),b=W(),v=u(()=>n.value?!e.reverse:e.reverse),f=pe(!1),p=u(()=>{const V=e.direction==="vertical"?"y":"x",g=(v.value?!f.value:f.value)?"-reverse":"";return`v-window-${V}${g}-transition`}),T=pe(0),y=W(void 0),I=u(()=>s.items.value.findIndex(V=>s.selected.value.includes(V.id)));Me(I,(V,c)=>{const g=s.items.value.length,w=g-1;g<=2?f.value=V<c:V===w&&c===0?f.value=!0:V===0&&c===w?f.value=!1:f.value=V<c}),tt(je,{transition:p,isReversed:f,transitionCount:T,transitionHeight:y,rootRef:b});const $=Y(()=>e.continuous||I.value!==0),E=Y(()=>e.continuous||I.value!==s.items.value.length-1);function M(){$.value&&s.prev()}function B(){E.value&&s.next()}const D=u(()=>{const V=[],c={icon:n.value?e.nextIcon:e.prevIcon,class:`v-window__${v.value?"right":"left"}`,onClick:s.prev,"aria-label":l("$vuetify.carousel.prev")};V.push($.value?o.prev?o.prev({props:c}):r(A,c,null):i("div",null,null));const g={icon:n.value?e.prevIcon:e.nextIcon,class:`v-window__${v.value?"left":"right"}`,onClick:s.next,"aria-label":l("$vuetify.carousel.next")};return V.push(E.value?o.next?o.next({props:g}):r(A,g,null):i("div",null,null)),V}),O=u(()=>e.touch===!1?e.touch:{...{left:()=>{v.value?M():B()},right:()=>{v.value?B():M()},start:c=>{let{originalEvent:g}=c;g.stopPropagation()}},...e.touch===!0?{}:e.touch});return J(()=>Ee(r(e.tag,{ref:b,class:F(["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},a.value,e.class]),style:_e(e.style)},{default:()=>[i("div",{class:"v-window__container",style:{height:y.value}},[o.default?.({group:s}),e.showArrows!==!1&&i("div",{class:"v-window__controls"},[D.value])]),o.additional?.({group:s})]}),[[ke,O.value]])),{group:s}}}),Ge=Q({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ae(),...it(),...Ht()},"VWindowItem"),ae=q()({name:"VWindowItem",directives:{vTouch:ke},props:Ge(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:o}=t;const a=We(je),n=at(e,Ne),{isBooted:l}=nt();if(!a||!n)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const s=pe(!1),b=u(()=>l.value&&(a.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function v(){!s.value||!a||(s.value=!1,a.transitionCount.value>0&&(a.transitionCount.value-=1,a.transitionCount.value===0&&(a.transitionHeight.value=void 0)))}function f(){s.value||!a||(s.value=!0,a.transitionCount.value===0&&(a.transitionHeight.value=ye(a.rootRef.value?.clientHeight)),a.transitionCount.value+=1)}function p(){v()}function T($){s.value&&rt(()=>{!b.value||!s.value||!a||(a.transitionHeight.value=ye($.clientHeight))})}const y=u(()=>{const $=a.isReversed.value?e.reverseTransition:e.transition;return b.value?{name:typeof $!="string"?a.transition.value:$,onBeforeEnter:f,onAfterEnter:v,onEnterCancelled:p,onBeforeLeave:f,onAfterLeave:v,onLeaveCancelled:p,onEnter:T}:!1}),{hasContent:I}=Ut(e,n.isSelected);return J(()=>r(lt,{transition:y.value,disabled:!l.value},{default:()=>[Ee(i("div",{class:F(["v-window-item",n.selectedClass.value,e.class]),style:_e(e.style)},[I.value&&o.default?.()]),[[st,n.isSelected.value]])]})),{groupItem:n}}}),we=Symbol.for("vuetify:v-tabs"),no=Q({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...De(ct({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),de=q()({name:"VTab",props:no(),setup(e,t){let{slots:o,attrs:a}=t;const{textColorClasses:n,textColorStyles:l}=ut(()=>e.sliderColor),s=W(),b=W(),v=u(()=>e.direction==="horizontal"),f=u(()=>s.value?.group?.isSelected.value??!1);function p(T){let{value:y}=T;if(y){const I=s.value?.$el.parentElement?.querySelector(".v-tab--selected .v-tab__slider"),$=b.value;if(!I||!$)return;const E=getComputedStyle(I).color,M=I.getBoundingClientRect(),B=$.getBoundingClientRect(),D=v.value?"x":"y",O=v.value?"X":"Y",V=v.value?"right":"bottom",c=v.value?"width":"height",g=M[D],w=B[D],C=g>w?M[V]-B[V]:M[D]-B[D],H=Math.sign(C)>0?v.value?"right":"bottom":Math.sign(C)<0?v.value?"left":"top":"center",ve=(Math.abs(C)+(Math.sign(C)<0?M[c]:B[c]))/Math.max(M[c],B[c])||0,fe=M[c]/B[c]||0,ie=1.5;Gt($,{backgroundColor:[E,"currentcolor"],transform:[`translate${O}(${C}px) scale${O}(${fe})`,`translate${O}(${C/ie}px) scale${O}(${(ve-1)/ie+1})`,"none"],transformOrigin:Array(3).fill(H)},{duration:225,easing:zt})}}return J(()=>{const T=A.filterProps(e);return r(A,K({symbol:we,ref:s,class:["v-tab",e.class],style:e.style,tabindex:f.value?0:-1,role:"tab","aria-selected":String(f.value),active:!1},T,a,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":p}),{...o,default:()=>i(j,null,[o.default?.()??e.text,!e.hideSlider&&i("div",{ref:b,class:F(["v-tab__slider",n.value]),style:_e(l.value)},null)])})}),Ft({},s)}}),so=Q({...De(Fe(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),lo=q()({name:"VTabsWindow",props:so(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const a=We(we,null),n=Oe(e,"modelValue"),l=u({get(){return n.value!=null||!a?n.value:a.items.value.find(s=>a.selected.value.includes(s.id))?.value},set(s){n.value=s}});return J(()=>{const s=be.filterProps(e);return r(be,K({_as:"VTabsWindow"},s,{modelValue:l.value,"onUpdate:modelValue":b=>l.value=b,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),o)}),{}}}),io=Q({...Ge()},"VTabsWindowItem"),ro=q()({name:"VTabsWindowItem",props:io(),setup(e,t){let{slots:o}=t;return J(()=>{const a=ae.filterProps(e);return r(ae,K({_as:"VTabsWindowItem"},a,{class:["v-tabs-window-item",e.class],style:e.style}),o)}),{}}});function uo(e){return e?e.map(t=>pt(t)?t:{text:t,value:t}):[]}const co=Q({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Xt({mandatory:"force",selectedClass:"v-tab-item--selected"}),...ht(),...Pe()},"VTabs"),vo=q()({name:"VTabs",props:co(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:o,slots:a}=t;const n=Oe(e,"modelValue"),l=u(()=>uo(e.items)),{densityClasses:s}=dt(e),{backgroundColorClasses:b,backgroundColorStyles:v}=vt(()=>e.bgColor),{scopeId:f}=ft();return mt({VTab:{color:Y(()=>e.color),direction:Y(()=>e.direction),stacked:Y(()=>e.stacked),fixed:Y(()=>e.fixedTabs),sliderColor:Y(()=>e.sliderColor),hideSlider:Y(()=>e.hideSlider)}}),J(()=>{const p=xe.filterProps(e),T=!!(a.window||e.items.length>0);return i(j,null,[r(xe,K(p,{modelValue:n.value,"onUpdate:modelValue":y=>n.value=y,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},s.value,b.value,e.class],style:[{"--v-tabs-height":ye(e.height)},v.value,e.style],role:"tablist",symbol:we},f,o),{default:()=>[a.default?.()??l.value.map(y=>a.tab?.({item:y})??r(de,K(y,{key:y.text,value:y.value}),{default:a[`tab.${y.value}`]?()=>a[`tab.${y.value}`]?.({item:y}):void 0}))]}),T&&r(lo,K({modelValue:n.value,"onUpdate:modelValue":y=>n.value=y,key:"tabs-window"},f),{default:()=>[l.value.map(y=>a.item?.({item:y})??r(ro,{value:y.value},{default:()=>a[`item.${y.value}`]?.({item:y})})),a.window?.()]})])}),{}}});function fo(e,t){const o=W();return Z(e,"dragstart",a=>{if(o.value=a.target,typeof t=="string"){const n=t;t=(l,s)=>{s?.setData("text/plain",l.dataset[n]??"")}}t?.(o.value,a.dataTransfer)}),Z(e,"dragend",()=>{o.value=null}),{element:o}}function ze(e,t,o=!0){const a=W(!1);let n=0;return Ct&&(Z(e,"dragenter",l=>{l.preventDefault(),n++,a.value=!0}),Z(e,"dragover",l=>{l.preventDefault()}),Z(e,"dragleave",l=>{l.preventDefault(),n--,n===0&&(a.value=!1)}),Z(e,"drop",l=>{if(l.preventDefault(),n=0,a.value=!1,t)if(o){const s=Array.from(l.dataTransfer?.files??[]);t(s.length===0?null:s)}else t(l.dataTransfer)})),{isOverDropZone:a}}const mo={class:"d-inline-block"},ho={class:"overflow-hidden text-white"},po={class:"title relative inline-block"},yo=["innerHTML"],go={key:1},ko=["innerHTML"],bo={key:0},_o={key:1},wo={key:2},Vo={key:3},To={class:"table-fixed"},$o={class:"w-1/3"},Co={class:"text-center"},xo=["title"],So={class:"text-center"},Io=["title"],Bo={class:"text-center"},Ro=["title"],Mo={class:"text-center"},Eo=["title"],Po={class:"text-center"},Ao=["title"],Wo={class:"text-right"},Do={class:"text-right"},Oo={class:"text-right"},Lo={class:"text-right"},Uo={class:"text-right"},Ho={class:"text-right"},Xo={class:"text-right"},Yo={class:"text-right"},jo={class:"text-right"},No={class:"text-right"},Fo=se({__name:"Ticket",props:{ticket:{}},setup(e){yt(h=>({"0c560d15":$e.value.delay,"2b070e7c":$e.value.duration}));const t=e,{t:o}=gt(),a=u(()=>Ce().props.factors),n=W(null),l=new xt({linkify:!0}).use(St),s=He(),b=Xe(),v=u(()=>Ce().props.options),f=u(()=>te(t.ticket.created_at)),p=u(()=>te.duration(t.ticket.delay,"s")),T=u(()=>f.value.add(p.value)),y=u(()=>t.ticket.bound_at?te(t.ticket.bound_at):null),I=u(()=>t.ticket.reservation?te.duration(t.ticket.reservation,"s"):null),$=u(()=>y.value&&I.value?y.value.add(I.value):null),E=u(()=>t.ticket.accepted_at?te(t.ticket.accepted_at):null),M=u(()=>`${f.value.format("lll")} (${f.value.fromNow()})`),B=u(()=>`${T.value.format("lll")} (${o("time_left",{time:T.value.fromNow(!0)})})`),D=u(()=>y.value?`${y.value.format("lll")} (${y.value.fromNow()})`:null),O=u(()=>$.value?`${$.value.format("lll")} (${o("time_left",{time:$.value.fromNow(!0)})})`:null),V=u(()=>E.value?`${E.value.format("lll")} (${E.value.fromNow()})`:null),c=u(()=>`${C(t.ticket.weight)} (${o("increment_per_second",{units:t.ticket.weight_increment.toString()})})`),g=u(()=>v.value[`${b.value}_threshold`]),w=u(()=>t.ticket[b.value]),C=h=>h<1e5?h:h.toExponential(1),H=()=>t.ticket.meta?.category_name??t.ticket.category?.name??"",ee=()=>t.ticket.meta?.category_short??t.ticket.category?.short??"",ve=()=>s.altInfo?t.ticket.meta?.title??ee():ee(),fe=u(()=>t.ticket.meta?.card_title??"Title"),ie=u(()=>t.ticket.meta?.card_subtitle??H()),me=u(()=>t.ticket.meta?.card_content??[]),Ke=u(()=>w.value>g.value),$e=u(()=>({delay:-w.value+"s",duration:g.value+"s"}));return(h,X)=>(k(),x("div",mo,[r(A,{size:"small",class:F(["ticket justify-start px-2",{overflow:Ke.value}]),ripple:!1,flat:"",width:"100"},{default:m(()=>[h.ticket.meta?.icon?(k(),R(Le,{key:0,icon:h.ticket.meta?.icon??"",color:"white"},null,8,["icon"])):N("",!0),i("span",ho,[i("span",po,d(ve()),1)]),r(Yt,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:m(()=>[r(jt,{width:"500","prepend-icon":h.ticket.meta?.icon??"",title:fe.value,subtitle:ie.value},{default:m(()=>[r(vo,{modelValue:n.value,"onUpdate:modelValue":X[0]||(X[0]=P=>n.value=P)},{default:m(()=>[r(de,{value:"properties"},{default:m(()=>[S(d(h.$t("properties")),1)]),_:1}),r(de,{value:"metrics"},{default:m(()=>[S(d(h.$t("metrics")),1)]),_:1}),r(de,{value:"details"},{default:m(()=>[S(d(h.$t("details")),1)]),_:1})]),_:1},8,["modelValue"]),r(Nt,null,{default:m(()=>[r(be,{modelValue:n.value,"onUpdate:modelValue":X[1]||(X[1]=P=>n.value=P)},{default:m(()=>[r(ae,{value:"properties",class:"prose"},{default:m(()=>[typeof me.value=="string"?(k(),x("div",{key:0,innerHTML:_(l).render(me.value)},null,8,yo)):(k(),x("table",go,[i("tbody",null,[(k(!0),x(j,null,ne(me.value,([P,re])=>(k(),x("tr",{key:P},[i("th",null,d(P),1),i("td",{innerHTML:_(l).renderInline(re)},null,8,ko)]))),128))])]))]),_:1}),r(ae,{value:"metrics",class:"prose"},{default:m(()=>[i("table",null,[i("tbody",null,[i("tr",null,[i("th",null,d(h.$t("issued_on")),1),i("td",null,d(M.value),1)]),T.value.isAfter(h.$dayjs())?(k(),x("tr",bo,[i("th",null,d(h.$t("delayed_until")),1),i("td",null,d(B.value),1)])):N("",!0),y.value?(k(),x("tr",_o,[i("th",null,d(h.$t("bound_at")),1),i("td",null,d(D.value),1)])):N("",!0),$.value&&$.value.isAfter(h.$dayjs())?(k(),x("tr",wo,[i("th",null,d(h.$t("reserved_until")),1),i("td",null,d(O.value),1)])):N("",!0),E.value?(k(),x("tr",Vo,[i("th",null,d(h.$t("accepted_at")),1),i("td",null,d(V.value),1)])):N("",!0),i("tr",null,[i("th",null,d(h.$t("current_weight")),1),i("td",null,d(c.value),1)]),i("tr",null,[i("th",null,d(h.$t("complexity")),1),i("td",null,d(h.ticket.complexity+" "+_(o)("units")),1)])])])]),_:1}),r(ae,{value:"details",class:"prose"},{default:m(()=>[i("table",To,[i("thead",null,[i("tr",null,[i("th",$o,d(h.$t("factor")),1),i("th",Co,[i("em",{class:"metric",title:h.$t("initial_weight")},X[2]||(X[2]=[S("W"),i("sub",null,"0",-1)]),8,xo)]),i("th",So,[i("em",{class:"metric",title:h.$t("weight_increment")},X[3]||(X[3]=[S("W"),i("sub",null,"i",-1)]),8,Io)]),i("th",Bo,[i("em",{class:"metric",title:h.$t("complexity")},"C",8,Ro)]),i("th",Mo,[i("em",{class:"metric",title:h.$t("delay_sec")},"D",8,Eo)]),i("th",Po,[i("em",{class:"metric",title:h.$t("reservation_sec")},"R",8,Ao)])])]),i("tbody",null,[(k(!0),x(j,null,ne(h.ticket.metrics??{},(P,re)=>(k(),x("tr",{key:re},[i("th",null,d(a.value[re]?.name??h.$t("unknown")),1),i("td",Wo,d(P.initial_weight??0),1),i("td",Do,d(P.weight_increment??0),1),i("td",Oo,d(P.complexity??0),1),i("td",Lo,d(P.delay??0),1),i("td",Uo,d(P.reservation??0),1)]))),128))]),i("tfoot",null,[i("tr",null,[i("th",null,d(h.$t("total")),1),i("td",Ho,d(h.ticket.initial_weight),1),i("td",Xo,d(h.ticket.weight_increment),1),i("td",Yo,d(h.ticket.complexity),1),i("td",jo,d(h.ticket.delay),1),i("td",No,d(h.ticket.reservation),1)])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["prepend-icon","title","subtitle"])]),_:1})]),_:1},8,["class"])]))}}),Go=le(Fo,[["__scopeId","data-v-8c1a37e4"]]),zo=se({__name:"TicketPool",props:{tickets:{}},setup(e){const t=W(null);fo(t,"uuid");const{lock:o,unlock:a,element:n,triggerElement:l}=It(t),{x:s}=Bt({type:"movement"});u(()=>oe(Ye)),Me([n,s],([v,f])=>{!v||!l.value||l.value.dataset.uuid});const b=W(!1);return Ue(()=>{setTimeout(()=>b.value=!0,500)}),(v,f)=>(k(),R(_(Be),{ref_key:"ticketPool",ref:t,name:"ticket-pool",class:"tickets @container !pt-[1px] !pb-[3px] leading-8",css:b.value,onMouseup:_(a)},{default:m(()=>[(k(!0),x(j,null,ne(v.tickets,p=>(k(),R(Go,{key:p.uuid,"data-uuid":p.uuid,ticket:p,draggable:"true",class:"mr-1",onMousedown:kt(_(o),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css","onMouseup"]))}}),Zo=le(zo,[["__scopeId","data-v-1fd3da22"]]);function Ve(){async function e(n,l){return await window.axios.patch(ue("ticket-allocator.operators.ready",n),{ready:l})}async function t(n,l){return await window.axios.patch(ue("ticket-allocator.tickets.weight",n),{weight_points:l})}async function o(n,l){return await window.axios.patch(ue("ticket-allocator.tickets.handler",n),{operator_uuid:l??null})}async function a(n){return await window.axios.delete(ue("ticket-allocator.tickets.close",n))}return{ready:e,weight:t,handler:o,close:a}}const Ko=se({__name:"TicketRow",props:{tickets:{},pool:{type:Boolean}},setup(e){const t=e;let o=W(!1);const a=u(()=>t.pool?"th":"td"),n=u(()=>t.tickets.reduce((f,{complexity:p})=>f+p,0)),l=u(()=>o.value?"mdi-chevron-down":"mdi-chevron-up"),s=Ve(),b=W(null),{isOverDropZone:v}=ze(b,async f=>{const p=f?.getData("text/plain");if(!p)throw new Error("Ticket UUID undefined.");const T=b.value?.dataset.uuid;return await s.handler(p,T)},!1);return(f,p)=>(k(),x("tr",{ref_key:"ticketRow",ref:b,class:F(["ticket-row",{dragover:_(v)}])},[(k(),R(z(a.value),{class:"status py-1"},{default:m(()=>[G(f.$slots,"status",{},void 0,!0)]),_:3})),(k(),R(z(a.value),{class:"name font-weight-bold !pt-[6px]"},{default:m(()=>[G(f.$slots,"name",{},void 0,!0)]),_:3})),(k(),R(z(a.value),{class:"load !pt-[6px] text-center"},{default:m(()=>[G(f.$slots,"load",{},()=>[S(d(f.tickets.length),1)],!0),p[2]||(p[2]=S("/")),G(f.$slots,"load-max",{},()=>[p[1]||(p[1]=S("∞"))],!0)]),_:3,__:[2]})),(k(),R(z(a.value),{class:"complexity !pt-[6px] text-center"},{default:m(()=>[G(f.$slots,"complexity",{},()=>[S(d(n.value),1)],!0),p[4]||(p[4]=S("/")),G(f.$slots,"complexity-max",{},()=>[p[3]||(p[3]=S("∞"))],!0)]),_:3,__:[4]})),r(Zo,{tag:a.value,tickets:f.tickets,class:F({collapsed:_(o)})},null,8,["tag","tickets","class"]),(k(),R(z(a.value),{class:"more !pt-[2px] text-center"},{default:m(()=>[r(A,{size:"x-small",variant:"tonal",icon:l.value,onClick:p[0]||(p[0]=T=>ge(o)?o.value=!_(o):o=!_(o))},null,8,["icon"])]),_:1}))],2))}}),Ze=le(Ko,[["__scopeId","data-v-113cb187"]]),qo=se({__name:"OperatorRow",props:{operator:{}},setup(e){const t=e,o=u(()=>({online:t.operator.online,ready:t.operator.ready,busy:!!t.operator.tickets?.length,full:t.operator.ticket_limit!==null&&t.operator.tickets?.length>=t.operator.ticket_limit})),a=Ve(),n=async()=>await a.ready(t.operator.uuid,!t.operator.ready);return(l,s)=>(k(),R(Ze,{tickets:l.operator.tickets,"data-uuid":l.operator.uuid,class:F(["operator",o.value])},{status:m(()=>[r(Le,{icon:"mdi-account",onClick:n})]),"load-max":m(()=>[S(d(l.operator.ticket_limit??"∞"),1)]),"complexity-max":m(()=>[S(d(l.operator.complexity_limit??"∞"),1)]),name:m(()=>[S(d(l.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}}),Qo=le(qo,[["__scopeId","data-v-a776c74a"]]);function Jo(e,t){return e.reduce((o,a)=>(typeof a[t]=="number"&&(o+=a[t]),o),0)}function Te(e,t){return e.map(o=>_t(o,t)).filter(o=>o)}function ea(e,t){const o=Te(e,t).filter(a=>typeof a=="number");return o.length===0?0:Math.max(...o)}function ta(e,t){const o=Te(e,t).filter(a=>typeof a=="number");return o.length===0?0:Math.min(...o)}function oa(e){return e.map(t=>t[t.$getLocalKey()])}function aa(e,t){const o={},a=Array.isArray(t)?t:[t];return e.forEach(n=>{const l=a.length===1?n[a[0]]:`[${a.map(s=>n[s]).toString()}]`;o[l]=(o[l]||[]).concat(n)}),o}function na(e,t,o){const a=[],n=[];return typeof t=="function"&&n.push(t)&&a.push("asc"),Array.isArray(t)&&t.forEach(l=>n.push(l[0])&&a.push(l[1])),n.length===0&&n.push(t),bt(e,n,a,o)}function sa(e){return{sum:t=>Jo(e,t),min:t=>ta(e,t),max:t=>ea(e,t),pluck:t=>Te(e,t),groupBy:t=>aa(e,t),sortBy:(t,o="SORT_REGULAR")=>na(e,t,o),keys:()=>oa(e)}}const la={class:"text-xl leading-tight font-semibold text-gray-800"},ia={class:"align-top"},ra=se({__name:"Dashboard",props:{layout:{default:"default"},operators:{},operatorTeams:{},tickets:{},ticketCategories:{},factors:{},matchers:{}},setup(e){const t=e,o=He(),a=Xe(),n=Rt(),l=Mt(),s=u(()=>oe(Wt)),b=u(()=>oe(Dt)),v=u(()=>oe(Ye)),f=u(()=>oe(Ot)),p=Et(Lt),T=c=>Object.entries(n.value).reduce((g,[w,C])=>{const H=c?.[w],ee=H===void 0||!C.length||C.map(String).includes(H.toString());return g&&ee},!0),y=u(()=>sa(s.value.with("teams").with("tickets",c=>{c.with("category").where("meta",T).orderBy(a.value,"desc")}).whereHas("tickets").orWhere(c=>!o.hideEmpty&&c.online).get().filter(c=>!l.value.length||c.teams.some(g=>l.value.includes(g.uuid)))).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),I=u(()=>v.value.unbound().with("category").where("meta",T).orderBy(a.value,"desc").get()),$=Ve(),E=W(null),{isOverDropZone:M}=ze(E,async c=>{const g=c?.getData("text/plain");if(!g)throw new Error("Ticket UUID undefined.");return await $.close(g)},!1);Ue(()=>{p.listen(Pt.PropsInvalidated,()=>he.reload()).listen(L.Enrolled,s.value.enroll).listen(L.Resigned,s.value.resign).listen(L.NameChanged,s.value.changeName).listen(L.Online,s.value.setOnline).listen(L.Offline,s.value.setOffline).listen(L.Ready,s.value.setReady).listen(L.NotReady,s.value.setNotReady).listen(L.TicketLimitAdjusted,s.value.adjustTicketLimit).listen(L.ComplexityLimitAdjusted,s.value.adjustComplexityLimit).listen(U.Created,v.value.create).listen(U.Closed,v.value.close).listen(U.Bound,v.value.bind).listen(U.Accepted,v.value.accept).listen(U.Unbound,v.value.unbind).listen(U.CategoryChanged,v.value.changeCategory).listen(U.MetaValueSet,v.value.setMetaValue).listen(U.MetaValuesMerged,v.value.mergeMetaValues).listen(U.MetricsAdjusted,v.value.adjustMetrics)});function B(){s.value.save(t.operators),b.value.fresh(t.operatorTeams),v.value.fresh(t.tickets),f.value.fresh(t.ticketCategories)}const D=he.on("navigate",B),O=he.on("success",B);wt(()=>{D(),O()});const V=c=>Object.entries(c).map(([g,w])=>({title:g,value:w}));return(c,g)=>(k(),x(j,null,[r(_(Vt),{title:c.$t("dashboard")},null,8,["title"]),(k(),R(z(`${c.layout}-layout`),null,{header:m(()=>[i("h2",la,d(c.$t("dashboard")),1)]),default:m(()=>[i("div",null,[r(Zt,{fluid:""},{default:m(()=>[r(Se,null,{default:m(()=>[r(ce,null,{default:m(()=>[r(Tt,{modelValue:_(o).all,"onUpdate:modelValue":g[0]||(g[0]=w=>_(o).all=w),variant:"plain",multiple:""},{default:m(()=>[r(A,{value:"show-filters",icon:_(o).showFilters?"mdi-filter-outline":"mdi-filter-off-outline"},null,8,["icon"]),r(A,{value:"hide-empty",icon:_(o).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),r(A,{value:"alt-info",icon:_(o).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),r(A,{value:"unlocked",icon:_(o).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:_(o).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),_(o).unlocked?(k(),R($t,{key:0,variant:"plain"},{default:m(()=>[r(A,{ref_key:"closeTicket",ref:E,icon:_(M)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),r(A,{icon:"mdi-refresh"})]),_:1})):N("",!0)]),_:1}),r(ce,{cols:"2"},{default:m(()=>[r(At,{modelValue:_(a),"onUpdate:modelValue":g[1]||(g[1]=w=>ge(a)?a.value=w:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1}),_(o).showFilters?(k(),R(Se,{key:0},{default:m(()=>[r(ce,{cols:"2"},{default:m(()=>[r(Ie,{modelValue:_(l),"onUpdate:modelValue":g[2]||(g[2]=w=>ge(l)?l.value=w:null),multiple:"",clearable:"",chips:"","closable-chips":"",label:c.$t("teams"),items:c.operatorTeams,"item-title":"name","item-value":"uuid"},null,8,["modelValue","label","items"])]),_:1}),(k(!0),x(j,null,ne(c.matchers,(w,C)=>(k(),R(ce,{key:C,cols:"2"},{default:m(()=>[r(Ie,{modelValue:_(n)[C],"onUpdate:modelValue":H=>_(n)[C]=H,multiple:"",clearable:"",chips:"","closable-chips":"",label:c.$t(C),items:V(w)},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024))),128))]),_:1})):N("",!0)]),_:1}),r(Kt,{"fixed-header":"",height:"600px",density:"compact",class:"ticket-monitor"},{default:m(()=>[i("thead",ia,[r(Ze,{pool:"",tickets:I.value},{name:m(()=>[S(d(c.$t("ticket_pool")),1)]),_:1},8,["tickets"])]),r(_(Be),{tag:"tbody",class:"align-top",name:"operator-pool"},{default:m(()=>[(k(!0),x(j,null,ne(y.value,w=>(k(),R(Qo,{key:w.uuid,operator:w},null,8,["operator"]))),128))]),_:1})]),_:1})])]),_:1}))],64))}}),Va=le(ra,[["__scopeId","data-v-811338dd"]]);export{Va as default};
//# sourceMappingURL=Dashboard-p6SWllvT.js.map
