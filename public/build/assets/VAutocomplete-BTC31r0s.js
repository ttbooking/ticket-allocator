import{f as xe,g as be,h as Ce,i as we,j as Se,k as Fe,l as Ae,n as Ie}from"./filter-DSlQ8NIR.js";import{V as W,f as Pe,d as De}from"./VTextField-B0VV_JBK.js";import{g as Re,p as Te,b as Me,r as P,s as S,E as O,d as g,aZ as Ee,A as _e,a_ as Le,w as D,y as Z,ao as Be,h as Ke,f as v,F as U,$ as G,a$ as Ne,B as w,b0 as Oe,b1 as J,av as Ue,b2 as ze,ap as $e,a1 as qe,b3 as He,C as je,b4 as Q,b5 as We,b6 as X}from"./app-9Chs2X98.js";import{a as Ze}from"./VInput-otzsS4uX.js";import{V as Ge}from"./VCheckboxBtn-Dc4JUNAG.js";const Je=Te({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Ie({filterKeys:["title"]}),...Ae(),...je(De({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...He({transition:!1})},"VAutocomplete"),tl=Re()({name:"VAutocomplete",props:Je(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,Y){let{slots:n}=Y;const{t:R}=Me(),p=P(),V=S(!1),k=S(!0),T=S(!1),z=P(),M=P(),E=O(l,"menu"),r=g({get:()=>E.value,set:e=>{var t;E.value&&!e&&((t=z.value)!=null&&t.Î¨openChildren.size)||(E.value=e)}}),o=S(-1),ee=g(()=>{var e;return(e=p.value)==null?void 0:e.color}),$=g(()=>r.value?l.closeText:l.openText),{items:q,transformIn:le,transformOut:te}=Ee(l),{textColorClasses:ae,textColorStyles:ue}=_e(ee),f=O(l,"search",""),u=O(l,"modelValue",[],e=>le(e===null?[null]:Le(e)),e=>{const t=te(e);return l.multiple?t:t[0]??null}),ne=g(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:u.value.length),F=Ze(l),{filteredItems:_,getMatches:oe}=xe(l,q,()=>k.value?"":f.value),y=g(()=>l.hideSelected?_.value.filter(e=>!u.value.some(t=>t.value===e.value)):_.value),A=g(()=>!!(l.chips||n.chip)),b=g(()=>A.value||!!n.selection),ie=g(()=>u.value.map(e=>e.props.value)),L=g(()=>{var t;return(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&f.value===((t=y.value[0])==null?void 0:t.title))&&y.value.length>0&&!k.value&&!T.value}),B=g(()=>l.hideNoData&&!y.value.length||F.isReadonly.value||F.isDisabled.value),K=P(),se=be(K,p);function re(e){l.openOnClear&&(r.value=!0),f.value=""}function ce(){B.value||(r.value=!0)}function ve(e){B.value||(V.value&&(e.preventDefault(),e.stopPropagation()),r.value=!r.value)}function de(e){var t;e.key!==" "&&Q(e)&&((t=p.value)==null||t.focus())}function fe(e){var a,s,m;if(F.isReadonly.value)return;const t=p.value.selectionStart,i=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(r.value=!0),["Escape"].includes(e.key)&&(r.value=!1),L.value&&["Enter","Tab"].includes(e.key)&&!u.value.some(c=>{let{value:d}=c;return d===y.value[0].value})&&x(y.value[0]),e.key==="ArrowDown"&&L.value&&((a=K.value)==null||a.focus("next")),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&b.value&&u.value.length>0&&!f.value)return x(u.value[0],!1);if(~o.value){e.preventDefault();const c=o.value;x(u.value[o.value],!1),o.value=c>=i-1?i-2:c}else e.key==="Backspace"&&!f.value&&(o.value=i-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(o.value<0&&t>0)return;const c=o.value>-1?o.value-1:i-1;u.value[c]?o.value=c:(o.value=-1,p.value.setSelectionRange((s=f.value)==null?void 0:s.length,(m=f.value)==null?void 0:m.length))}else if(e.key==="ArrowRight"){if(o.value<0)return;const c=o.value+1;u.value[c]?o.value=c:(o.value=-1,p.value.setSelectionRange(0,0))}else~o.value&&Q(e)&&(o.value=-1)}function me(e){if(X(p.value,":autofill")||X(p.value,":-webkit-autofill")){const t=q.value.find(i=>i.title===e.target.value);t&&x(t)}}function he(){var e;l.eager&&((e=M.value)==null||e.calculateVisibleItems())}function pe(){var e;V.value&&(k.value=!0,(e=p.value)==null||e.focus())}function ge(e){V.value=!0,setTimeout(()=>{T.value=!0})}function Ve(e){T.value=!1}function ye(e){(e==null||e===""&&!l.multiple&&!b.value)&&(u.value=[])}const N=S(!1);function x(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const i=u.value.findIndex(s=>(l.valueComparator||We)(s.value,e.value)),a=t??!~i;if(~i){const s=a?[...u.value,e]:[...u.value];s.splice(i,1),u.value=s}else a&&(u.value=[...u.value,e]);l.clearOnSelect&&(f.value="")}else{const i=t!==!1;u.value=i?[e]:[],f.value=i&&!b.value?e.title:"",Z(()=>{r.value=!1,k.value=!0})}}return D(V,(e,t)=>{var i;e!==t&&(e?(N.value=!0,f.value=l.multiple||b.value?"":String(((i=u.value.at(-1))==null?void 0:i.props.title)??""),k.value=!0,Z(()=>N.value=!1)):(!l.multiple&&f.value==null&&(u.value=[]),r.value=!1,(l.multiple||b.value)&&(f.value=""),o.value=-1))}),D(f,e=>{!V.value||N.value||(e&&(r.value=!0),k.value=!e)}),D(r,()=>{if(!l.hideSelected&&r.value&&u.value.length){const e=y.value.findIndex(t=>u.value.some(i=>t.value===i.value));Be&&window.requestAnimationFrame(()=>{var t;e>=0&&((t=M.value)==null||t.scrollToIndex(e))})}}),D(()=>l.items,(e,t)=>{r.value||V.value&&!t.length&&e.length&&(r.value=!0)}),Ke(()=>{const e=!!(!l.hideNoData||y.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),t=u.value.length>0,i=W.filterProps(l);return v(W,w({ref:p},i,{modelValue:f.value,"onUpdate:modelValue":[a=>f.value=a,ye],focused:V.value,"onUpdate:focused":a=>V.value=a,validationValue:u.externalValue,counterValue:ne.value,dirty:t,onChange:me,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":r.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!b.value,"v-autocomplete--selecting-index":o.value>-1},l.class],style:l.style,readonly:F.isReadonly.value,placeholder:t?void 0:l.placeholder,"onClick:clear":re,"onMousedown:control":ce,onKeydown:fe}),{...n,default:()=>v(U,null,[v(Ce,w({ref:z,modelValue:r.value,"onUpdate:modelValue":a=>r.value=a,activator:"parent",contentClass:"v-autocomplete__content",disabled:B.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterEnter:he,onAfterLeave:pe},l.menuProps),{default:()=>[e&&v(Oe,w({ref:K,selected:ie.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:a=>a.preventDefault(),onKeydown:de,onFocusin:ge,onFocusout:Ve,tabindex:"-1","aria-live":"polite",color:l.itemColor??l.color},se,l.listProps),{default:()=>{var a,s,m;return[(a=n["prepend-item"])==null?void 0:a.call(n),!y.value.length&&!l.hideNoData&&(((s=n["no-data"])==null?void 0:s.call(n))??v(J,{key:"no-data",title:R(l.noDataText)},null)),v(we,{ref:M,renderless:!0,items:y.value,itemKey:"value"},{default:c=>{var j;let{item:d,index:C,itemRef:h}=c;const H=w(d.props,{ref:h,key:d.value,active:L.value&&C===0?!0:void 0,onClick:()=>x(d,null)});return((j=n.item)==null?void 0:j.call(n,{item:d,index:C,props:H}))??v(J,w(H,{role:"option"}),{prepend:I=>{let{isSelected:ke}=I;return v(U,null,[l.multiple&&!l.hideSelected?v(Ge,{key:d.value,modelValue:ke,ripple:!1,tabindex:"-1"},null):void 0,d.props.prependAvatar&&v(Ue,{image:d.props.prependAvatar},null),d.props.prependIcon&&v(G,{icon:d.props.prependIcon},null)])},title:()=>{var I;return k.value?d.title:Se("v-autocomplete",d.title,(I=oe(d))==null?void 0:I.title)}})}}),(m=n["append-item"])==null?void 0:m.call(n)]}})]}),u.value.map((a,s)=>{function m(h){h.stopPropagation(),h.preventDefault(),x(a,!1)}const c={"onClick:close":m,onKeydown(h){h.key!=="Enter"&&h.key!==" "||(h.preventDefault(),h.stopPropagation(),m(h))},onMousedown(h){h.preventDefault(),h.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},d=A.value?!!n.chip:!!n.selection,C=d?ze(A.value?n.chip({item:a,index:s,props:c}):n.selection({item:a,index:s})):void 0;if(!(d&&!C))return v("div",{key:a.value,class:["v-autocomplete__selection",s===o.value&&["v-autocomplete__selection--selected",ae.value]],style:s===o.value?ue.value:{}},[A.value?n.chip?v($e,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:a.title}}},{default:()=>[C]}):v(Fe,w({key:"chip",closable:l.closableChips,size:"small",text:a.title,disabled:a.props.disabled},c),null):C??v("span",{class:"v-autocomplete__selection-text"},[a.title,l.multiple&&s<u.value.length-1&&v("span",{class:"v-autocomplete__selection-comma"},[qe(",")])])])})]),"append-inner":function(){var c;for(var a=arguments.length,s=new Array(a),m=0;m<a;m++)s[m]=arguments[m];return v(U,null,[(c=n["append-inner"])==null?void 0:c.call(n,...s),l.menuIcon?v(G,{class:"v-autocomplete__menu-icon",icon:l.menuIcon,onMousedown:ve,onClick:Ne,"aria-label":R($.value),title:R($.value),tabindex:"-1"},null):void 0])}})}),Pe({isFocused:V,isPristine:k,menu:r,search:f,filteredItems:_,select:x},p)}});export{tl as V};
//# sourceMappingURL=VAutocomplete-BTC31r0s.js.map
