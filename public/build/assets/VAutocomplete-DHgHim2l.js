import{f as be,g as ke,h as Ce,i as we,j as xe,k as Se,l as Fe,n as Ie,o as Ae}from"./filter-HBd77JfG.js";import{V as $,f as De}from"./VTextField-B0vtNHdP.js";import{g as Pe,p as Re,j as Me,r as P,q as S,b0 as Ee,u as Le,D as O,b1 as Te,c as V,w as R,J as j,ar as _e,a as Be,b as d,d as k,a2 as H,b2 as Ne,F as U,m as y,b3 as Ke,b4 as J,aw as Oe,b5 as Ue,ay as ze,b6 as qe,n as $e,e as je,as as He,a4 as Je,b7 as We,o as Ge,b8 as W,b9 as Qe,ba as G}from"./app-D-yat15h.js";import{a as Xe,f as Ye}from"./VInput-DeaR9ABf.js";import{V as Ze}from"./VCheckboxBtn-B9CfyC32.js";const el=Re({autoSelectFirst:{type:[Boolean,String]},clearOnSelect:Boolean,search:String,...Ae({filterKeys:["title"]}),...Ie(),...Ge(De({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...We({transition:!1})},"VAutocomplete"),ol=Pe()({name:"VAutocomplete",props:el(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,Q){let{slots:s}=Q;const{t:X}=Me(),m=P(),p=S(!1),g=S(!0),M=S(!1),z=P(),E=P(),o=S(-1),{items:L,transformIn:Y,transformOut:Z}=Ee(l),{textColorClasses:ee,textColorStyles:le}=Le(()=>m.value?.color),c=O(l,"search",""),u=O(l,"modelValue",[],e=>Y(e===null?[null]:Te(e)),e=>{const n=Z(e);return l.multiple?n:n[0]??null}),ae=V(()=>typeof l.counterValue=="function"?l.counterValue(u.value):typeof l.counterValue=="number"?l.counterValue:u.value.length),F=Xe(l),{filteredItems:T,getMatches:te}=be(l,L,()=>g.value?"":c.value),h=V(()=>l.hideSelected?T.value.filter(e=>!u.value.some(n=>n.value===e.value)):T.value),I=V(()=>!!(l.chips||s.chip)),C=V(()=>I.value||!!s.selection),ue=V(()=>u.value.map(e=>e.props.value)),_=V(()=>(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&c.value===h.value[0]?.title)&&h.value.length>0&&!g.value&&!M.value),A=V(()=>l.hideNoData&&!h.value.length||F.isReadonly.value||F.isDisabled.value),B=O(l,"menu"),i=V({get:()=>B.value,set:e=>{B.value&&!e&&z.value?.Î¨openChildren.size||e&&A.value||(B.value=e)}}),{menuId:ne,ariaExpanded:oe,ariaControls:se,ariaLabel:q}=ke(l,i),N=P(),ie=Ce(N,m);function re(e){l.openOnClear&&(i.value=!0),c.value=""}function ce(){A.value||(i.value=!0)}function ve(e){A.value||(p.value&&(e.preventDefault(),e.stopPropagation()),i.value=!i.value)}function de(e){(W(e)||e.key==="Backspace")&&m.value?.focus()}function fe(e){if(F.isReadonly.value)return;const n=m.value?.selectionStart,r=u.value.length;if(["Enter","ArrowDown","ArrowUp"].includes(e.key)&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(i.value=!0),["Escape"].includes(e.key)&&(i.value=!1),_.value&&["Enter","Tab"].includes(e.key)&&!u.value.some(t=>{let{value:a}=t;return a===h.value[0].value})&&b(h.value[0]),e.key==="ArrowDown"&&_.value&&N.value?.focus("next"),["Backspace","Delete"].includes(e.key)){if(!l.multiple&&C.value&&u.value.length>0&&!c.value)return b(u.value[0],!1);if(~o.value){e.preventDefault();const t=o.value;b(u.value[o.value],!1),o.value=t>=r-1?r-2:t}else e.key==="Backspace"&&!c.value&&(o.value=r-1);return}if(l.multiple)if(e.key==="ArrowLeft"){if(o.value<0&&n&&n>0)return;const t=o.value>-1?o.value-1:r-1;if(u.value[t])o.value=t;else{const a=c.value?.length??null;o.value=-1,m.value?.setSelectionRange(a,a)}}else if(e.key==="ArrowRight"){if(o.value<0)return;const t=o.value+1;u.value[t]?o.value=t:(o.value=-1,m.value?.setSelectionRange(0,0))}else~o.value&&W(e)&&(o.value=-1)}function me(e){if(G(m.value,":autofill")||G(m.value,":-webkit-autofill")){const n=L.value.find(r=>r.title===e.target.value);n&&b(n)}}function pe(){l.eager&&E.value?.calculateVisibleItems()}function he(){p.value&&(g.value=!0,m.value?.focus())}function ge(e){p.value=!0,setTimeout(()=>{M.value=!0})}function Ve(e){M.value=!1}function ye(e){(e==null||e===""&&!l.multiple&&!C.value)&&(u.value=[])}const K=S(!1);function b(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!(!e||e.props.disabled))if(l.multiple){const r=u.value.findIndex(a=>(l.valueComparator||Qe)(a.value,e.value)),t=n??!~r;if(~r){const a=t?[...u.value,e]:[...u.value];a.splice(r,1),u.value=a}else t&&(u.value=[...u.value,e]);l.clearOnSelect&&(c.value="")}else{const r=n!==!1;u.value=r?[e]:[],c.value=r&&!C.value?e.title:"",j(()=>{i.value=!1,g.value=!0})}}return R(p,(e,n)=>{e!==n&&(e?(K.value=!0,c.value=l.multiple||C.value?"":String(u.value.at(-1)?.props.title??""),g.value=!0,j(()=>K.value=!1)):(!l.multiple&&c.value==null&&(u.value=[]),i.value=!1,c.value="",o.value=-1))}),R(c,e=>{!p.value||K.value||(e&&(i.value=!0),g.value=!e)}),R(i,()=>{if(!l.hideSelected&&i.value&&u.value.length){const e=h.value.findIndex(n=>u.value.some(r=>n.value===r.value));_e&&window.requestAnimationFrame(()=>{e>=0&&E.value?.scrollToIndex(e)})}}),R(L,(e,n)=>{i.value||p.value&&!n.length&&e.length&&(i.value=!0)}),Be(()=>{const e=!!(!l.hideNoData||h.value.length||s["prepend-item"]||s["append-item"]||s["no-data"]),n=u.value.length>0,r=$.filterProps(l);return d($,y({ref:m},r,{modelValue:c.value,"onUpdate:modelValue":[t=>c.value=t,ye],focused:p.value,"onUpdate:focused":t=>p.value=t,validationValue:u.externalValue,counterValue:ae.value,dirty:n,onChange:me,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":i.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!C.value,"v-autocomplete--selecting-index":o.value>-1},l.class],style:l.style,readonly:F.isReadonly.value,placeholder:n?void 0:l.placeholder,"onClick:clear":re,"onMousedown:control":ce,onKeydown:fe,"aria-expanded":oe.value,"aria-controls":se.value}),{...s,default:()=>k(U,null,[d(we,y({id:ne.value,ref:z,modelValue:i.value,"onUpdate:modelValue":t=>i.value=t,activator:"parent",contentClass:"v-autocomplete__content",disabled:A.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterEnter:pe,onAfterLeave:he},l.menuProps),{default:()=>[e&&d(Ke,y({ref:N,filterable:!0,selected:ue.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:t=>t.preventDefault(),onKeydown:de,onFocusin:ge,onFocusout:Ve,tabindex:"-1",selectable:!0,"aria-live":"polite",color:l.itemColor??l.color},ie,l.listProps),{default:()=>[s["prepend-item"]?.(),!h.value.length&&!l.hideNoData&&(s["no-data"]?.()??d(J,{key:"no-data",title:X(l.noDataText)},null)),d(xe,{ref:E,renderless:!0,items:h.value,itemKey:"value"},{default:t=>{let{item:a,index:v,itemRef:D}=t;const w=y(a.props,{ref:D,key:a.value,active:_.value&&v===0?!0:void 0,onClick:()=>b(a,null)});return a.type==="divider"?s.divider?.({props:a.raw,index:v})??d(Oe,y(a.props,{key:`divider-${v}`}),null):a.type==="subheader"?s.subheader?.({props:a.raw,index:v})??d(Ue,y(a.props,{key:`subheader-${v}`}),null):s.item?.({item:a,index:v,props:w})??d(J,y(w,{role:"option"}),{prepend:x=>{let{isSelected:f}=x;return k(U,null,[l.multiple&&!l.hideSelected?d(Ze,{key:a.value,modelValue:f,ripple:!1,tabindex:"-1"},null):void 0,a.props.prependAvatar&&d(ze,{image:a.props.prependAvatar},null),a.props.prependIcon&&d(H,{icon:a.props.prependIcon},null)])},title:()=>g.value?a.title:Se("v-autocomplete",a.title,te(a)?.title)})}}),s["append-item"]?.()]})]}),u.value.map((t,a)=>{function v(f){f.stopPropagation(),f.preventDefault(),b(t,!1)}const D={"onClick:close":v,onKeydown(f){f.key!=="Enter"&&f.key!==" "||(f.preventDefault(),f.stopPropagation(),v(f))},onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},w=I.value?!!s.chip:!!s.selection,x=w?qe(I.value?s.chip({item:t,index:a,props:D}):s.selection({item:t,index:a})):void 0;if(!(w&&!x))return k("div",{key:t.value,class:je(["v-autocomplete__selection",a===o.value&&["v-autocomplete__selection--selected",ee.value]]),style:$e(a===o.value?le.value:{})},[I.value?s.chip?d(He,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:t.title}}},{default:()=>[x]}):d(Fe,y({key:"chip",closable:l.closableChips,size:"small",text:t.title,disabled:t.props.disabled},D),null):x??k("span",{class:"v-autocomplete__selection-text"},[t.title,l.multiple&&a<u.value.length-1&&k("span",{class:"v-autocomplete__selection-comma"},[Je(",")])])])})]),"append-inner":function(){for(var t=arguments.length,a=new Array(t),v=0;v<t;v++)a[v]=arguments[v];return k(U,null,[s["append-inner"]?.(...a),l.menuIcon?d(H,{class:"v-autocomplete__menu-icon",color:m.value?.fieldIconColor,icon:l.menuIcon,onMousedown:ve,onClick:Ne,"aria-label":q.value,title:q.value,tabindex:"-1"},null):void 0])}})}),Ye({isFocused:p,isPristine:g,menu:i,search:c,filteredItems:T,select:b},m)}});export{ol as V};
//# sourceMappingURL=VAutocomplete-DHgHim2l.js.map
