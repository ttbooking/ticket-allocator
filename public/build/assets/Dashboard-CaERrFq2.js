import{T as Ee}from"./TransitionGroup-0Kr3fTnN.js";import{r as U,g as Q,p as ee,u as tt,a as Pe,c as u,b as te,V as M,d as r,e as l,n as we,f as F,F as j,m as K,o as Me,h as nt,s as at,k as Ae,i as ot,j as lt,l as st,q as it,t as ye,w as De,I as $e,v as Oe,x as rt,y as Y,z as We,A as J,P as ut,B as ct,C as Le,D as Ue,E as Ye,G as He,H as dt,J as vt,K as ft,M as mt,L as ht,N as gt,O as yt,Q as kt,R as bt,S as pt,T as wt,U as re,W as _t,X as Tt,Y as Se,Z as ae,_ as I,$ as p,a0 as m,a1 as E,a2 as G,a3 as Ne,a4 as v,a5 as B,a6 as b,a7 as ie,a8 as ue,a9 as le,aa as Xe,ab as xt,ac as fe,ad as Z,ae as z,af as ke,ag as Vt,ah as Ct,ai as ge,aj as $t,ak as St,al as It,am as Bt}from"./app-Db0BbPZb.js";import{u as q,i as Rt,M as Et,a as Pt,b as je,c as Fe,d as Mt,e as At,T as Ge,f as Dt,g as Ot,h as Wt,C as Lt,O as H,j as N,V as Ut,k as Yt,l as Ht,m as Nt,n as Xt}from"./VSwitch-BoycoiM4.js";import{g as jt,u as Ft,m as Gt,V as Ie,a as zt,b as Zt}from"./filter-Cc7CwZxq.js";import{V as qt,a as Kt}from"./VCard-CyVmyr1e.js";import{f as Jt}from"./VInput-WkCVmGLb.js";import{a as Qt,V as en}from"./VTextField-B7jK2Pg8.js";import{V as tn}from"./VContainer-Djy34Aod.js";import{V as Be,a as oe}from"./VRow-nr7W8gg1.js";import{V as Re}from"./VAutocomplete-BE1T7EjJ.js";import{V as nn}from"./VTable-CuWOpfO2.js";import"./VSelectionControl-BPHKJf82.js";import"./VCheckboxBtn-CS_lsY_4.js";/* empty css              */function an(e,t){const n=U();return q(e,"dragstart",a=>{if(n.value=a.target,typeof t=="string"){const o=t;t=(i,s)=>{s?.setData("text/plain",i.dataset[o]??"")}}t?.(n.value,a.dataTransfer)}),q(e,"dragend",()=>{n.value=null}),{element:n}}function ze(e,t,n=!0){const a=U(!1);let o=0;return Rt&&(q(e,"dragenter",i=>{i.preventDefault(),o++,a.value=!0}),q(e,"dragover",i=>{i.preventDefault()}),q(e,"dragleave",i=>{i.preventDefault(),o--,o===0&&(a.value=!1)}),q(e,"drop",i=>{if(i.preventDefault(),o=0,a.value=!1,t)if(n){const s=Array.from(i.dataTransfer?.files??[]);t(s.length===0?null:s)}else t(i.dataTransfer)})),{isOverDropZone:a}}const _e=Symbol.for("vuetify:v-tabs"),Ze=ee({fixed:Boolean,sliderColor:String,sliderTransition:String,sliderTransitionDuration:[String,Number],hideSlider:Boolean,inset:Boolean,direction:{type:String,default:"horizontal"},...Me(nt({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),me=Q()({name:"VTab",props:Ze(),setup(e,t){let{slots:n,attrs:a}=t;const{textColorClasses:o,textColorStyles:i}=tt(()=>e.sliderColor),{backgroundColorClasses:s,backgroundColorStyles:w}=Pe(()=>e.sliderColor),h=U(),g=U(),f=u(()=>e.direction==="horizontal"),x=u(()=>h.value?.group?.isSelected.value??!1);function k(R,P){return{opacity:[0,1]}}function A(R,P){return e.direction==="vertical"?{transform:["scaleY(0)","scaleY(1)"]}:{transform:["scaleX(0)","scaleX(1)"]}}function V(R,P){const C=P.getBoundingClientRect(),$=R.getBoundingClientRect(),T=f.value?"x":"y",d=f.value?"X":"Y",c=f.value?"right":"bottom",y=f.value?"width":"height",S=C[T],O=$[T],W=S>O?C[c]-$[c]:C[T]-$[T],ce=Math.sign(W)>0?f.value?"right":"bottom":Math.sign(W)<0?f.value?"left":"top":"center",he=(Math.abs(W)+(Math.sign(W)<0?C[y]:$[y]))/Math.max(C[y],$[y])||0,ne=C[y]/$[y]||0,de=1.5;return{transform:[`translate${d}(${W}px) scale${d}(${ne})`,`translate${d}(${W/de}px) scale${d}(${(he-1)/de+1})`,"none"],transformOrigin:Array(3).fill(ce)}}function D(R){let{value:P}=R;if(P){const C=h.value?.$el.parentElement?.querySelector(".v-tab--selected .v-tab__slider"),$=g.value;if(!C||!$)return;const T=getComputedStyle(C).color,d={fade:k,grow:A,shift:V}[e.sliderTransition??"shift"]??V,c=Number(e.sliderTransitionDuration)||({fade:400,grow:350,shift:225}[e.sliderTransition??"shift"]??225);Qt($,{backgroundColor:[T,"currentcolor"],...d($,C)},{duration:c,easing:at})}}return te(()=>{const R=M.filterProps(e);return r(M,K({symbol:_e,ref:h,class:["v-tab",e.class,x.value&&e.inset?s.value:[]],style:[e.style,x.value&&e.inset?w.value:[]],tabindex:x.value?0:-1,role:"tab","aria-selected":String(x.value),active:!1},R,a,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":D}),{...n,default:()=>l(j,null,[n.default?.()??e.text,!e.hideSlider&&l("div",{ref:g,class:F(["v-tab__slider",o.value]),style:we(i.value)},null)])})}),Jt({},h)}}),on=e=>{const{touchstartX:t,touchendX:n,touchstartY:a,touchendY:o}=e,i=.5,s=16;e.offsetX=n-t,e.offsetY=o-a,Math.abs(e.offsetY)<i*Math.abs(e.offsetX)&&(e.left&&n<t-s&&e.left(e),e.right&&n>t+s&&e.right(e)),Math.abs(e.offsetX)<i*Math.abs(e.offsetY)&&(e.up&&o<a-s&&e.up(e),e.down&&o>a+s&&e.down(e))};function ln(e,t){const n=e.changedTouches[0];t.touchstartX=n.clientX,t.touchstartY=n.clientY,t.start?.({originalEvent:e,...t})}function sn(e,t){const n=e.changedTouches[0];t.touchendX=n.clientX,t.touchendY=n.clientY,t.end?.({originalEvent:e,...t}),on(t)}function rn(e,t){const n=e.changedTouches[0];t.touchmoveX=n.clientX,t.touchmoveY=n.clientY,t.move?.({originalEvent:e,...t})}function un(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:n=>ln(n,t),touchend:n=>sn(n,t),touchmove:n=>rn(n,t)}}function cn(e,t){const n=t.value,a=n?.parent?e.parentElement:e,o=n?.options??{passive:!0},i=t.instance?.$.uid;if(!a||i===void 0)return;const s=un(t.value);a._touchHandlers=a._touchHandlers??Object.create(null),a._touchHandlers[i]=s,Ae(s).forEach(w=>{a.addEventListener(w,s[w],o)})}function dn(e,t){const n=t.value?.parent?e.parentElement:e,a=t.instance?.$.uid;if(!n?._touchHandlers||a===void 0)return;const o=n._touchHandlers[a];Ae(o).forEach(i=>{n.removeEventListener(i,o[i])}),delete n._touchHandlers[a]}const be={mounted:cn,unmounted:dn},qe=Symbol.for("vuetify:v-window"),Ke=Symbol.for("vuetify:v-window-group"),Je=ee({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},verticalArrows:[Boolean,String],touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},crossfade:Boolean,transitionDuration:Number,...Ue(),...Le(),...ct()},"VWindow"),pe=Q()({name:"VWindow",directives:{vTouch:be},props:Je(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const{themeClasses:a}=ot(e),{isRtl:o}=lt(),{t:i}=st(),s=it(e,Ke),w=U(),h=u(()=>o.value?!e.reverse:e.reverse),g=ye(!1),f=u(()=>{if(e.crossfade)return"v-window-crossfade-transition";const T=e.direction==="vertical"?"y":"x",c=(h.value?!g.value:g.value)?"-reverse":"";return`v-window-${T}${c}-transition`}),x=ye(0),k=U(void 0),A=u(()=>s.items.value.findIndex(T=>s.selected.value.includes(T.id)));De(A,(T,d)=>{let c;const y={left:0,top:0};$e&&d>=0&&(c=jt(w.value),y.left=c?.scrollLeft,y.top=c?.scrollTop);const S=s.items.value.length,O=S-1;S<=2?g.value=T<d:T===O&&d===0?g.value=!1:T===0&&d===O?g.value=!0:g.value=T<d,Oe(()=>{if(!$e||!c)return;c.scrollTop!==y.top&&c.scrollTo({...y,behavior:"instant"}),requestAnimationFrame(()=>{if(!c)return;c.scrollTop!==y.top&&c.scrollTo({...y,behavior:"instant"})})})},{flush:"sync"}),rt(qe,{transition:f,isReversed:g,transitionCount:x,transitionHeight:k,rootRef:w});const V=Y(()=>e.continuous||A.value!==0),D=Y(()=>e.continuous||A.value!==s.items.value.length-1);function R(){V.value&&s.prev()}function P(){D.value&&s.next()}const C=u(()=>{const T=[],d={icon:o.value?e.nextIcon:e.prevIcon,class:`v-window__${h.value?"right":"left"}`,onClick:s.prev,"aria-label":i("$vuetify.carousel.prev")};T.push(V.value?n.prev?n.prev({props:d}):r(M,d,null):l("div",null,null));const c={icon:o.value?e.prevIcon:e.nextIcon,class:`v-window__${h.value?"left":"right"}`,onClick:s.next,"aria-label":i("$vuetify.carousel.next")};return T.push(D.value?n.next?n.next({props:c}):r(M,c,null):l("div",null,null)),T}),$=u(()=>e.touch===!1?e.touch:{...{left:()=>{h.value?R():P()},right:()=>{h.value?P():R()},start:d=>{let{originalEvent:c}=d;c.stopPropagation()}},...e.touch===!0?{}:e.touch});return te(()=>We(r(e.tag,{ref:w,class:F(["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover","v-window--vertical-arrows":!!e.verticalArrows,"v-window--crossfade":!!e.crossfade},a.value,e.class]),style:we([e.style,{"--v-window-transition-duration":ut()?null:J(e.transitionDuration,"ms")}])},{default:()=>[l("div",{class:"v-window__container",style:{height:k.value}},[n.default?.({group:s}),e.showArrows!==!1&&l("div",{class:F(["v-window__controls",{"v-window__controls--left":e.verticalArrows==="left"||e.verticalArrows===!0},{"v-window__controls--right":e.verticalArrows==="right"}])},[C.value])]),n.additional?.({group:s})]}),[[be,$.value]])),{group:s}}}),vn=ee({...Me(Je(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),fn=Q()({name:"VTabsWindow",props:vn(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;const a=Ye(_e,null),o=He(e,"modelValue"),i=u({get(){return o.value!=null||!a?o.value:a.items.value.find(s=>a.selected.value.includes(s.id))?.value},set(s){o.value=s}});return te(()=>{const s=pe.filterProps(e);return r(pe,K({_as:"VTabsWindow"},s,{modelValue:i.value,"onUpdate:modelValue":w=>i.value=w,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),n)}),{}}}),Qe=ee({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ue(),...ht(),...Gt()},"VWindowItem"),se=Q()({name:"VWindowItem",directives:{vTouch:be},props:Qe(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const a=Ye(qe),o=dt(e,Ke),{isBooted:i}=vt();if(!a||!o)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const s=ye(!1),w=u(()=>i.value&&(a.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function h(){!s.value||!a||(s.value=!1,a.transitionCount.value>0&&(a.transitionCount.value-=1,a.transitionCount.value===0&&(a.transitionHeight.value=void 0)))}function g(){s.value||!a||(s.value=!0,a.transitionCount.value===0&&(a.transitionHeight.value=J(a.rootRef.value?.clientHeight)),a.transitionCount.value+=1)}function f(){h()}function x(V){s.value&&Oe(()=>{!w.value||!s.value||!a||(a.transitionHeight.value=J(V.clientHeight))})}const k=u(()=>{const V=a.isReversed.value?e.reverseTransition:e.transition;return w.value?{name:typeof V!="string"?a.transition.value:V,onBeforeEnter:g,onAfterEnter:h,onEnterCancelled:f,onBeforeLeave:g,onAfterLeave:h,onLeaveCancelled:f,onEnter:x}:!1}),{hasContent:A}=Ft(e,o.isSelected);return te(()=>r(mt,{transition:k.value,disabled:!i.value},{default:()=>[We(l("div",{class:F(["v-window-item",o.selectedClass.value,e.class]),style:we(e.style)},[A.value&&n.default?.()]),[[ft,o.isSelected.value]])]})),{groupItem:o}}}),mn=ee({...Qe()},"VTabsWindowItem"),hn=Q()({name:"VTabsWindowItem",props:mn(),setup(e,t){let{slots:n}=t;return te(()=>{const a=se.filterProps(e);return r(se,K({_as:"VTabsWindowItem"},a,{class:["v-tabs-window-item",e.class],style:e.style}),n)}),{}}});function gn(e){return e?e.map(t=>wt(t)?t:{text:t,value:t}):[]}const yn=ee({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,inset:Boolean,insetPadding:[String,Number],insetRadius:[String,Number],sliderColor:String,...pt(Ze(),["spaced","sliderTransition","sliderTransitionDuration"]),...zt({mandatory:"force",selectedClass:"v-tab-item--selected"}),...bt(),...Le()},"VTabs"),kn=Q()({name:"VTabs",props:yn(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:n,slots:a}=t;const o=He(e,"modelValue"),i=u(()=>gn(e.items)),{densityClasses:s}=gt(e),{backgroundColorClasses:w,backgroundColorStyles:h}=Pe(()=>e.bgColor),{scopeId:g}=yt();return kt({VTab:{color:Y(e,"color"),direction:Y(e,"direction"),stacked:Y(e,"stacked"),fixed:Y(e,"fixedTabs"),inset:Y(e,"inset"),sliderColor:Y(e,"sliderColor"),sliderTransition:Y(e,"sliderTransition"),sliderTransitionDuration:Y(e,"sliderTransitionDuration"),hideSlider:Y(e,"hideSlider")}}),te(()=>{const f=Ie.filterProps(e),x=!!(a.window||e.items.length>0);return l(j,null,[r(Ie,K(f,{modelValue:o.value,"onUpdate:modelValue":k=>o.value=k,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--inset":e.inset,"v-tabs--stacked":e.stacked},s.value,w.value,e.class],style:[{"--v-tabs-height":J(e.height),"--v-tabs-inset-padding":e.inset?J(e.insetPadding):void 0,"--v-tabs-inset-radius":e.inset?J(e.insetRadius):void 0},h.value,e.style],role:"tablist",symbol:_e},g,n),{default:a.default??(()=>i.value.map(k=>a.tab?.({item:k})??r(me,K(k,{key:k.text,value:k.value,spaced:e.spaced}),{default:a[`tab.${k.value}`]?()=>a[`tab.${k.value}`]?.({item:k}):void 0}))),prev:a.prev,next:a.next}),x&&r(fn,K({modelValue:o.value,"onUpdate:modelValue":k=>o.value=k,key:"tabs-window"},g),{default:()=>[i.value.map(k=>a.item?.({item:k})??r(hn,{value:k.value},{default:()=>a[`item.${k.value}`]?.({item:k})})),a.window?.()]})])}),{}}}),bn={class:"d-inline-block"},pn={class:"overflow-hidden text-white"},wn={class:"title relative inline-block"},_n=["innerHTML"],Tn={key:1},xn=["innerHTML"],Vn={key:0},Cn={key:1},$n={key:2},Sn={key:3},In={class:"table-fixed"},Bn={class:"w-1/3"},Rn={class:"text-center"},En=["title"],Pn={class:"text-center"},Mn=["title"],An={class:"text-center"},Dn=["title"],On={class:"text-center"},Wn=["title"],Ln={class:"text-center"},Un=["title"],Yn={class:"text-right"},Hn={class:"text-right"},Nn={class:"text-right"},Xn={class:"text-right"},jn={class:"text-right"},Fn={class:"text-right"},Gn={class:"text-right"},zn={class:"text-right"},Zn={class:"text-right"},qn={class:"text-right"},Kn=re({__name:"Ticket",props:{ticket:{}},setup(e){_t(_=>({v0c560d15:Ce.value.delay,v2b070e7c:Ce.value.duration}));const t=e,{t:n}=Tt(),a=u(()=>Se().props.factors),o=U(null),i=new Et({linkify:!0}).use(Pt),s=je(),w=Fe(),h=u(()=>Se().props.options),g=u(()=>ae(t.ticket.created_at)),f=u(()=>ae.duration(t.ticket.delay,"s")),x=u(()=>g.value.add(f.value)),k=u(()=>t.ticket.bound_at?ae(t.ticket.bound_at):null),A=u(()=>t.ticket.reservation?ae.duration(t.ticket.reservation,"s"):null),V=u(()=>k.value&&A.value?k.value.add(A.value):null),D=u(()=>t.ticket.accepted_at?ae(t.ticket.accepted_at):null),R=u(()=>`${g.value.format("lll")} (${g.value.fromNow()})`),P=u(()=>`${x.value.format("lll")} (${n("time_left",{time:x.value.fromNow(!0)})})`),C=u(()=>k.value?`${k.value.format("lll")} (${k.value.fromNow()})`:null),$=u(()=>V.value?`${V.value.format("lll")} (${n("time_left",{time:V.value.fromNow(!0)})})`:null),T=u(()=>D.value?`${D.value.format("lll")} (${D.value.fromNow()})`:null),d=u(()=>`${S(t.ticket.weight)} (${n("increment_per_second",{units:t.ticket.weight_increment.toString()})})`),c=u(()=>h.value[`${w.value}_threshold`]),y=u(()=>t.ticket[w.value]),S=_=>_<1e5?_:_.toExponential(1),O=()=>t.ticket.meta?.category_name??t.ticket.category?.name??"",W=()=>t.ticket.meta?.category_short??t.ticket.category?.short??"",ce=()=>s.altInfo?t.ticket.meta?.title??W():W(),Ve=u(()=>t.ticket.meta?.card_title??"Title"),he=u(()=>t.ticket.meta?.card_subtitle??O()),ne=u(()=>t.ticket.meta?.card_content??[]),de=u(()=>y.value>c.value),Ce=u(()=>({delay:-y.value+"s",duration:c.value+"s"}));return(_,X)=>(p(),I("div",bn,[r(M,{size:"small",class:F(["ticket justify-start px-2",{overflow:de.value}]),ripple:!1,flat:"",width:"100"},{default:m(()=>[e.ticket.meta?.icon?(p(),E(Ne,{key:0,icon:e.ticket.meta?.icon??"",color:"white"},null,8,["icon"])):G("",!0),l("span",pn,[l("span",wn,v(ce()),1)]),r(Zt,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:m(()=>[r(qt,{width:"500","prepend-icon":e.ticket.meta?.icon??"",title:Ve.value,subtitle:he.value},{default:m(()=>[r(kn,{modelValue:o.value,"onUpdate:modelValue":X[0]||(X[0]=L=>o.value=L)},{default:m(()=>[r(me,{value:"properties"},{default:m(()=>[B(v(_.$t("properties")),1)]),_:1}),r(me,{value:"metrics"},{default:m(()=>[B(v(_.$t("metrics")),1)]),_:1}),r(me,{value:"details"},{default:m(()=>[B(v(_.$t("details")),1)]),_:1})]),_:1},8,["modelValue"]),r(Kt,null,{default:m(()=>[r(pe,{modelValue:o.value,"onUpdate:modelValue":X[1]||(X[1]=L=>o.value=L)},{default:m(()=>[r(se,{value:"properties",class:"prose"},{default:m(()=>[typeof ne.value=="string"?(p(),I("div",{key:0,innerHTML:b(i).render(ne.value)},null,8,_n)):(p(),I("table",Tn,[l("tbody",null,[(p(!0),I(j,null,ie(ne.value,([L,ve])=>(p(),I("tr",{key:L},[l("th",null,v(L),1),l("td",{innerHTML:b(i).renderInline(ve)},null,8,xn)]))),128))])]))]),_:1}),r(se,{value:"metrics",class:"prose"},{default:m(()=>[l("table",null,[l("tbody",null,[l("tr",null,[l("th",null,v(_.$t("issued_on")),1),l("td",null,v(R.value),1)]),x.value.isAfter(_.$dayjs())?(p(),I("tr",Vn,[l("th",null,v(_.$t("delayed_until")),1),l("td",null,v(P.value),1)])):G("",!0),k.value?(p(),I("tr",Cn,[l("th",null,v(_.$t("bound_at")),1),l("td",null,v(C.value),1)])):G("",!0),V.value&&V.value.isAfter(_.$dayjs())?(p(),I("tr",$n,[l("th",null,v(_.$t("reserved_until")),1),l("td",null,v($.value),1)])):G("",!0),D.value?(p(),I("tr",Sn,[l("th",null,v(_.$t("accepted_at")),1),l("td",null,v(T.value),1)])):G("",!0),l("tr",null,[l("th",null,v(_.$t("current_weight")),1),l("td",null,v(d.value),1)]),l("tr",null,[l("th",null,v(_.$t("complexity")),1),l("td",null,v(e.ticket.complexity+" "+b(n)("units")),1)])])])]),_:1}),r(se,{value:"details",class:"prose"},{default:m(()=>[l("table",In,[l("thead",null,[l("tr",null,[l("th",Bn,v(_.$t("factor")),1),l("th",Rn,[l("em",{class:"metric",title:_.$t("initial_weight")},[...X[2]||(X[2]=[B("W",-1),l("sub",null,"0",-1)])],8,En)]),l("th",Pn,[l("em",{class:"metric",title:_.$t("weight_increment")},[...X[3]||(X[3]=[B("W",-1),l("sub",null,"i",-1)])],8,Mn)]),l("th",An,[l("em",{class:"metric",title:_.$t("complexity")},"C",8,Dn)]),l("th",On,[l("em",{class:"metric",title:_.$t("delay_sec")},"D",8,Wn)]),l("th",Ln,[l("em",{class:"metric",title:_.$t("reservation_sec")},"R",8,Un)])])]),l("tbody",null,[(p(!0),I(j,null,ie(e.ticket.metrics??{},(L,ve)=>(p(),I("tr",{key:ve},[l("th",null,v(a.value[ve]?.name??_.$t("unknown")),1),l("td",Yn,v(L.initial_weight??0),1),l("td",Hn,v(L.weight_increment??0),1),l("td",Nn,v(L.complexity??0),1),l("td",Xn,v(L.delay??0),1),l("td",jn,v(L.reservation??0),1)]))),128))]),l("tfoot",null,[l("tr",null,[l("th",null,v(_.$t("total")),1),l("td",Fn,v(e.ticket.initial_weight),1),l("td",Gn,v(e.ticket.weight_increment),1),l("td",zn,v(e.ticket.complexity),1),l("td",Zn,v(e.ticket.delay),1),l("td",qn,v(e.ticket.reservation),1)])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["prepend-icon","title","subtitle"])]),_:1})]),_:1},8,["class"])]))}}),Jn=ue(Kn,[["__scopeId","data-v-8c1a37e4"]]),Qn=re({__name:"TicketPool",props:{tickets:{}},setup(e){const t=U(null);an(t,"uuid");const{lock:n,unlock:a,element:o,triggerElement:i}=At(t),{x:s}=Mt({type:"movement"});u(()=>le(Ge)),De([o,s],([h,g])=>{!h||!i.value||i.value.dataset.uuid});const w=U(!1);return Xe(()=>{setTimeout(()=>w.value=!0,500)}),(h,g)=>(p(),E(b(Ee),{ref_key:"ticketPool",ref:t,name:"ticket-pool",class:"tickets @container !pt-[1px] !pb-[3px] leading-8",css:w.value,onMouseup:b(a)},{default:m(()=>[(p(!0),I(j,null,ie(e.tickets,f=>(p(),E(Jn,{key:f.uuid,"data-uuid":f.uuid,ticket:f,draggable:"true",class:"mr-1",onMousedown:xt(b(n),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css","onMouseup"]))}}),ea=ue(Qn,[["__scopeId","data-v-1fd3da22"]]);function Te(){async function e(o,i){return await window.axios.patch(fe("ticket-allocator.operators.ready",o),{ready:i})}async function t(o,i){return await window.axios.patch(fe("ticket-allocator.tickets.weight",o),{weight_points:i})}async function n(o,i){return await window.axios.patch(fe("ticket-allocator.tickets.handler",o),{operator_uuid:i??null})}async function a(o){return await window.axios.delete(fe("ticket-allocator.tickets.close",o))}return{ready:e,weight:t,handler:n,close:a}}const ta=re({__name:"TicketRow",props:{tickets:{},pool:{type:Boolean}},setup(e){const t=e;let n=U(!1);const a=u(()=>t.pool?"th":"td"),o=u(()=>t.tickets.reduce((g,{complexity:f})=>g+f,0)),i=u(()=>n.value?"mdi-chevron-down":"mdi-chevron-up"),s=Te(),w=U(null),{isOverDropZone:h}=ze(w,async g=>{const f=g?.getData("text/plain");if(!f)throw new Error("Ticket UUID undefined.");const x=w.value?.dataset.uuid;return await s.handler(f,x)},!1);return(g,f)=>(p(),I("tr",{ref_key:"ticketRow",ref:w,class:F(["ticket-row",{dragover:b(h)}])},[(p(),E(Z(a.value),{class:"status py-1"},{default:m(()=>[z(g.$slots,"status",{},void 0,!0)]),_:3})),(p(),E(Z(a.value),{class:"name font-weight-bold !pt-[6px]"},{default:m(()=>[z(g.$slots,"name",{},void 0,!0)]),_:3})),(p(),E(Z(a.value),{class:"load !pt-[6px] text-center"},{default:m(()=>[z(g.$slots,"load",{},()=>[B(v(e.tickets.length),1)],!0),f[2]||(f[2]=B("/",-1)),z(g.$slots,"load-max",{},()=>[f[1]||(f[1]=B("∞",-1))],!0)]),_:3})),(p(),E(Z(a.value),{class:"complexity !pt-[6px] text-center"},{default:m(()=>[z(g.$slots,"complexity",{},()=>[B(v(o.value),1)],!0),f[4]||(f[4]=B("/",-1)),z(g.$slots,"complexity-max",{},()=>[f[3]||(f[3]=B("∞",-1))],!0)]),_:3})),r(ea,{tag:a.value,tickets:e.tickets,class:F({collapsed:b(n)})},null,8,["tag","tickets","class"]),(p(),E(Z(a.value),{class:"more !pt-[2px] text-center"},{default:m(()=>[r(M,{size:"x-small",variant:"tonal",icon:i.value,onClick:f[0]||(f[0]=x=>ke(n)?n.value=!b(n):n=!b(n))},null,8,["icon"])]),_:1}))],2))}}),et=ue(ta,[["__scopeId","data-v-113cb187"]]),na=re({__name:"OperatorRow",props:{operator:{}},setup(e){const t=e,n=u(()=>({online:t.operator.online,ready:t.operator.ready,busy:!!t.operator.tickets?.length,full:t.operator.ticket_limit!==null&&t.operator.tickets?.length>=t.operator.ticket_limit})),a=Te(),o=async()=>await a.ready(t.operator.uuid,!t.operator.ready);return(i,s)=>(p(),E(et,{tickets:e.operator.tickets,"data-uuid":e.operator.uuid,class:F(["operator",n.value])},{status:m(()=>[r(Ne,{icon:"mdi-account",onClick:o})]),"load-max":m(()=>[B(v(e.operator.ticket_limit??"∞"),1)]),"complexity-max":m(()=>[B(v(e.operator.complexity_limit??"∞"),1)]),name:m(()=>[B(v(e.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}}),aa=ue(na,[["__scopeId","data-v-a776c74a"]]);function oa(e,t){return e.reduce((n,a)=>(typeof a[t]=="number"&&(n+=a[t]),n),0)}function xe(e,t){return e.map(n=>Ct(n,t)).filter(n=>n)}function la(e,t){const n=xe(e,t).filter(a=>typeof a=="number");return n.length===0?0:Math.max(...n)}function sa(e,t){const n=xe(e,t).filter(a=>typeof a=="number");return n.length===0?0:Math.min(...n)}function ia(e){return e.map(t=>t[t.$getLocalKey()])}function ra(e,t){const n={},a=Array.isArray(t)?t:[t];return e.forEach(o=>{const i=a.length===1?o[a[0]]:`[${a.map(s=>o[s]).toString()}]`;n[i]=(n[i]||[]).concat(o)}),n}function ua(e,t,n){const a=[],o=[];return typeof t=="function"&&o.push(t)&&a.push("asc"),Array.isArray(t)&&t.forEach(i=>o.push(i[0])&&a.push(i[1])),o.length===0&&o.push(t),Vt(e,o,a,n)}function ca(e){return{sum:t=>oa(e,t),min:t=>sa(e,t),max:t=>la(e,t),pluck:t=>xe(e,t),groupBy:t=>ra(e,t),sortBy:(t,n="SORT_REGULAR")=>ua(e,t,n),keys:()=>ia(e)}}const da={class:"text-xl leading-tight font-semibold text-gray-800"},va={class:"align-top"},fa=re({__name:"Dashboard",props:{layout:{default:"default"},operators:{},operatorTeams:{},tickets:{},ticketCategories:{},factors:{},matchers:{}},setup(e){const t=e,n=je(),a=Fe(),o=Dt(),i=Ot(),s=u(()=>le(Yt)),w=u(()=>le(Ht)),h=u(()=>le(Ge)),g=u(()=>le(Nt)),f=Wt(Xt),x=d=>Object.entries(o.value).reduce((c,[y,S])=>{const O=d?.[y],W=O===void 0||!S.length||(typeof S=="string"?S===O.toString():S.map(String).includes(O.toString()));return c&&W},!0),k=u(()=>ca(s.value.with("teams").with("tickets",d=>{d.with("category").where("meta",x).orderBy(a.value,"desc")}).whereHas("tickets").orWhere(d=>!n.hideEmpty&&d.online).get().filter(d=>!i.value.length||d.teams.some(c=>i.value.includes(c.uuid)))).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),A=u(()=>h.value.unbound().with("category").where("meta",x).orderBy(a.value,"desc").get()),V=Te(),D=U(null),{isOverDropZone:R}=ze(D,async d=>{const c=d?.getData("text/plain");if(!c)throw new Error("Ticket UUID undefined.");return await V.close(c)},!1);Xe(()=>{f.listen(Lt.PropsInvalidated,()=>ge.reload()).listen(H.Enrolled,s.value.enroll).listen(H.Resigned,s.value.resign).listen(H.NameChanged,s.value.changeName).listen(H.Online,s.value.setOnline).listen(H.Offline,s.value.setOffline).listen(H.Ready,s.value.setReady).listen(H.NotReady,s.value.setNotReady).listen(H.TicketLimitAdjusted,s.value.adjustTicketLimit).listen(H.ComplexityLimitAdjusted,s.value.adjustComplexityLimit).listen(N.Created,h.value.create).listen(N.Closed,h.value.close).listen(N.Bound,h.value.bind).listen(N.Accepted,h.value.accept).listen(N.Unbound,h.value.unbind).listen(N.CategoryChanged,h.value.changeCategory).listen(N.MetaValueSet,h.value.setMetaValue).listen(N.MetaValuesMerged,h.value.mergeMetaValues).listen(N.MetricsAdjusted,h.value.adjustMetrics)});function P(){s.value.save(t.operators),w.value.fresh(t.operatorTeams),h.value.fresh(t.tickets),g.value.fresh(t.ticketCategories)}const C=ge.on("navigate",P),$=ge.on("success",P);$t(()=>{C(),$()});const T=d=>Object.entries(d).map(([c,y])=>({title:c,value:y}));return(d,c)=>(p(),I(j,null,[r(b(St),{title:d.$t("dashboard")},null,8,["title"]),(p(),E(Z(`${e.layout}-layout`),null,{header:m(()=>[l("h2",da,v(d.$t("dashboard")),1)]),default:m(()=>[l("div",null,[r(tn,{fluid:""},{default:m(()=>[r(Be,null,{default:m(()=>[r(oe,null,{default:m(()=>[r(It,{modelValue:b(n).all,"onUpdate:modelValue":c[0]||(c[0]=y=>b(n).all=y),variant:"plain",multiple:""},{default:m(()=>[r(M,{value:"show-filters",icon:b(n).showFilters?"mdi-filter-outline":"mdi-filter-off-outline"},null,8,["icon"]),r(M,{value:"hide-empty",icon:b(n).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),r(M,{value:"alt-info",icon:b(n).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),r(M,{value:"pin-header",icon:b(n).pinHeader?"mdi-pin-outline":"mdi-pin-off-outline"},null,8,["icon"]),r(M,{value:"unlocked",icon:b(n).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:b(n).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),b(n).unlocked?(p(),E(Bt,{key:0,variant:"plain"},{default:m(()=>[r(M,{ref_key:"closeTicket",ref:D,icon:b(R)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),r(M,{icon:"mdi-refresh"})]),_:1})):G("",!0)]),_:1}),r(oe,{cols:"2"},{default:m(()=>[r(Ut,{modelValue:b(a),"onUpdate:modelValue":c[1]||(c[1]=y=>ke(a)?a.value=y:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1}),b(n).showFilters?(p(),E(Be,{key:0},{default:m(()=>[r(oe,{cols:"2"},{default:m(()=>[r(Re,{modelValue:b(i),"onUpdate:modelValue":c[2]||(c[2]=y=>ke(i)?i.value=y:null),multiple:"",clearable:"",chips:"","closable-chips":"",label:d.$t("teams"),items:e.operatorTeams,"item-title":"name","item-value":"uuid"},null,8,["modelValue","label","items"])]),_:1}),r(oe,{cols:"2"},{default:m(()=>[r(en,{modelValue:b(o).title,"onUpdate:modelValue":c[3]||(c[3]=y=>b(o).title=y),label:d.$t("filter_title")},null,8,["modelValue","label"])]),_:1}),(p(!0),I(j,null,ie(e.matchers,(y,S)=>(p(),E(oe,{key:S,cols:"2"},{default:m(()=>[r(Re,{modelValue:b(o)[S],"onUpdate:modelValue":O=>b(o)[S]=O,multiple:"",clearable:"",chips:"","closable-chips":"",label:d.$t(S),items:T(y)},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024))),128))]),_:1})):G("",!0)]),_:1}),r(nn,{"fixed-header":b(n).pinHeader,height:"600px",density:"compact",class:"ticket-monitor"},{default:m(()=>[l("thead",va,[r(et,{pool:"",tickets:A.value},{name:m(()=>[B(v(d.$t("ticket_pool")),1)]),_:1},8,["tickets"])]),r(b(Ee),{tag:"tbody",class:"align-top",name:"operator-pool"},{default:m(()=>[(p(!0),I(j,null,ie(k.value,y=>(p(),E(aa,{key:y.uuid,operator:y},null,8,["operator"]))),128))]),_:1})]),_:1},8,["fixed-header"])])]),_:1}))],64))}}),Sa=ue(fa,[["__scopeId","data-v-488fc88f"]]);export{Sa as default};
//# sourceMappingURL=Dashboard-CaERrFq2.js.map
