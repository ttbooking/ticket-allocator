import{T as Ae}from"./TransitionGroup-6v70WuoQ.js";import{k as We,g as J,p as Q,a as tt,u as ot,b as nt,c as at,r as W,d,s as pe,w as Oe,e as lt,t as j,f as c,h as i,V as A,i as ee,j as Le,n as me,l as G,m as st,o as De,q as Ue,v as He,x as it,y as ut,z as rt,M as ct,A as dt,B as vt,C as ge,D as mt,F as N,E as q,G as Xe,H as ft,I as Ye,J as ht,K as yt,L as pt,N as gt,O as kt,P as bt,Q as se,R as _t,S as wt,T as Re,U as oe,W as S,X as _,Y as y,Z as R,_ as F,$ as je,a0 as f,a1 as I,a2 as $,a3 as le,a4 as ie,a5 as ne,a6 as Ne,a7 as Vt,a8 as ce,a9 as Z,aa as z,ab as ke,ac as $t,ad as Ct,ae as ye,af as Tt,ag as xt,ah as St,ai as It}from"./app-DNFecrm8.js";import{u as K,i as Bt,M as Rt,a as Mt,b as Fe,c as Ge,d as Et,e as Pt,T as ze,f as At,g as Wt,h as Ot,C as Lt,O as H,j as X,V as Dt,k as Ut,l as Ht,m as Xt,n as Yt}from"./OperatorRepository-Dv00zknj.js";import{u as jt,m as Nt,V as Me,a as Ft,b as Gt}from"./filter-DwKjOrH0.js";import{V as zt,a as Zt}from"./VCard-CaQuxD4Q.js";import{f as Kt,a as qt,s as Jt}from"./VTextField-BKJJmIJF.js";import{V as Qt}from"./VContainer-BYlod_Kj.js";import{V as Ee,a as de}from"./VRow-D33ZPker.js";import{V as Pe}from"./VAutocomplete-CmMjDrO0.js";import{V as eo}from"./VTable-Dv8vAkBl.js";import"./VInput-Br0m-kvz.js";import"./VSelectionControl-ko3MR-dF.js";import"./VCheckboxBtn-CeaTzGl_.js";/* empty css              */const to=e=>{const{touchstartX:t,touchendX:o,touchstartY:n,touchendY:l}=e,s=.5,a=16;e.offsetX=o-t,e.offsetY=l-n,Math.abs(e.offsetY)<s*Math.abs(e.offsetX)&&(e.left&&o<t-a&&e.left(e),e.right&&o>t+a&&e.right(e)),Math.abs(e.offsetX)<s*Math.abs(e.offsetY)&&(e.up&&l<n-a&&e.up(e),e.down&&l>n+a&&e.down(e))};function oo(e,t){var n;const o=e.changedTouches[0];t.touchstartX=o.clientX,t.touchstartY=o.clientY,(n=t.start)==null||n.call(t,{originalEvent:e,...t})}function no(e,t){var n;const o=e.changedTouches[0];t.touchendX=o.clientX,t.touchendY=o.clientY,(n=t.end)==null||n.call(t,{originalEvent:e,...t}),to(t)}function ao(e,t){var n;const o=e.changedTouches[0];t.touchmoveX=o.clientX,t.touchmoveY=o.clientY,(n=t.move)==null||n.call(t,{originalEvent:e,...t})}function lo(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:o=>oo(o,t),touchend:o=>no(o,t),touchmove:o=>ao(o,t)}}function so(e,t){var h;const o=t.value,n=o!=null&&o.parent?e.parentElement:e,l=(o==null?void 0:o.options)??{passive:!0},s=(h=t.instance)==null?void 0:h.$.uid;if(!n||!s)return;const a=lo(t.value);n._touchHandlers=n._touchHandlers??Object.create(null),n._touchHandlers[s]=a,We(a).forEach(v=>{n.addEventListener(v,a[v],l)})}function io(e,t){var s,a;const o=(s=t.value)!=null&&s.parent?e.parentElement:e,n=(a=t.instance)==null?void 0:a.$.uid;if(!(o!=null&&o._touchHandlers)||!n)return;const l=o._touchHandlers[n];We(l).forEach(h=>{o.removeEventListener(h,l[h])}),delete o._touchHandlers[n]}const be={mounted:so,unmounted:io},Ze=Symbol.for("vuetify:v-window"),Ke=Symbol.for("vuetify:v-window-group"),qe=Q({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Ue(),...De(),...st()},"VWindow"),_e=J()({name:"VWindow",directives:{vTouch:be},props:qe(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const{themeClasses:n}=tt(e),{isRtl:l}=ot(),{t:s}=nt(),a=at(e,Ke),h=W(),v=d(()=>l.value?!e.reverse:e.reverse),m=pe(!1),g=d(()=>{const C=e.direction==="vertical"?"y":"x",k=(v.value?!m.value:m.value)?"-reverse":"";return`v-window-${C}${k}-transition`}),T=pe(0),p=W(void 0),V=d(()=>a.items.value.findIndex(C=>a.selected.value.includes(C.id)));Oe(V,(C,r)=>{const k=a.items.value.length,w=k-1;k<=2?m.value=C<r:C===w&&r===0?m.value=!0:C===0&&r===w?m.value=!1:m.value=C<r}),lt(Ze,{transition:g,isReversed:m,transitionCount:T,transitionHeight:p,rootRef:h});const b=j(()=>e.continuous||V.value!==0),x=j(()=>e.continuous||V.value!==a.items.value.length-1);function D(){b.value&&a.prev()}function U(){x.value&&a.next()}const M=d(()=>{const C=[],r={icon:l.value?e.nextIcon:e.prevIcon,class:`v-window__${v.value?"right":"left"}`,onClick:a.prev,"aria-label":s("$vuetify.carousel.prev")};C.push(b.value?o.prev?o.prev({props:r}):c(A,r,null):i("div",null,null));const k={icon:l.value?e.prevIcon:e.nextIcon,class:`v-window__${v.value?"left":"right"}`,onClick:a.next,"aria-label":s("$vuetify.carousel.next")};return C.push(x.value?o.next?o.next({props:k}):c(A,k,null):i("div",null,null)),C}),E=d(()=>e.touch===!1?e.touch:{...{left:()=>{v.value?D():U()},right:()=>{v.value?U():D()},start:r=>{let{originalEvent:k}=r;k.stopPropagation()}},...e.touch===!0?{}:e.touch});return ee(()=>Le(c(e.tag,{ref:h,class:G(["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},n.value,e.class]),style:me(e.style)},{default:()=>{var C,r;return[i("div",{class:"v-window__container",style:me({height:p.value})},[(C=o.default)==null?void 0:C.call(o,{group:a}),e.showArrows!==!1&&i("div",{class:"v-window__controls"},[M.value])]),(r=o.additional)==null?void 0:r.call(o,{group:a})]}}),[[be,E.value]])),{group:a}}}),Je=Q({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ue(),...dt(),...Nt()},"VWindowItem"),ae=J()({name:"VWindowItem",directives:{vTouch:be},props:Je(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:o}=t;const n=He(Ze),l=it(e,Ke),{isBooted:s}=ut();if(!n||!l)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const a=pe(!1),h=d(()=>s.value&&(n.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function v(){!a.value||!n||(a.value=!1,n.transitionCount.value>0&&(n.transitionCount.value-=1,n.transitionCount.value===0&&(n.transitionHeight.value=void 0)))}function m(){var b;a.value||!n||(a.value=!0,n.transitionCount.value===0&&(n.transitionHeight.value=ge((b=n.rootRef.value)==null?void 0:b.clientHeight)),n.transitionCount.value+=1)}function g(){v()}function T(b){a.value&&vt(()=>{!h.value||!a.value||!n||(n.transitionHeight.value=ge(b.clientHeight))})}const p=d(()=>{const b=n.isReversed.value?e.reverseTransition:e.transition;return h.value?{name:typeof b!="string"?n.transition.value:b,onBeforeEnter:m,onAfterEnter:v,onEnterCancelled:g,onBeforeLeave:m,onAfterLeave:v,onLeaveCancelled:g,onEnter:T}:!1}),{hasContent:V}=jt(e,l.isSelected);return ee(()=>c(ct,{transition:p.value,disabled:!s.value},{default:()=>{var b;return[Le(i("div",{class:G(["v-window-item",l.selectedClass.value,e.class]),style:me(e.style)},[V.value&&((b=o.default)==null?void 0:b.call(o))]),[[rt,l.isSelected.value]])]}})),{groupItem:l}}}),we=Symbol.for("vuetify:v-tabs"),uo=Q({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Xe(ft({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),ve=J()({name:"VTab",props:uo(),setup(e,t){let{slots:o,attrs:n}=t;const{textColorClasses:l,textColorStyles:s}=mt(()=>e.sliderColor),a=W(),h=W(),v=d(()=>e.direction==="horizontal"),m=d(()=>{var T,p;return((p=(T=a.value)==null?void 0:T.group)==null?void 0:p.isSelected.value)??!1});function g(T){var V,b;let{value:p}=T;if(p){const x=(b=(V=a.value)==null?void 0:V.$el.parentElement)==null?void 0:b.querySelector(".v-tab--selected .v-tab__slider"),D=h.value;if(!x||!D)return;const U=getComputedStyle(x).color,M=x.getBoundingClientRect(),E=D.getBoundingClientRect(),C=v.value?"x":"y",r=v.value?"X":"Y",k=v.value?"right":"bottom",w=v.value?"width":"height",O=M[C],Y=E[C],L=O>Y?M[k]-E[k]:M[C]-E[C],fe=Math.sign(L)>0?v.value?"right":"bottom":Math.sign(L)<0?v.value?"left":"top":"center",he=(Math.abs(L)+(Math.sign(L)<0?M[w]:E[w]))/Math.max(M[w],E[w])||0,te=M[w]/E[w]||0,ue=1.5;qt(D,{backgroundColor:[U,"currentcolor"],transform:[`translate${r}(${L}px) scale${r}(${te})`,`translate${r}(${L/ue}px) scale${r}(${(he-1)/ue+1})`,"none"],transformOrigin:Array(3).fill(fe)},{duration:225,easing:Jt})}}return ee(()=>{const T=A.filterProps(e);return c(A,q({symbol:we,ref:a,class:["v-tab",e.class],style:e.style,tabindex:m.value?0:-1,role:"tab","aria-selected":String(m.value),active:!1},T,n,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":g}),{...o,default:()=>{var p;return i(N,null,[((p=o.default)==null?void 0:p.call(o))??e.text,!e.hideSlider&&i("div",{ref:h,class:G(["v-tab__slider",l.value]),style:me(s.value)},null)])}})}),Kt({},a)}}),ro=Q({...Xe(qe(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),co=J()({name:"VTabsWindow",props:ro(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const n=He(we,null),l=Ye(e,"modelValue"),s=d({get(){var a;return l.value!=null||!n?l.value:(a=n.items.value.find(h=>n.selected.value.includes(h.id)))==null?void 0:a.value},set(a){l.value=a}});return ee(()=>{const a=_e.filterProps(e);return c(_e,q({_as:"VTabsWindow"},a,{modelValue:s.value,"onUpdate:modelValue":h=>s.value=h,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),o)}),{}}}),vo=Q({...Je()},"VTabsWindowItem"),mo=J()({name:"VTabsWindowItem",props:vo(),setup(e,t){let{slots:o}=t;return ee(()=>{const n=ae.filterProps(e);return c(ae,q({_as:"VTabsWindowItem"},n,{class:["v-tabs-window-item",e.class],style:e.style}),o)}),{}}});function fo(e){return e?e.map(t=>bt(t)?t:{text:t,value:t}):[]}const ho=Q({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Ft({mandatory:"force",selectedClass:"v-tab-item--selected"}),...kt(),...De()},"VTabs"),yo=J()({name:"VTabs",props:ho(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:o,slots:n}=t;const l=Ye(e,"modelValue"),s=d(()=>fo(e.items)),{densityClasses:a}=ht(e),{backgroundColorClasses:h,backgroundColorStyles:v}=yt(()=>e.bgColor),{scopeId:m}=pt();return gt({VTab:{color:j(()=>e.color),direction:j(()=>e.direction),stacked:j(()=>e.stacked),fixed:j(()=>e.fixedTabs),sliderColor:j(()=>e.sliderColor),hideSlider:j(()=>e.hideSlider)}}),ee(()=>{const g=Me.filterProps(e),T=!!(n.window||e.items.length>0);return i(N,null,[c(Me,q(g,{modelValue:l.value,"onUpdate:modelValue":p=>l.value=p,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},a.value,h.value,e.class],style:[{"--v-tabs-height":ge(e.height)},v.value,e.style],role:"tablist",symbol:we},m,o),{default:()=>{var p;return[((p=n.default)==null?void 0:p.call(n))??s.value.map(V=>{var b;return((b=n.tab)==null?void 0:b.call(n,{item:V}))??c(ve,q(V,{key:V.text,value:V.value}),{default:n[`tab.${V.value}`]?()=>{var x;return(x=n[`tab.${V.value}`])==null?void 0:x.call(n,{item:V})}:void 0})})]}}),T&&c(co,q({modelValue:l.value,"onUpdate:modelValue":p=>l.value=p,key:"tabs-window"},m),{default:()=>{var p;return[s.value.map(V=>{var b;return((b=n.item)==null?void 0:b.call(n,{item:V}))??c(mo,{value:V.value},{default:()=>{var x;return(x=n[`item.${V.value}`])==null?void 0:x.call(n,{item:V})}})}),(p=n.window)==null?void 0:p.call(n)]}})])}),{}}});function po(e,t){const o=W();return K(e,"dragstart",n=>{if(o.value=n.target,typeof t=="string"){const l=t;t=(s,a)=>{a==null||a.setData("text/plain",s.dataset[l]??"")}}t==null||t(o.value,n.dataTransfer)}),K(e,"dragend",()=>{o.value=null}),{element:o}}function Qe(e,t,o=!0){const n=W(!1);let l=0;return Bt&&(K(e,"dragenter",s=>{s.preventDefault(),l++,n.value=!0}),K(e,"dragover",s=>{s.preventDefault()}),K(e,"dragleave",s=>{s.preventDefault(),l--,l===0&&(n.value=!1)}),K(e,"drop",s=>{var a;if(s.preventDefault(),l=0,n.value=!1,t)if(o){const h=Array.from(((a=s.dataTransfer)==null?void 0:a.files)??[]);t(h.length===0?null:h)}else t(s.dataTransfer)})),{isOverDropZone:n}}const go={class:"d-inline-block"},ko={class:"overflow-hidden text-white"},bo={class:"title relative inline-block"},_o=["innerHTML"],wo={key:1},Vo=["innerHTML"],$o={key:0},Co={key:1},To={key:2},xo={key:3},So={class:"table-fixed"},Io={class:"w-1/3"},Bo={class:"text-center"},Ro=["title"],Mo={class:"text-center"},Eo=["title"],Po={class:"text-center"},Ao=["title"],Wo={class:"text-center"},Oo=["title"],Lo={class:"text-center"},Do=["title"],Uo={class:"text-right"},Ho={class:"text-right"},Xo={class:"text-right"},Yo={class:"text-right"},jo={class:"text-right"},No={class:"text-right"},Fo={class:"text-right"},Go={class:"text-right"},zo={class:"text-right"},Zo={class:"text-right"},Ko=se({__name:"Ticket",props:{ticket:{}},setup(e){_t(u=>({"0c560d15":Te.value.delay,"2b070e7c":Te.value.duration}));const t=e,{t:o}=wt(),n=d(()=>Re().props.factors),l=W(null),s=new Rt({linkify:!0}).use(Mt),a=Fe(),h=Ge(),v=d(()=>Re().props.options),m=d(()=>oe(t.ticket.created_at)),g=d(()=>oe.duration(t.ticket.delay,"s")),T=d(()=>m.value.add(g.value)),p=d(()=>t.ticket.bound_at?oe(t.ticket.bound_at):null),V=d(()=>t.ticket.reservation?oe.duration(t.ticket.reservation,"s"):null),b=d(()=>p.value&&V.value?p.value.add(V.value):null),x=d(()=>t.ticket.accepted_at?oe(t.ticket.accepted_at):null),D=d(()=>`${m.value.format("lll")} (${m.value.fromNow()})`),U=d(()=>`${T.value.format("lll")} (${o("time_left",{time:T.value.fromNow(!0)})})`),M=d(()=>p.value?`${p.value.format("lll")} (${p.value.fromNow()})`:null),E=d(()=>b.value?`${b.value.format("lll")} (${o("time_left",{time:b.value.fromNow(!0)})})`:null),C=d(()=>x.value?`${x.value.format("lll")} (${x.value.fromNow()})`:null),r=d(()=>`${O(t.ticket.weight)} (${o("increment_per_second",{units:t.ticket.weight_increment.toString()})})`),k=d(()=>v.value[`${h.value}_threshold`]),w=d(()=>t.ticket[h.value]),O=u=>u<1e5?u:u.toExponential(1),Y=()=>{var u,B;return((u=t.ticket.meta)==null?void 0:u.category_name)??((B=t.ticket.category)==null?void 0:B.name)??""},L=()=>{var u,B;return((u=t.ticket.meta)==null?void 0:u.category_short)??((B=t.ticket.category)==null?void 0:B.short)??""},fe=()=>{var u;return a.altInfo?((u=t.ticket.meta)==null?void 0:u.title)??L():L()},Ce=d(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_title)??"Title"}),he=d(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_subtitle)??Y()}),te=d(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_content)??[]}),ue=d(()=>w.value>k.value),Te=d(()=>({delay:-w.value+"s",duration:k.value+"s"}));return(u,B)=>(_(),S("div",go,[c(A,{size:"small",class:G(["ticket justify-start px-2",{overflow:ue.value}]),ripple:!1,flat:"",width:"100"},{default:y(()=>{var xe,Se;return[(xe=u.ticket.meta)!=null&&xe.icon?(_(),R(je,{key:0,icon:((Se=u.ticket.meta)==null?void 0:Se.icon)??"",color:"white"},null,8,["icon"])):F("",!0),i("span",ko,[i("span",bo,f(fe()),1)]),c(Gt,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:y(()=>{var Ie;return[c(zt,{width:"500","prepend-icon":((Ie=u.ticket.meta)==null?void 0:Ie.icon)??"",title:Ce.value,subtitle:he.value},{default:y(()=>[c(yo,{modelValue:l.value,"onUpdate:modelValue":B[0]||(B[0]=P=>l.value=P)},{default:y(()=>[c(ve,{value:"properties"},{default:y(()=>[I(f(u.$t("properties")),1)]),_:1}),c(ve,{value:"metrics"},{default:y(()=>[I(f(u.$t("metrics")),1)]),_:1}),c(ve,{value:"details"},{default:y(()=>[I(f(u.$t("details")),1)]),_:1})]),_:1},8,["modelValue"]),c(Zt,null,{default:y(()=>[c(_e,{modelValue:l.value,"onUpdate:modelValue":B[1]||(B[1]=P=>l.value=P)},{default:y(()=>[c(ae,{value:"properties",class:"prose"},{default:y(()=>[typeof te.value=="string"?(_(),S("div",{key:0,innerHTML:$(s).render(te.value)},null,8,_o)):(_(),S("table",wo,[i("tbody",null,[(_(!0),S(N,null,le(te.value,([P,re])=>(_(),S("tr",{key:P},[i("th",null,f(P),1),i("td",{innerHTML:$(s).renderInline(re)},null,8,Vo)]))),128))])]))]),_:1}),c(ae,{value:"metrics",class:"prose"},{default:y(()=>[i("table",null,[i("tbody",null,[i("tr",null,[i("th",null,f(u.$t("issued_on")),1),i("td",null,f(D.value),1)]),T.value.isAfter(u.$dayjs())?(_(),S("tr",$o,[i("th",null,f(u.$t("delayed_until")),1),i("td",null,f(U.value),1)])):F("",!0),p.value?(_(),S("tr",Co,[i("th",null,f(u.$t("bound_at")),1),i("td",null,f(M.value),1)])):F("",!0),b.value&&b.value.isAfter(u.$dayjs())?(_(),S("tr",To,[i("th",null,f(u.$t("reserved_until")),1),i("td",null,f(E.value),1)])):F("",!0),x.value?(_(),S("tr",xo,[i("th",null,f(u.$t("accepted_at")),1),i("td",null,f(C.value),1)])):F("",!0),i("tr",null,[i("th",null,f(u.$t("current_weight")),1),i("td",null,f(r.value),1)]),i("tr",null,[i("th",null,f(u.$t("complexity")),1),i("td",null,f(u.ticket.complexity+" "+$(o)("units")),1)])])])]),_:1}),c(ae,{value:"details",class:"prose"},{default:y(()=>[i("table",So,[i("thead",null,[i("tr",null,[i("th",Io,f(u.$t("factor")),1),i("th",Bo,[i("em",{class:"metric",title:u.$t("initial_weight")},B[2]||(B[2]=[I("W"),i("sub",null,"0",-1)]),8,Ro)]),i("th",Mo,[i("em",{class:"metric",title:u.$t("weight_increment")},B[3]||(B[3]=[I("W"),i("sub",null,"i",-1)]),8,Eo)]),i("th",Po,[i("em",{class:"metric",title:u.$t("complexity")},"C",8,Ao)]),i("th",Wo,[i("em",{class:"metric",title:u.$t("delay_sec")},"D",8,Oo)]),i("th",Lo,[i("em",{class:"metric",title:u.$t("reservation_sec")},"R",8,Do)])])]),i("tbody",null,[(_(!0),S(N,null,le(u.ticket.metrics??{},(P,re)=>{var Be;return _(),S("tr",{key:re},[i("th",null,f(((Be=n.value[re])==null?void 0:Be.name)??u.$t("unknown")),1),i("td",Uo,f(P.initial_weight??0),1),i("td",Ho,f(P.weight_increment??0),1),i("td",Xo,f(P.complexity??0),1),i("td",Yo,f(P.delay??0),1),i("td",jo,f(P.reservation??0),1)])}),128))]),i("tfoot",null,[i("tr",null,[i("th",null,f(u.$t("total")),1),i("td",No,f(u.ticket.initial_weight),1),i("td",Fo,f(u.ticket.weight_increment),1),i("td",Go,f(u.ticket.complexity),1),i("td",zo,f(u.ticket.delay),1),i("td",Zo,f(u.ticket.reservation),1)])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["prepend-icon","title","subtitle"])]}),_:1})]}),_:1},8,["class"])]))}}),qo=ie(Ko,[["__scopeId","data-v-8c1a37e4"]]),Jo=se({__name:"TicketPool",props:{tickets:{}},setup(e){const t=W(null);po(t,"uuid");const{lock:o,unlock:n,element:l,triggerElement:s}=Et(t),{x:a}=Pt({type:"movement"});d(()=>ne(ze)),Oe([l,a],([v,m])=>{!v||!s.value||s.value.dataset.uuid});const h=W(!1);return Ne(()=>{setTimeout(()=>h.value=!0,500)}),(v,m)=>(_(),R($(Ae),{ref_key:"ticketPool",ref:t,name:"ticket-pool",class:"tickets @container !pt-[1px] !pb-[3px] leading-8",css:h.value,onMouseup:$(n)},{default:y(()=>[(_(!0),S(N,null,le(v.tickets,g=>(_(),R(qo,{key:g.uuid,"data-uuid":g.uuid,ticket:g,draggable:"true",class:"mr-1",onMousedown:Vt($(o),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css","onMouseup"]))}}),Qo=ie(Jo,[["__scopeId","data-v-1fd3da22"]]);function Ve(){async function e(l,s){return await window.axios.patch(ce("ticket-allocator.operators.ready",l),{ready:s})}async function t(l,s){return await window.axios.patch(ce("ticket-allocator.tickets.weight",l),{weight_points:s})}async function o(l,s){return await window.axios.patch(ce("ticket-allocator.tickets.handler",l),{operator_uuid:s??null})}async function n(l){return await window.axios.delete(ce("ticket-allocator.tickets.close",l))}return{ready:e,weight:t,handler:o,close:n}}const en=se({__name:"TicketRow",props:{tickets:{},pool:{type:Boolean}},setup(e){const t=e;let o=W(!1);const n=d(()=>t.pool?"th":"td"),l=d(()=>t.tickets.reduce((m,{complexity:g})=>m+g,0)),s=d(()=>o.value?"mdi-chevron-down":"mdi-chevron-up"),a=Ve(),h=W(null),{isOverDropZone:v}=Qe(h,async m=>{var p;const g=m==null?void 0:m.getData("text/plain");if(!g)throw new Error("Ticket UUID undefined.");const T=(p=h.value)==null?void 0:p.dataset.uuid;return await a.handler(g,T)},!1);return(m,g)=>(_(),S("tr",{ref_key:"ticketRow",ref:h,class:G(["ticket-row",{dragover:$(v)}])},[(_(),R(Z(n.value),{class:"status py-1"},{default:y(()=>[z(m.$slots,"status",{},void 0,!0)]),_:3})),(_(),R(Z(n.value),{class:"name font-weight-bold !pt-[6px]"},{default:y(()=>[z(m.$slots,"name",{},void 0,!0)]),_:3})),(_(),R(Z(n.value),{class:"load !pt-[6px] text-center"},{default:y(()=>[z(m.$slots,"load",{},()=>[I(f(m.tickets.length),1)],!0),g[2]||(g[2]=I("/")),z(m.$slots,"load-max",{},()=>[g[1]||(g[1]=I("∞"))],!0)]),_:3,__:[2]})),(_(),R(Z(n.value),{class:"complexity !pt-[6px] text-center"},{default:y(()=>[z(m.$slots,"complexity",{},()=>[I(f(l.value),1)],!0),g[4]||(g[4]=I("/")),z(m.$slots,"complexity-max",{},()=>[g[3]||(g[3]=I("∞"))],!0)]),_:3,__:[4]})),c(Qo,{tag:n.value,tickets:m.tickets,class:G({collapsed:$(o)})},null,8,["tag","tickets","class"]),(_(),R(Z(n.value),{class:"more !pt-[2px] text-center"},{default:y(()=>[c(A,{size:"x-small",variant:"tonal",icon:s.value,onClick:g[0]||(g[0]=T=>ke(o)?o.value=!$(o):o=!$(o))},null,8,["icon"])]),_:1}))],2))}}),et=ie(en,[["__scopeId","data-v-113cb187"]]),tn=se({__name:"OperatorRow",props:{operator:{}},setup(e){const t=e,o=d(()=>{var s,a;return{online:t.operator.online,ready:t.operator.ready,busy:!!((s=t.operator.tickets)!=null&&s.length),full:t.operator.ticket_limit!==null&&((a=t.operator.tickets)==null?void 0:a.length)>=t.operator.ticket_limit}}),n=Ve(),l=async()=>await n.ready(t.operator.uuid,!t.operator.ready);return(s,a)=>(_(),R(et,{tickets:s.operator.tickets,"data-uuid":s.operator.uuid,class:G(["operator",o.value])},{status:y(()=>[c(je,{icon:"mdi-account",onClick:l})]),"load-max":y(()=>[I(f(s.operator.ticket_limit??"∞"),1)]),"complexity-max":y(()=>[I(f(s.operator.complexity_limit??"∞"),1)]),name:y(()=>[I(f(s.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}}),on=ie(tn,[["__scopeId","data-v-a776c74a"]]);function nn(e,t){return e.reduce((o,n)=>(typeof n[t]=="number"&&(o+=n[t]),o),0)}function $e(e,t){return e.map(o=>Ct(o,t)).filter(o=>o)}function an(e,t){const o=$e(e,t).filter(n=>typeof n=="number");return o.length===0?0:Math.max(...o)}function ln(e,t){const o=$e(e,t).filter(n=>typeof n=="number");return o.length===0?0:Math.min(...o)}function sn(e){return e.map(t=>t[t.$getLocalKey()])}function un(e,t){const o={},n=Array.isArray(t)?t:[t];return e.forEach(l=>{const s=n.length===1?l[n[0]]:`[${n.map(a=>l[a]).toString()}]`;o[s]=(o[s]||[]).concat(l)}),o}function rn(e,t,o){const n=[],l=[];return typeof t=="function"&&l.push(t)&&n.push("asc"),Array.isArray(t)&&t.forEach(s=>l.push(s[0])&&n.push(s[1])),l.length===0&&l.push(t),$t(e,l,n,o)}function cn(e){return{sum:t=>nn(e,t),min:t=>ln(e,t),max:t=>an(e,t),pluck:t=>$e(e,t),groupBy:t=>un(e,t),sortBy:(t,o="SORT_REGULAR")=>rn(e,t,o),keys:()=>sn(e)}}const dn={class:"text-xl leading-tight font-semibold text-gray-800"},vn={class:"align-top"},mn=se({__name:"Dashboard",props:{layout:{default:"default"},operators:{},operatorTeams:{},tickets:{},ticketCategories:{},factors:{},matchers:{}},setup(e){const t=e,o=Fe(),n=Ge(),l=At(),s=Wt(),a=d(()=>ne(Ut)),h=d(()=>ne(Ht)),v=d(()=>ne(ze)),m=d(()=>ne(Xt)),g=Ot(Yt),T=r=>Object.entries(l.value).reduce((k,[w,O])=>{const Y=r==null?void 0:r[w],L=Y===void 0||!O.length||O.map(String).includes(Y.toString());return k&&L},!0),p=d(()=>cn(a.value.with("teams").with("tickets",r=>{r.with("category").where("meta",T).orderBy(n.value,"desc")}).whereHas("tickets").orWhere(r=>!o.hideEmpty&&r.online).get().filter(r=>!s.value.length||r.teams.some(k=>s.value.includes(k.uuid)))).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),V=d(()=>v.value.unbound().with("category").where("meta",T).orderBy(n.value,"desc").get()),b=Ve(),x=W(null),{isOverDropZone:D}=Qe(x,async r=>{const k=r==null?void 0:r.getData("text/plain");if(!k)throw new Error("Ticket UUID undefined.");return await b.close(k)},!1);Ne(()=>{g.listen(Lt.PropsInvalidated,()=>ye.reload()).listen(H.Enrolled,a.value.enroll).listen(H.Resigned,a.value.resign).listen(H.NameChanged,a.value.changeName).listen(H.Online,a.value.setOnline).listen(H.Offline,a.value.setOffline).listen(H.Ready,a.value.setReady).listen(H.NotReady,a.value.setNotReady).listen(H.TicketLimitAdjusted,a.value.adjustTicketLimit).listen(H.ComplexityLimitAdjusted,a.value.adjustComplexityLimit).listen(X.Created,v.value.create).listen(X.Closed,v.value.close).listen(X.Bound,v.value.bind).listen(X.Accepted,v.value.accept).listen(X.Unbound,v.value.unbind).listen(X.CategoryChanged,v.value.changeCategory).listen(X.MetaValueSet,v.value.setMetaValue).listen(X.MetaValuesMerged,v.value.mergeMetaValues).listen(X.MetricsAdjusted,v.value.adjustMetrics)});function U(){a.value.save(t.operators),h.value.fresh(t.operatorTeams),v.value.fresh(t.tickets),m.value.fresh(t.ticketCategories)}const M=ye.on("navigate",U),E=ye.on("success",U);Tt(()=>{M(),E()});const C=r=>Object.entries(r).map(([k,w])=>({title:k,value:w}));return(r,k)=>(_(),S(N,null,[c($(xt),{title:r.$t("dashboard")},null,8,["title"]),(_(),R(Z(`${r.layout}-layout`),null,{header:y(()=>[i("h2",dn,f(r.$t("dashboard")),1)]),default:y(()=>[i("div",null,[c(Qt,{fluid:""},{default:y(()=>[c(Ee,null,{default:y(()=>[c(de,null,{default:y(()=>[c(St,{modelValue:$(o).all,"onUpdate:modelValue":k[0]||(k[0]=w=>$(o).all=w),variant:"plain",multiple:""},{default:y(()=>[c(A,{value:"show-filters",icon:$(o).showFilters?"mdi-filter-outline":"mdi-filter-off-outline"},null,8,["icon"]),c(A,{value:"hide-empty",icon:$(o).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),c(A,{value:"alt-info",icon:$(o).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),c(A,{value:"unlocked",icon:$(o).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:$(o).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),$(o).unlocked?(_(),R(It,{key:0,variant:"plain"},{default:y(()=>[c(A,{ref_key:"closeTicket",ref:x,icon:$(D)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),c(A,{icon:"mdi-refresh"})]),_:1})):F("",!0)]),_:1}),c(de,{cols:"2"},{default:y(()=>[c(Dt,{modelValue:$(n),"onUpdate:modelValue":k[1]||(k[1]=w=>ke(n)?n.value=w:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1}),$(o).showFilters?(_(),R(Ee,{key:0},{default:y(()=>[c(de,{cols:"2"},{default:y(()=>[c(Pe,{modelValue:$(s),"onUpdate:modelValue":k[2]||(k[2]=w=>ke(s)?s.value=w:null),multiple:"",clearable:"",chips:"","closable-chips":"",label:r.$t("teams"),items:r.operatorTeams,"item-title":"name","item-value":"uuid"},null,8,["modelValue","label","items"])]),_:1}),(_(!0),S(N,null,le(r.matchers,(w,O)=>(_(),R(de,{key:O,cols:"2"},{default:y(()=>[c(Pe,{modelValue:$(l)[O],"onUpdate:modelValue":Y=>$(l)[O]=Y,multiple:"",clearable:"",chips:"","closable-chips":"",label:r.$t(O),items:C(w)},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024))),128))]),_:1})):F("",!0)]),_:1}),c(eo,{"fixed-header":"",height:"600px",density:"compact",class:"ticket-monitor"},{default:y(()=>[i("thead",vn,[c(et,{pool:"",tickets:V.value},{name:y(()=>[I(f(r.$t("ticket_pool")),1)]),_:1},8,["tickets"])]),c($(Ae),{tag:"tbody",class:"align-top",name:"operator-pool"},{default:y(()=>[(_(!0),S(N,null,le(p.value,w=>(_(),R(on,{key:w.uuid,operator:w},null,8,["operator"]))),128))]),_:1})]),_:1})])]),_:1}))],64))}}),Sn=ie(mn,[["__scopeId","data-v-811338dd"]]);export{Sn as default};
//# sourceMappingURL=Dashboard-Jsx_vNhT.js.map
